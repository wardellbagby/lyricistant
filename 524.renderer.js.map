{"version":3,"file":"524.renderer.js","mappings":"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","sources":["webpack://lyricistant/./packages/renderer/main/theme/index.ts","webpack://lyricistant/./packages/common/main/preferences/PreferencesData.ts","webpack://lyricistant/./packages/renderer/main/preload.tsx","webpack://lyricistant/./packages/renderer/main/globals.ts","webpack://lyricistant/./packages/codemirror/main/lyrics-tokens.ts","webpack://lyricistant/./packages/codemirror/main/lyrics.grammar","webpack://lyricistant/./packages/codemirror/main/lyrics-language.ts","webpack://lyricistant/./packages/codemirror/main/editorTheme.ts","webpack://lyricistant/./packages/codemirror/main/SyntaxNodes.ts","webpack://lyricistant/./packages/codemirror/main/syllableCounts.ts","webpack://lyricistant/./packages/codemirror/main/CodeMirror.tsx","webpack://lyricistant/./packages/codemirror/main/textSelection.ts","webpack://lyricistant/./packages/renderer/main/app/AppError.tsx","webpack://lyricistant/./packages/renderer/main/about/AboutDialog.tsx","webpack://lyricistant/./packages/renderer/main/app/Navigation.ts","webpack://lyricistant/./packages/renderer/main/download/index.ts","webpack://lyricistant/./packages/common/main/releases/ReleaseHelper.ts","webpack://lyricistant/./packages/renderer/main/download/LatestReleaseMachine.ts","webpack://lyricistant/./packages/renderer/main/download/ChooseDownloadDialog.tsx","webpack://lyricistant/./packages/renderer/main/app/useReadOnlyMode.tsx","webpack://lyricistant/./packages/renderer/main/app/useSmallLayout.ts","webpack://lyricistant/./packages/renderer/main/platform/useChannel.ts","webpack://lyricistant/./packages/renderer/main/filehistory/FileHistory.tsx","webpack://lyricistant/./packages/renderer/main/markdown/Markdown.tsx","webpack://lyricistant/./packages/renderer/main/platform/PlatformDialogs.tsx","webpack://lyricistant/./packages/renderer/main/preferences/Preferences.tsx","webpack://lyricistant/./packages/renderer/main/privacy/PrivacyPolicy.tsx","webpack://lyricistant/./packages/renderer/main/app/Modals.tsx","webpack://lyricistant/./packages/renderer/main/detail/WordChip.tsx","webpack://lyricistant/./packages/renderer/main/detail/NullStateText.tsx","webpack://lyricistant/./packages/renderer/main/diagnostics/DiagnosticsMachine.ts","webpack://lyricistant/./packages/renderer/main/diagnostics/Diagnostics.tsx","webpack://lyricistant/./packages/renderer/main/dictionary/DictionaryMachine.ts","webpack://lyricistant/./packages/renderer/main/dictionary/Dictionary.tsx","webpack://lyricistant/./packages/renderer/main/rhymes/Rhymes.tsx","webpack://lyricistant/./packages/renderer/main/rhymes/rhyme.ts","webpack://lyricistant/./packages/renderer/main/rhymes/datamuse.ts","webpack://lyricistant/./packages/renderer/main/rhymes/RhymesMachine.ts","webpack://lyricistant/./packages/renderer/main/detail/DetailPane.tsx","webpack://lyricistant/./packages/renderer/main/editor/to-platform-file.ts","webpack://lyricistant/./packages/renderer/main/editor/Editor.tsx","webpack://lyricistant/./packages/renderer/main/errors/ErrorHandlers.ts","webpack://lyricistant/./packages/renderer/main/menu/Menu.tsx","webpack://lyricistant/./packages/renderer/main/app/ResponsiveMainDetailLayout.tsx","webpack://lyricistant/./packages/renderer/main/app/SupportedBrowserWarning.tsx","webpack://lyricistant/./packages/renderer/main/index.tsx","webpack://lyricistant/./packages/renderer/main/analytics/setupAnalytics.ts","webpack://lyricistant/./packages/renderer/main/app/PlatformEventsReadyHandler.tsx","webpack://lyricistant/./packages/renderer/main/theme/Themed.tsx","webpack://lyricistant/./packages/renderer/main/app/App.tsx","webpack://lyricistant/./packages/renderer/main/app/useBeforeUnload.ts","webpack://lyricistant/./packages/renderer/main/lyricistant_logo.svg"],"sourcesContent":["import {\n  ColorScheme,\n  ThemeData,\n} from '@lyricistant/common/preferences/PreferencesData';\nimport { Palette } from '@lyricistant/common/theme/SystemTheme';\nimport {\n  createTheme as createMuiTheme,\n  responsiveFontSizes,\n  Theme,\n} from '@mui/material';\n\n/**\n * Get a theme palette based on the given theme data.\n *\n * @param themeData The optional theme data to generate a palette for.\n */\nexport const getThemePalette = (\n  themeData?: ThemeData,\n): { palette: Palette; isDark: boolean } => {\n  const useDarkTheme = !themeData || themeData.colorScheme === ColorScheme.Dark;\n\n  return {\n    palette: {\n      ...(useDarkTheme ? darkThemePalette : lightThemePalette),\n      ...themeData?.systemPalette,\n    },\n    isDark: useDarkTheme,\n  };\n};\n\n/**\n * Create a MUI theme from theme data.\n *\n * @param themeData The theme data used for generating the MUI theme.\n */\nexport const createTheme = (themeData?: ThemeData): Theme => {\n  const { palette, isDark } = getThemePalette(themeData);\n\n  return responsiveFontSizes(\n    createMuiTheme({\n      palette: {\n        mode: isDark ? 'dark' : 'light',\n        action: {\n          hover: palette.primary,\n          hoverOpacity: 0,\n        },\n        primary: {\n          main: palette.primary,\n        },\n        background: {\n          default: palette.background,\n          paper: palette.surface,\n        },\n        text: {\n          primary: palette.primaryText,\n          secondary: palette.secondaryText,\n        },\n      },\n      components: {\n        MuiPaper: {\n          styleOverrides: { root: { backgroundImage: 'unset' } },\n        },\n      },\n      typography: themeData?.textSize\n        ? {\n            fontSize: themeData.textSize,\n          }\n        : undefined,\n    }),\n  );\n};\n\nconst lightThemePalette: Palette = {\n  primary: '#2c9a35',\n  background: '#faf9f7',\n  surface: '#efeae1',\n  primaryText: '#212121',\n  secondaryText: '#424242',\n};\n\nconst darkThemePalette: Palette = {\n  primary: '#f2b21c',\n  background: '#141414',\n  surface: '#232323',\n  primaryText: '#f8f8f8',\n  secondaryText: '#bdbdbd',\n};\n","import { SystemPalette } from '@lyricistant/common/theme/SystemTheme';\n\nexport enum ColorScheme {\n  Light,\n  Dark,\n  System,\n}\nexport enum Font {\n  Roboto_Mono,\n  Roboto,\n}\nexport enum RhymeSource {\n  Offline,\n  Datamuse,\n}\nexport enum DefaultFileType {\n  Always_Ask,\n  Lyricistant_Lyrics,\n  Plain_Text,\n}\nexport enum DetailPaneVisibility {\n  Toggleable,\n  Always_Show,\n}\nexport type DisplayableColorScheme = ColorScheme.Light | ColorScheme.Dark;\n\nexport interface ThemeData {\n  colorScheme: DisplayableColorScheme;\n  textSize: number;\n  font: Font;\n  systemPalette?: SystemPalette;\n}\nexport interface PreferencesData {\n  colorScheme: ColorScheme;\n  textSize: number;\n  font: Font;\n  rhymeSource: RhymeSource;\n  defaultFileType: DefaultFileType;\n  detailPaneVisibility: DetailPaneVisibility;\n}\n","import { Palette } from '@lyricistant/common/theme/SystemTheme';\nimport logo from '@lyricistant/renderer/lyricistant_logo.svg';\nimport { getThemePalette } from '@lyricistant/renderer/theme';\n\nonThemeUpdated(getThemePalette().palette);\n\nlet container = document.getElementById('preload-overlay');\n\nif (!container) {\n  container = document.createElement('div');\n  container.id = 'preload-overlay';\n  document.body.append(container);\n\n  container.innerHTML = logo;\n  const image = container.firstElementChild as SVGSVGElement;\n  image.style.width = '128px';\n  image.style.height = '128px';\n  image.id = 'preload-overlay-logo';\n}\n\nexport const onPageLoaded = () => {\n  if (container) {\n    container.style.opacity = '0';\n    setTimeout(() => {\n      container?.remove();\n      container = null;\n    }, 500);\n  }\n};\n\nexport function onThemeUpdated(palette: Palette) {\n  document.body.style.setProperty('--primary', palette.primary);\n  document.body.style.setProperty('--background', palette.background);\n  document.body.style.setProperty('--surface', palette.surface);\n  document.body.style.setProperty('--text', palette.primaryText);\n}\n","const [APP_VERSION, APP_HOMEPAGE, APP_AUTHOR, APP_PLATFORM] = [\n  process.env.APP_VERSION,\n  process.env.APP_HOMEPAGE,\n  process.env.APP_AUTHOR,\n  process.env.APP_PLATFORM,\n];\n\nexport { APP_AUTHOR, APP_HOMEPAGE, APP_VERSION, APP_PLATFORM };\n","import { ExternalTokenizer } from '@lezer/lr';\nimport { Lyric } from './lyrics.grammar';\n\nconst FORWARD_SLASH = '/'.charCodeAt(0);\nconst NEW_LINE = '\\n'.charCodeAt(0);\nconst EOF = -1;\n\nexport const lyric = new ExternalTokenizer((input) => {\n  let current = input.peek(0);\n  let next = input.peek(1);\n\n  if (current === EOF || current === NEW_LINE) {\n    return;\n  }\n\n  while (true) {\n    if (current === FORWARD_SLASH && next === FORWARD_SLASH) {\n      input.acceptToken(Lyric);\n      return;\n    }\n\n    if (next === NEW_LINE || next === EOF) {\n      input.acceptToken(Lyric, 1);\n      return;\n    }\n\n    current = input.advance();\n    next = input.peek(1);\n  }\n});\n","// This file was generated by lezer-generator. You probably shouldn't edit it.\nimport {LRParser} from \"@lezer/lr\"\nimport {lyric} from \"./lyrics-tokens\"\nexport const parser = LRParser.deserialize({\n  version: 14,\n  states: \"nQVQROOOOQQ'#Cf'#CfOOQQ'#Cb'#CbQVQROOOOQQ-E6`-E6`\",\n  stateData: \"j~OXOS~OPPORPOSPOTPO~OSRXR~\",\n  goto: \"fZPPPPPP[PPPbQRORSRTQOR\",\n  nodeNames: \"⚠ Lyric Lyrics LineComment TodoComment Context\",\n  maxTerm: 10,\n  skippedNodes: [0],\n  repeatNodeCount: 1,\n  tokenData: \")k~R[X^wpqw!P!Q!l!}#O(W#y#zw$f$gw#BY#BZw$IS$I_w$I|$JOw$JT$JUw$KV$KWw&FU&FVw~|YX~X^wpqw#y#zw$f$gw#BY#BZw$IS$I_w$I|$JOw$JT$JUw$KV$KWw&FU&FVw~!oP!P!Q!r~!wYR~OY#gZp#gpq$Oq!v#g!v!w$m!w#h#g#h#i&o#i;'S#g;'S;=`#x<%lO#g~#lSR~OY#gZ;'S#g;'S;=`#x<%lO#g~#{P;=`<%l#g~$TWR~OY#gZ!v#g!v!w$m!w#h#g#h#i&o#i;'S#g;'S;=`#x<%lO#g~$rUR~OY#gZ!q#g!q!r%U!r;'S#g;'S;=`#x<%lO#g~%ZUR~OY#gZ!f#g!f!g%m!g;'S#g;'S;=`#x<%lO#g~%rUR~OY#gZ!q#g!q!r&U!r;'S#g;'S;=`#x<%lO#g~&]SS~R~OY&UZ;'S&U;'S;=`&i<%lO&U~&lP;=`<%l&U~&tUR~OY#gZ#c#g#c#d'W#d;'S#g;'S;=`#x<%lO#g~']UR~OY#gZ#W#g#W#X'o#X;'S#g;'S;=`#x<%lO#g~'tUR~OY#gZ#c#g#c#d&U#d;'S#g;'S;=`#x<%lO#g~(ZSOY(gZ;'S(g;'S;=`)e<%lO(g~(jUOY(gZ#P(g#P#Q(|#Q;'S(g;'S;=`)e<%lO(g~)RUT~OY(gZ#P(g#P#Q(|#Q;'S(g;'S;=`)e<%lO(g~)hP;=`<%l(g\",\n  tokenizers: [0, lyric],\n  topRules: {\"Lyrics\":[0,2]},\n  tokenPrec: 21\n})\n\n          export default parser\n          // This file was generated by lezer-generator. You probably shouldn't edit it.\nexport const\n  Lyric = 1,\n  Lyrics = 2,\n  LineComment = 3,\n  TodoComment = 4,\n  Context = 5\n","import { LRLanguage, LanguageSupport } from '@codemirror/language';\nimport { styleTags, tags as t, Tag } from '@lezer/highlight';\nimport { parser } from './lyrics.grammar';\n\nexport const todoComment = Tag.define();\nexport const context = Tag.define();\nconst LyricsLanguage = LRLanguage.define({\n  parser: parser.configure({\n    props: [\n      styleTags({\n        LineComment: t.lineComment,\n        TodoComment: todoComment,\n        Context: context,\n      }),\n    ],\n  }),\n  languageData: {\n    commentTokens: { line: '//' },\n  },\n});\n\nexport const Lyrics = () => new LanguageSupport(LyricsLanguage);\n","import { HighlightStyle, syntaxHighlighting } from '@codemirror/language';\nimport { Extension } from '@codemirror/state';\nimport { EditorView } from '@codemirror/view';\nimport { tags } from '@lezer/highlight';\nimport { context, todoComment } from '@lyricistant/codemirror/lyrics-language';\nimport { Theme } from '@mui/material';\n\nconst textColorSelectionStyle = (appTheme: Theme) => ({\n  '&::selection': {\n    backgroundColor: appTheme.palette.primary.main,\n    color: appTheme.palette.getContrastText(appTheme.palette.primary.main),\n  },\n});\nexport const editorTheme = (appTheme: Theme, font: string): Extension => [\n  syntaxHighlighting(\n    HighlightStyle.define([\n      {\n        tag: tags.lineComment,\n        color: appTheme.palette.text.disabled,\n        ...textColorSelectionStyle(appTheme),\n      },\n      {\n        tag: [todoComment, context],\n        color: appTheme.palette.primary.main,\n        ...textColorSelectionStyle(appTheme),\n      },\n    ]),\n  ),\n  EditorView.theme(\n    {\n      '&.cm-editor': {\n        backgroundColor: appTheme.palette.background.default,\n        caretColor: appTheme.palette.text.primary,\n        height: '100%',\n      },\n      '&.cm-scroller': {\n        overflow: 'auto',\n      },\n      '&.cm-focused': {\n        outline_fallback: 'none !important',\n        outline: 'none !important',\n      },\n      '.cm-line-widget': {\n        color: appTheme.palette.text.disabled,\n        borderColor: appTheme.palette.text.disabled,\n      },\n      '.cm-line': {\n        color: appTheme.palette.text.primary,\n        ...textColorSelectionStyle(appTheme),\n      },\n      '.cm-mark': {\n        borderBottom: `2px solid ${appTheme.palette.primary.main}55`,\n        ...textColorSelectionStyle(appTheme),\n      },\n      '.cm-scroller': {\n        fontFamily: `\"${font}\"`,\n        fontSize: `${appTheme.typography.fontSize}px`,\n        paddingTop: '16px',\n        paddingBottom: '16px',\n        paddingLeft: '8px',\n        paddingRight: '8px',\n      },\n      '.cm-gutters': {\n        width: '60px',\n        justifyContent: 'center',\n        backgroundColor: appTheme.palette.background.default,\n        color: appTheme.palette.text.secondary,\n        borderRight: 'none',\n      },\n      '.cm-panel': {\n        backgroundColor: appTheme.palette.background.paper,\n        color: appTheme.palette.getContrastText(\n          appTheme.palette.background.paper,\n        ),\n      },\n      '.cm-searchMatch': {\n        backgroundColor: appTheme.palette.grey.A100,\n        color: appTheme.palette.getContrastText(appTheme.palette.grey.A100),\n      },\n      '.cm-searchMatch.selected': {\n        backgroundColor: appTheme.palette.primary.main,\n        color: appTheme.palette.primary.contrastText,\n      },\n      '.cm-button': {\n        background: appTheme.palette.primary.main,\n        color: appTheme.palette.primary.contrastText,\n        border: 'none',\n        borderRadius: '0px',\n        margin: '2px',\n        padding: '8px',\n        width: '100px',\n        height: '35px',\n        textAlign: 'center',\n        textDecoration: 'none',\n        display: 'inline-block',\n        fontFamily: '\"Roboto\"',\n        fontSize: appTheme.typography.fontSize,\n        '&:focus': {\n          outline: 'none',\n        },\n        '&:active': {\n          background: appTheme.palette.action.active,\n        },\n      },\n      '.cm-textfield': {\n        color: appTheme.palette.text.primary,\n        padding: '8px',\n        width: '150px',\n        height: '35px',\n        textDecoration: 'none',\n        fontFamily: '\"Roboto\"',\n        fontSize: appTheme.typography.fontSize,\n        '&:focus': {\n          outline: 'none',\n        },\n      },\n      '.cm-panel label': {\n        display: 'none',\n        fontFamily: '\"Roboto\"',\n        fontSize: appTheme.typography.fontSize,\n      },\n      '.cm-panel.cm-search [name=select]': {\n        display: 'none',\n      },\n      '.cm-panel.cm-search [name=close]': {\n        fontSize: '24px',\n        right: '8px',\n        '&:focus': {\n          outline: 'none',\n        },\n        color: appTheme.palette.text.primary,\n      },\n    },\n    {\n      dark: appTheme.palette.mode === 'dark',\n    },\n  ),\n];\n","import { syntaxTree } from '@codemirror/language';\nimport { EditorState, SelectionRange } from '@codemirror/state';\nimport { SyntaxNode } from '@lezer/common';\n\nexport const joinNodesToText = (\n  state: EditorState,\n  nodes: SyntaxNode[],\n): string => nodes.map((node) => state.sliceDoc(node.from, node.to)).join(' ');\n\nconst nonLyricNodeTypes = ['LineComment', 'TodoComment', 'Context'];\n\nexport const getLyricNodesBetween = (\n  state: EditorState,\n  from: number,\n  to: number,\n) =>\n  getNodesBetween(state, from, to).filter(\n    (node) => !nonLyricNodeTypes.find((name) => name === node.type.name),\n  );\n\nexport const doesNodeContainSelection = (\n  node: SyntaxNode,\n  selection: SelectionRange,\n): boolean => node.from <= selection.to && node.to >= selection.to;\n\nexport const getNodesBetween = (\n  state: EditorState,\n  from: number,\n  to: number,\n) => {\n  const nodes = [];\n  const cursor = syntaxTree(state).cursorAt(from, 1);\n  let pos = from;\n  while (pos < to) {\n    let checkChild = true;\n    if (cursor.node.to <= to && cursor.node.from >= from) {\n      nodes.push(cursor.node);\n      checkChild = false;\n    }\n    if (!cursor.next(checkChild)) {\n      return nodes;\n    }\n    pos = cursor.from;\n  }\n\n  return nodes;\n};\n","import { Extension } from '@codemirror/state';\nimport { lineNumbers } from '@codemirror/view';\nimport {\n  getNodesBetween,\n  getLyricNodesBetween,\n  joinNodesToText,\n} from '@lyricistant/codemirror/SyntaxNodes';\nimport syllable from 'syllable';\n\nexport const syllableCounts = (): Extension =>\n  lineNumbers({\n    formatNumber: (lineNo, state) => {\n      if (lineNo > state.doc.lines) {\n        return '0';\n      }\n\n      const { from, to } = state.doc.line(lineNo);\n      const nodes = getNodesBetween(state, from, to);\n      const supportedNodes = getLyricNodesBetween(state, from, to);\n\n      if (nodes.length === 0) {\n        return '0';\n      }\n      if (supportedNodes.length === 0) {\n        return ' ';\n      }\n\n      const text = joinNodesToText(state, supportedNodes);\n      return syllable(text).toString();\n    },\n  });\n","import {\n  defaultKeymap,\n  history,\n  historyKeymap,\n  redo as redoTextChange,\n  undo as undoTextChange,\n  undoDepth,\n} from '@codemirror/commands';\nimport { Diagnostic, linter, setDiagnostics } from '@codemirror/lint';\nimport { openSearchPanel, searchKeymap } from '@codemirror/search';\nimport {\n  Compartment,\n  EditorState,\n  EditorStateConfig,\n  Extension,\n  RangeSet,\n  StateEffect,\n  StateField,\n  Text,\n} from '@codemirror/state';\nimport {\n  Decoration,\n  DecorationSet,\n  EditorView,\n  keymap,\n  placeholder,\n} from '@codemirror/view';\nimport { Lyrics } from '@lyricistant/codemirror/lyrics-language';\nimport { useTheme } from '@mui/material';\nimport { differenceWith, isEqual, sample } from 'lodash-es';\nimport {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { editorTheme } from './editorTheme';\nimport { syllableCounts } from './syllableCounts';\nimport { textSelection, TextSelectionData } from './textSelection';\n\nexport { Text };\n\nconst placeholders = [\n  'Type your lyrics...',\n  'Write your epic...',\n  'Show me your poetry...',\n  'Jot down your thoughts...',\n  'Input musings here...',\n  'Pen your next masterpiece...',\n  \"Let's write some rhymes...\",\n  \"Let's start your song...\",\n  'Tell me your story...',\n  'Speak (err, write?) your mind...',\n  'Let me assist your lyrics...',\n  'Create your next classic...',\n  \"Let's make your magnum opus...\",\n  'What do you want to write today?',\n  'Put your feelings to words...',\n];\n\ninterface Mark {\n  from: number;\n  to: number;\n}\n\nconst textChanged = (\n  onTextChanged: (text: Text, cursorPosition: number) => void,\n) =>\n  EditorView.updateListener.of((update) => {\n    if (update.docChanged || update.selectionSet) {\n      onTextChanged(update.state.doc, update.state.selection.main.from);\n    }\n  });\n\nconst fileDropped = (onFileDropped: (item: DataTransferItem | File) => void) =>\n  EditorView.domEventHandlers({\n    drop: (event) => {\n      event.stopPropagation();\n      event.preventDefault();\n      if (\n        event.dataTransfer?.items?.length > 0 ||\n        event.dataTransfer?.files?.length > 0\n      ) {\n        onFileDropped(\n          event.dataTransfer?.items?.[0] || event.dataTransfer?.files?.[0],\n        );\n      }\n    },\n  });\n\ninterface ReconfigurableExtension {\n  compartment: Compartment;\n  extension: Extension;\n}\n\nconst useReconfigurableExtension = (\n  view: EditorView,\n  configs: ReconfigurableExtension[],\n) => {\n  const [lastConfigs, setLastConfigs] = useState<ReconfigurableExtension[]>([]);\n  useLayoutEffect(() => {\n    if (!view) {\n      return;\n    }\n\n    const changedConfigs = differenceWith(configs, lastConfigs, isEqual);\n\n    if (changedConfigs.length > 0) {\n      view.dispatch({\n        effects: changedConfigs.map(({ compartment, extension }) =>\n          compartment.reconfigure(extension),\n        ),\n      });\n      setLastConfigs(configs);\n    }\n  }, configs);\n};\n\nexport interface CodeMirrorEditorProps {\n  isReadOnly: boolean;\n  text: Text;\n  cursorPosition?: number;\n  font: string;\n  markedText?: Mark;\n  onTextSelected: (word: TextSelectionData) => void;\n  onTextChanged: (text: Text, cursorPosition: number) => void;\n  onFileDropped: (item: DataTransferItem | File) => void;\n  diagnostics?: Diagnostic[];\n}\n\nconst markDecoration = Decoration.mark({ class: 'cm-mark' });\nconst setMark = StateEffect.define<Mark | null>({\n  map: (mark, change) => {\n    if (!mark) {\n      return null;\n    }\n    return {\n      from: change.mapPos(mark.from),\n      to: change.mapPos(mark.to),\n    };\n  },\n});\n\nconst isApplicableAddMarkEffect = (\n  effect: StateEffect<Mark>,\n  doc: Text,\n): boolean =>\n  effect.value &&\n  effect.value.from < doc.length &&\n  effect.value.to <= doc.length &&\n  effect.value.to - effect.value.from > 0;\n\nconst markStateField = StateField.define<DecorationSet>({\n  create() {\n    return Decoration.none;\n  },\n  update(marks, tr) {\n    for (const effect of tr.effects) {\n      if (\n        effect.is(setMark) &&\n        isApplicableAddMarkEffect(effect, tr.state.doc)\n      ) {\n        return RangeSet.of(\n          markDecoration.range(effect.value.from, effect.value.to),\n        );\n      } else if (effect.is(setMark) && !effect.value) {\n        return Decoration.none;\n      }\n    }\n    return marks.map(tr.changes);\n  },\n  provide: (field) => EditorView.decorations.from(field),\n});\n\nexport const useCodeMirror = (props: CodeMirrorEditorProps) => {\n  const [view, setView] = useState<EditorView>(null);\n  const [container, setContainer] = useState<HTMLDivElement>(null);\n  const [resetCount, setResetCount] = useState(0);\n\n  const appTheme = useTheme();\n  const themeCompartment = useMemo(() => new Compartment(), []);\n  const textCompartment = useMemo(() => new Compartment(), []);\n  const selectionCompartment = useMemo(() => new Compartment(), []);\n  const fileDroppedCompartment = useMemo(() => new Compartment(), []);\n  const readOnlyCompartment = useMemo(() => new Compartment(), []);\n\n  const themeExtension = useMemo(\n    () => editorTheme(appTheme, props.font),\n    [appTheme.palette, appTheme.typography, props.font],\n  );\n  const textChangedExtension = useMemo(\n    () => textChanged(props.onTextChanged),\n    [props.onTextChanged],\n  );\n  const selectionExtension = useMemo(\n    () => textSelection(props.onTextSelected),\n    [props.onTextSelected],\n  );\n  const fileDroppedExtension = useMemo(\n    () => fileDropped(props.onFileDropped),\n    [props.onFileDropped],\n  );\n  const readOnlyExtension = useMemo(\n    () => [\n      EditorState.readOnly.of(props.isReadOnly),\n      EditorView.editable.of(!props.isReadOnly),\n    ],\n    [props.isReadOnly],\n  );\n\n  useEffect(() => {\n    if (!view) {\n      return;\n    }\n\n    const effects: Array<StateEffect<Mark>> = [];\n\n    if (!props.markedText || props.markedText.to === props.markedText.from) {\n      effects.push(setMark.of(null));\n    } else {\n      effects.push(setMark.of(props.markedText));\n    }\n\n    view.dispatch({ effects });\n  }, [props.markedText, view]);\n\n  /*\n  When the view gets its state set explicitly set (like it does when its first\n  created and whenever we need to clear the undo state), this is used to provide\n  default extensions. This is not used for \"transactional\" updates, like prop\n  changes. Only when view.setState is called.\n  \n  This still needs to be kept up to date on prop changes because we never know\n  when a new state update is going to happen. In order to reconfigure (i.e.,\n  recreate) an extension due to prop changes, rely on useReconfigurableExtension\n  instead.\n   */\n  const defaultConfig = useMemo<EditorStateConfig>(\n    () => ({\n      extensions: [\n        Lyrics(),\n        syllableCounts(),\n        history(),\n        EditorView.lineWrapping,\n        placeholder(sample(placeholders)),\n        themeCompartment.of(themeExtension),\n        textCompartment.of(textChangedExtension),\n        selectionCompartment.of(selectionExtension),\n        fileDroppedCompartment.of(fileDroppedExtension),\n        markStateField,\n        keymap.of([...defaultKeymap, ...historyKeymap, ...searchKeymap]),\n        linter(() => [], { delay: 0, tooltipFilter: () => [] }),\n        readOnlyCompartment.of(readOnlyExtension),\n      ],\n    }),\n    [\n      appTheme,\n      themeExtension,\n      textChangedExtension,\n      selectionExtension,\n      fileDroppedExtension,\n      resetCount,\n    ],\n  );\n\n  useEffect(() => {\n    if (!container) {\n      return;\n    }\n\n    const newView = new EditorView({\n      parent: container,\n    });\n    newView.setState(\n      EditorState.create({\n        ...defaultConfig,\n        doc: props.text,\n      }),\n    );\n    setView(newView);\n\n    return () => {\n      if (!container) {\n        setView(null);\n        newView.destroy();\n      }\n    };\n  }, [container]);\n\n  useEffect(\n    () => () => {\n      if (view) {\n        view.destroy();\n        setView(undefined);\n      }\n    },\n    [view],\n  );\n\n  useEffect(() => {\n    const currentText = view ? view.state.doc : Text.empty;\n    if (view && !props.text.eq(currentText)) {\n      view.dispatch({\n        changes: {\n          from: 0,\n          to: currentText.length,\n          insert: props.text ?? Text.empty,\n        },\n      });\n    }\n  }, [props.text, view]);\n\n  useEffect(() => {\n    if (\n      view &&\n      props.cursorPosition !== undefined &&\n      view.state.selection.main.empty &&\n      view.state.selection.main.anchor !== props.cursorPosition\n    ) {\n      view.dispatch({\n        selection: {\n          anchor: props.cursorPosition,\n        },\n      });\n    }\n  }, [props.cursorPosition, view]);\n\n  const reconfigurableExtensions = useMemo(\n    () => [\n      {\n        compartment: themeCompartment,\n        extension: themeExtension,\n      },\n      {\n        compartment: textCompartment,\n        extension: textChangedExtension,\n      },\n      {\n        compartment: selectionCompartment,\n        extension: selectionExtension,\n      },\n      {\n        compartment: fileDroppedCompartment,\n        extension: fileDroppedExtension,\n      },\n      {\n        compartment: readOnlyCompartment,\n        extension: readOnlyExtension,\n      },\n    ],\n    [\n      themeCompartment,\n      themeExtension,\n      textCompartment,\n      textChangedExtension,\n      selectionCompartment,\n      selectionExtension,\n      fileDroppedCompartment,\n      fileDroppedExtension,\n      readOnlyCompartment,\n      readOnlyExtension,\n    ],\n  );\n  useReconfigurableExtension(view, reconfigurableExtensions);\n\n  useEffect(() => {\n    if (!container) {\n      return;\n    }\n\n    Array.from(container.getElementsByClassName('cm-content')).forEach(\n      (element) => {\n        element.setAttribute('autocorrect', 'on');\n        element.setAttribute('autocapitalize', 'on');\n      },\n    );\n  }, [container]);\n\n  const resetHistory = useCallback(() => {\n    setResetCount((count) => count + 1);\n    return view?.setState(\n      EditorState.create({ ...defaultConfig, doc: props.text }),\n    );\n  }, [view, defaultConfig, props.text]);\n  const undo = useCallback(() => undoTextChange(view), [view]);\n  const redo = useCallback(() => redoTextChange(view), [view]);\n  const openFindReplaceDialog = useCallback(\n    () => openSearchPanel(view),\n    [view],\n  );\n\n  useEffect(() => {\n    if (view?.state) {\n      view.dispatch(setDiagnostics(view.state, props.diagnostics));\n    }\n  }, [props.diagnostics, view?.state]);\n\n  return {\n    view,\n    isModified: view?.state ? undoDepth(view.state) !== 0 : false,\n    resetHistory,\n    undo,\n    redo,\n    openFindReplaceDialog,\n    setContainer,\n  };\n};\n","import { SelectionRange, Text } from '@codemirror/state';\nimport { EditorView } from '@codemirror/view';\nimport { SyntaxNode } from '@lezer/common';\nimport {\n  doesNodeContainSelection,\n  getLyricNodesBetween,\n} from '@lyricistant/codemirror/SyntaxNodes';\n\nexport interface TextSelectionData {\n  from: number;\n  to: number;\n  text: string;\n}\n\nexport const textSelection = (\n  onTextSelected: (word: TextSelectionData) => void,\n) => [\n  EditorView.updateListener.of((update) => {\n    if (update.selectionSet) {\n      const selectionRange = update.state.selection.asSingle().main;\n      let nodes: SyntaxNode[];\n\n      if (selectionRange.empty) {\n        const { from, to } = update.state.doc.lineAt(selectionRange.from);\n        nodes = getLyricNodesBetween(update.state, from, to);\n      } else {\n        nodes = getLyricNodesBetween(\n          update.state,\n          selectionRange.from,\n          selectionRange.to,\n        );\n      }\n\n      const hasLyricSelection = nodes.find((node) =>\n        doesNodeContainSelection(node, selectionRange),\n      );\n\n      if (hasLyricSelection) {\n        onTextSelected(findWordAt(update.state.doc, selectionRange));\n      }\n    }\n  }),\n];\n\nexport const findWordAt = (document: Text, position: SelectionRange) => {\n  const line = document.lineAt(position.head);\n  const isDelimiter = (c: string) => /[^\\w\\-']+/.exec(c);\n\n  let start;\n  let end;\n\n  if (position.empty) {\n    if (position.assoc === 1) {\n      start = position.from - line.from;\n      end = position.from + 1 - line.from;\n    } else {\n      start = position.from - 1 - line.from;\n      end = position.from - line.from;\n    }\n  } else {\n    start = position.from - line.from;\n    end = position.to - line.from;\n  }\n\n  while (start >= 0 && !isDelimiter(line.text[start])) {\n    start -= 1;\n  }\n  start = Math.max(0, start + 1);\n\n  while (end < line.length && !isDelimiter(line.text[end])) {\n    end += 1;\n  }\n  end = Math.max(start, end);\n\n  return {\n    from: start + line.from,\n    to: end + line.from,\n    text: line.text.substring(start, end),\n  };\n};\n","import {\n  Box,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogTitle,\n  Link,\n  Typography,\n} from '@mui/material';\nimport React, { useCallback, useEffect } from 'react';\n\ninterface AppErrorProps {\n  error: unknown;\n  editorText: string;\n}\n\n/**\n * A dialog that displays whenever an unrecoverable error occurs while\n * Lyricistant is running.\n *\n * @param error The error that occured. While display in development build.\n * @param editorText The text that was in the editor before the error occurred.\n */\nexport function AppError({ error, editorText }: AppErrorProps) {\n  const onClose = useCallback(() => window.location.reload(), []);\n  const onCopy = useCallback(\n    () => window.navigator.clipboard.writeText(editorText),\n    [],\n  );\n  const onDownloadLogs = useCallback(() => {\n    platformDelegate.send('save-logs');\n  }, []);\n\n  useEffect(() => {\n    logger.error('Error in renderer', error.toString());\n  }, [error]);\n  return (\n    <Dialog onClose={onClose} open>\n      <DialogTitle>Application error</DialogTitle>\n      <Box paddingLeft={'32px'} paddingRight={'32px'} paddingBottom={'24px'}>\n        <Typography component=\"p\">\n          Sorry, an error has occurred in Lyricistant. Press reload to continue,\n          but any unsaved data may be lost. You can also copy your current\n          lyrics to the clipboard, and attempt to download logs.\n        </Typography>\n        <Link\n          href={'https://github.com/wardellbagby/lyricistant/issues/new/choose'}\n          rel=\"noopener\"\n          variant={'body1'}\n        >\n          Click here to report an issue.\n        </Link>\n      </Box>\n      <DialogActions>\n        <Button variant={'text'} onClick={onDownloadLogs}>\n          Download logs\n        </Button>\n        <Button variant={'text'} onClick={onCopy}>\n          Copy lyrics\n        </Button>\n        <Button variant={'text'} color={'warning'} onClick={onClose}>\n          Reload\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n}\n","import { APP_HOMEPAGE, APP_VERSION } from '@lyricistant/renderer/globals';\nimport { ReactComponent as Logo } from '@lyricistant/renderer/lyricistant_logo.svg';\nimport {\n  Box,\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  Grid,\n  Link,\n  Table,\n  TableBody,\n  TableCell,\n  TableCellProps,\n  TableContainer,\n  TableRow,\n  Typography,\n  useTheme,\n} from '@mui/material';\nimport React from 'react';\n\nconst aboutInfo: Record<string, React.JSX.Element> = {\n  'Code repository': (\n    <Link target=\"_blank\" rel=\"noopener\" href={APP_HOMEPAGE}>\n      GitHub\n    </Link>\n  ),\n  'My website': (\n    <Link target=\"_blank\" rel=\"noopener\" href={'https://wardellbagby.com'}>\n      wardellbagby.com\n    </Link>\n  ),\n  'Report an issue': (\n    <Link\n      target=\"_blank\"\n      rel=\"noopener\"\n      href={'https://github.com/wardellbagby/lyricistant/issues/new'}\n    >\n      Issues\n    </Link>\n  ),\n} as const;\n\nconst DividerlessTableCell = (props: TableCellProps) => (\n  <TableCell sx={{ borderBottom: 'none' }} {...props} />\n);\n\n/** The props needed to render an {@link AboutDialog}. */\ninterface AboutDialogProps {\n  /** Whether this dialog is opened or not. */\n  open: boolean;\n  /** Invoked when the {@link AboutDialog} is closed. */\n  onClose: () => void;\n}\n\n/**\n * A dialog that shows information about Lyricistant, links to the author, a\n * link to report issues, and a button to download logs.\n *\n * @param props The props needed to render this component.\n */\nexport const AboutDialog = (props: AboutDialogProps) => {\n  const theme = useTheme();\n  return (\n    <Dialog\n      onClose={props.onClose}\n      open={props.open}\n      className={'paper'}\n      scroll={'paper'}\n    >\n      <DialogContent>\n        <Grid\n          container\n          spacing={1}\n          direction=\"column\"\n          justifyContent=\"center\"\n          alignItems=\"center\"\n        >\n          <Grid size={{ xs: 12 }}>\n            <Logo\n              height={'96px'}\n              width={'96px'}\n              fill={theme.palette.primary.main}\n            />\n          </Grid>\n          <Grid size={{ xs: 12 }}>\n            <Typography variant={'h6'}>Lyricistant - {APP_VERSION}</Typography>\n          </Grid>\n          <Grid size={{ xs: 8 }}>\n            <p>\n              Hey! I'm Wardell, and I created Lyricistant! This app is\n              completely free to use and entirely open-source. Make your own\n              modifications, just make sure to make them open-source as well!\n            </p>\n            <p>\n              I use Lyricistant personally to write my own music, which I'd love\n              for you to listen to! Catch me on{' '}\n              <Link\n                target=\"_blank\"\n                rel=\"noopener\"\n                href={'https://open.spotify.com/artist/5NaXw8enpDRFxiTcB0J6H5'}\n              >\n                Spotify\n              </Link>\n              ,{' '}\n              <Link\n                target=\"_blank\"\n                rel=\"noopener\"\n                href={\n                  'https://music.apple.com/us/artist/mr-chandler/1331569890'\n                }\n              >\n                Apple Music\n              </Link>\n              , or peep my{' '}\n              <Link\n                target=\"_blank\"\n                rel=\"noopener\"\n                href={'https://soundcloud.com/mr-chandler'}\n              >\n                SoundCloud.\n              </Link>\n            </p>\n            <p>Enjoy using Lyricistant!</p>\n          </Grid>\n          <Grid size={{ xs: 12 }}>\n            <TableContainer>\n              <Table size={'small'}>\n                <TableBody>\n                  {Object.keys(aboutInfo)\n                    .map((key: keyof typeof aboutInfo) => [key, aboutInfo[key]])\n                    .map(([key, value]: [string, React.JSX.Element]) => (\n                      <TableRow key={key}>\n                        <DividerlessTableCell>{key}</DividerlessTableCell>\n                        <DividerlessTableCell>{value}</DividerlessTableCell>\n                      </TableRow>\n                    ))}\n                </TableBody>\n              </Table>\n            </TableContainer>\n          </Grid>\n          <Box height={'8px'} />\n          <Grid size={{ xs: 12 }}>\n            <Button\n              variant={'outlined'}\n              onClick={() => platformDelegate.send('save-logs')}\n            >\n              Download logs\n            </Button>\n          </Grid>\n        </Grid>\n      </DialogContent>\n      <DialogActions>\n        <Button fullWidth variant={'contained'} onClick={props.onClose}>\n          Close\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n","import { useCallback } from 'react';\nimport { useLocation } from 'wouter';\n\n/** The paths that Lyricistant can navigate to. */\nexport type RoutePaths =\n  | '/'\n  | '/about'\n  | '/download'\n  | '/file-history'\n  | '/preferences'\n  | '/privacypolicy';\n\nexport const useNavigation = () => {\n  const setLocation = useLocation()[1];\n  return (path: RoutePaths, options?: { replace?: boolean }) => {\n    setLocation(path.replace('/', ''), options);\n  };\n};\n\nexport const useBackNavigation = () => {\n  const navigate = useNavigation();\n  return useCallback(() => {\n    const state: Record<string, never> = window.history.state;\n    if (state?.['internal'] === true) {\n      window.history.back();\n    } else {\n      navigate('/', { replace: true });\n    }\n  }, []);\n};\n","export interface Release {\n  platform: 'Mac' | 'Windows' | 'Linux' | 'Android' | 'iOS';\n  asset?: string;\n  url?: string;\n  arch?: string;\n}\n\nexport const supportedReleases: Release[] = [\n  { platform: 'Mac', asset: 'lyricistant-mac_x64.dmg' },\n  {\n    platform: 'Windows',\n    asset: 'lyricistant-win.exe',\n  },\n  {\n    platform: 'iOS',\n    url: 'https://apps.apple.com/om/app/lyricistant/id1561506174',\n  },\n  {\n    platform: 'Android',\n    url: 'https://play.google.com/store/apps/details?id=com.wardellbagby.lyricistant',\n  },\n  {\n    platform: 'Linux',\n    asset: 'lyricistant-linux_x86_64.AppImage',\n    arch: 'x64',\n  },\n  {\n    platform: 'Linux',\n    asset: 'lyricistant-linux_arm64.AppImage',\n    arch: 'arm64',\n  },\n];\n","import { isUnderTest } from '@lyricistant/common/BuildModes';\nimport { Logger } from '@lyricistant/common/Logger';\nimport { Octokit, RestEndpointMethodTypes } from '@octokit/rest';\nimport semver from 'semver';\n\nexport interface ReleaseData {\n  baseDownloadUrl: string;\n  changelog: string;\n}\n\nexport type GitHubRelease =\n  RestEndpointMethodTypes['repos']['listReleases']['response']['data'][0];\n\nexport class ReleaseHelper {\n  private static readonly LYRICISTANT_REPO = {\n    owner: 'wardellbagby',\n    repo: 'lyricistant',\n  };\n\n  private readonly octokit: Octokit;\n  private cachedReleases: GitHubRelease[] = [];\n\n  public constructor(private logger: Logger) {\n    this.octokit = new Octokit();\n  }\n\n  /**\n   * Returns the latest release of Lyricistant that can be downloaded. By\n   * default, this will only consider releases newer than the current, but by\n   * setting `options.includeCurrentVersion`, the current release will also be included.\n   *\n   * @param currentVersion The current version of Lyricistant that is running this check.\n   * @param options Options for how to decide what the \"latest\" release is.\n   */\n  public getLatestDownloadableRelease = async (\n    currentVersion: string,\n    options: { includeCurrentVersion?: boolean } = {\n      includeCurrentVersion: false,\n    },\n  ): Promise<ReleaseData> => {\n    if (isUnderTest) {\n      return null;\n    }\n\n    this.logger.debug('Checking for new GitHub releases', { currentVersion });\n    const releases = await this.getGitHubReleases(\n      currentVersion,\n      options.includeCurrentVersion ?? false,\n    );\n\n    if (releases.length === 0) {\n      return null;\n    }\n\n    const newestRelease = releases[0];\n    this.logger.debug('Newest available release', {\n      tag: newestRelease.tag_name,\n    });\n    return {\n      // Convert to a URL we can append a file name to\n      baseDownloadUrl: this.getBaseDownloadUrl(newestRelease),\n      changelog: this.getChangelog(releases),\n    };\n  };\n\n  private getGitHubReleases = async (\n    currentVersion: string,\n    includeCurrentVersion: boolean,\n  ) => {\n    if (this.cachedReleases.length > 0) {\n      this.logger.debug('Returning cached releases', {\n        releases: this.cachedReleases,\n      });\n      return this.cachedReleases;\n    }\n\n    try {\n      const result = await this.octokit.rest.repos.listReleases(\n        ReleaseHelper.LYRICISTANT_REPO,\n      );\n\n      for (const release of result.data) {\n        // latest tag is always a nightly build; don't upgrade to those.\n        if (release.tag_name === 'latest') {\n          continue;\n        }\n        if (\n          !includeCurrentVersion &&\n          !this.isReleaseNewerThanCurrent(currentVersion, release)\n        ) {\n          break;\n        }\n        if (release.assets.some((asset) => asset.name === 'latest.yml')) {\n          this.cachedReleases.push(release);\n        }\n      }\n\n      return this.cachedReleases;\n    } catch (e) {\n      this.logger.warn('Failed to load releases', e);\n      this.cachedReleases = [];\n      return this.cachedReleases;\n    }\n  };\n\n  private isReleaseNewerThanCurrent = (\n    currentVersion: string,\n    release: GitHubRelease,\n  ): boolean => {\n    const current = semver.coerce(currentVersion);\n    const next = semver.coerce(release.tag_name);\n    if (!current || !next) {\n      this.logger.warn('Failed to compare versions', {\n        current,\n        next,\n        currentVersionString: currentVersion,\n        releaseTag: release.tag_name,\n      });\n      return false;\n    }\n    return semver.gt(next, current);\n  };\n\n  private getBaseDownloadUrl = (release: GitHubRelease) =>\n    this.removeFilename(release.assets[0].browser_download_url);\n\n  private getChangelog = (releases: GitHubRelease[]) =>\n    releases.reduce(\n      (changelog: string, release) =>\n        `##${release.name}\\n\\n${release.body}\\n\\n${changelog}`,\n      '',\n    );\n\n  /**\n   * Takes a URL in the form of https://example.com/path/file.txt and converts\n   * it to https://example.com/path/\n   */\n  private removeFilename = (url: string): string =>\n    url.substring(0, url.lastIndexOf('/') + 1);\n}\n","import {\n  ReleaseData,\n  ReleaseHelper,\n} from '@lyricistant/common/releases/ReleaseHelper';\nimport { assign, createMachine, EventObject, fromPromise } from 'xstate';\n\nlet releaseHelper: ReleaseHelper = null;\nconst lazyReleaseHelper = () => {\n  if (releaseHelper) {\n    return releaseHelper;\n  }\n  releaseHelper = new ReleaseHelper(logger);\n  return releaseHelper;\n};\n\ninterface LatestReleaseContext {\n  releaseData?: ReleaseData;\n  error?: unknown;\n}\n\ninterface LatestReleaseEvent extends EventObject {\n  type: 'INPUT';\n  currentVersion: string;\n}\n\nexport const latestReleaseMachine = createMachine({\n  types: {} as {\n    context: LatestReleaseContext;\n    events: LatestReleaseEvent;\n  },\n  id: 'latest-release',\n  initial: 'inactive',\n  context: {\n    releaseData: null,\n  },\n  on: {\n    INPUT: [\n      {\n        target: '.loading',\n      },\n    ],\n  },\n  states: {\n    inactive: {},\n    loading: {\n      invoke: {\n        input: ({ event }) => event,\n        src: fromPromise<ReleaseData, LatestReleaseEvent>(async ({ input }) =>\n          lazyReleaseHelper().getLatestDownloadableRelease(\n            input.currentVersion,\n            {\n              includeCurrentVersion: true,\n            },\n          ),\n        ),\n        onDone: [\n          {\n            target: 'loaded',\n            guard: (args) => args.event.output != null,\n            actions: assign({\n              releaseData: (args) => args.event.output,\n            }),\n          },\n          { target: 'error' },\n        ],\n        onError: {\n          target: 'error',\n          actions: assign({\n            releaseData: (): null => null,\n          }),\n        },\n      },\n    },\n    loaded: {\n      id: 'loaded',\n    },\n    error: {\n      id: 'error',\n    },\n  },\n});\n","import { Release, supportedReleases } from '@lyricistant/renderer/download';\nimport { latestReleaseMachine } from '@lyricistant/renderer/download/LatestReleaseMachine';\nimport { APP_VERSION } from '@lyricistant/renderer/globals';\nimport { Android } from '@mui/icons-material';\nimport {\n  Accordion,\n  AccordionDetails,\n  AccordionSummary,\n  Box,\n  Button,\n  CircularProgress,\n  Dialog,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Grid,\n} from '@mui/material';\nimport { useMachine } from '@xstate/react';\nimport { Apple, AppleIos, Linux, MicrosoftWindows } from 'mdi-material-ui';\nimport React, { useCallback, useEffect, useMemo } from 'react';\n\nconst releaseColor = ({ platform }: Release) => {\n  switch (platform) {\n    case 'Linux':\n      return '#0099cc';\n    case 'Android':\n      return '#3DDC84';\n    case 'Mac':\n    case 'iOS':\n      return '#555555';\n    case 'Windows':\n      return '#00A4EF';\n  }\n};\n\nconst PlatformDownloadOptions = (props: {\n  platform: string;\n  releases: Release[];\n  onClick: (release: Release) => void;\n}) => {\n  const children = useMemo(\n    () =>\n      props.releases.map((release) => (\n        <Grid\n          key={`${release.platform}/${release.asset}/${release.url}`}\n          sx={{ xs: 6 }}\n        >\n          <DownloadButton\n            release={release}\n            onClick={() => {\n              props.onClick(release);\n            }}\n          />\n        </Grid>\n      )),\n    [props.releases, props.onClick],\n  );\n\n  if (props.releases.length > 1) {\n    return (\n      <Grid\n        container\n        sx={{ xs: 12 }}\n        spacing={1}\n        alignItems={'center'}\n        justifyContent={'center'}\n      >\n        <Grid sx={{ xs: 12 }}>\n          <Accordion\n            key={props.platform + 'accordion'}\n            sx={{ padding: '0px', boxShadow: 'unset' }}\n          >\n            <AccordionSummary sx={{ padding: '0px' }}>\n              <Box padding={'8px'} width={'100%'}>\n                <Button\n                  sx={{\n                    background: releaseColor(props.releases[0]),\n                    color: releaseTextColor(props.releases[0]),\n                    textTransform: 'none',\n                  }}\n                  variant={'contained'}\n                  fullWidth\n                  startIcon={<ReleaseIcon platform={props.platform} />}\n                  size={'large'}\n                >\n                  {props.platform}\n                </Button>\n              </Box>\n            </AccordionSummary>\n            <AccordionDetails>\n              <Grid container>{children}</Grid>\n            </AccordionDetails>\n          </Accordion>\n        </Grid>\n      </Grid>\n    );\n  } else {\n    return <>{children}</>;\n  }\n};\n\nconst downloadLabel = ({\n  platform,\n  arch,\n}: {\n  platform: string;\n  arch?: string;\n}) => {\n  switch (platform) {\n    case 'Linux':\n      return `${platform} - ${arch}`;\n    case 'iOS':\n      return 'iPhone / iPad';\n    default:\n      return platform;\n  }\n};\n\nconst releaseTextColor = ({ platform }: Release) => {\n  switch (platform) {\n    case 'Mac':\n    case 'iOS':\n      return '#FFFFFF';\n    case 'Windows':\n    case 'Linux':\n    case 'Android':\n      return '#000000';\n  }\n};\n\nconst DownloadButton = (props: { release: Release; onClick?: () => void }) => {\n  const { release, onClick } = props;\n\n  return (\n    <Box padding={'8px'}>\n      <Button\n        sx={{\n          background: releaseColor(release),\n          color: releaseTextColor(release),\n          textTransform: 'none',\n        }}\n        variant={'contained'}\n        fullWidth\n        startIcon={<ReleaseIcon {...release} />}\n        size={'large'}\n        onClick={onClick}\n      >\n        {downloadLabel(release)}\n      </Button>\n    </Box>\n  );\n};\n\ninterface ChooseDownloadDialogProps {\n  open: boolean;\n  onClose: () => void;\n}\n\n/** A dialog that allows users to select and download different versions of Lyricistant. */\nexport const ChooseDownloadDialog = (props: ChooseDownloadDialogProps) => {\n  const [state, send] = useMachine(latestReleaseMachine);\n\n  useEffect(() => {\n    if (props.open) {\n      send({ type: 'INPUT', currentVersion: APP_VERSION });\n    }\n  }, [props.open]);\n\n  const onReleaseClicked = useCallback(\n    (release: Release) => {\n      const url =\n        release.url ??\n        state.context.releaseData.baseDownloadUrl + release.asset;\n      logger.info(`App download link clicked. Chosen URL: ${url}`);\n      window.open(url, '_blank');\n      props.onClose();\n    },\n    [state.context.releaseData?.baseDownloadUrl],\n  );\n\n  const releases = useMemo(\n    () =>\n      supportedReleases.reduce((map, release) => {\n        const list = map.get(release.platform) ?? [];\n        map.set(release.platform, [...list, release]);\n        return map;\n      }, new Map<string, Release[]>()),\n    [],\n  );\n\n  return (\n    <Dialog\n      onClose={props.onClose}\n      aria-labelledby=\"choose-download-dialog-title\"\n      open={props.open}\n    >\n      <DialogTitle id=\"choose-download-dialog-title\">\n        Download Lyricistant\n      </DialogTitle>\n      <DialogContent>\n        {state.matches('loading') && (\n          <Box display={'flex'} alignItems={'center'} justifyContent={'center'}>\n            <CircularProgress size={'64px'} variant={'indeterminate'} />\n          </Box>\n        )}\n        {state.matches('loaded') && (\n          <DownloadButtons\n            releases={releases}\n            onReleaseClicked={onReleaseClicked}\n          />\n        )}\n        {state.matches('error') && (\n          <DialogContentText>\n            Failed to fetch latest download information. Please try again later.\n          </DialogContentText>\n        )}\n      </DialogContent>\n      <Button\n        size={'large'}\n        variant={'contained'}\n        fullWidth\n        onClick={props.onClose}\n      >\n        Close\n      </Button>\n    </Dialog>\n  );\n};\n\nconst DownloadButtons = (props: {\n  releases: Map<string, Release[]>;\n  onReleaseClicked: (release: Release) => void;\n}) => (\n  <Grid container spacing={1} alignItems={'center'} justifyContent={'center'}>\n    {[...props.releases.keys()].map((platform) => (\n      <PlatformDownloadOptions\n        key={platform}\n        platform={platform}\n        releases={props.releases.get(platform)}\n        onClick={(release) => props.onReleaseClicked(release)}\n      />\n    ))}\n  </Grid>\n);\n\nconst ReleaseIcon = ({ platform }: { platform: string }) => {\n  switch (platform) {\n    case 'Linux':\n      return <Linux />;\n    case 'Mac':\n      return <Apple />;\n    case 'Windows':\n      return <MicrosoftWindows />;\n    case 'Android':\n      return <Android />;\n    case 'iOS':\n      return <AppleIos />;\n  }\n};\n","import React, { useContext } from 'react';\n\nexport const ReadOnlyModeContext = React.createContext(false);\n\n/**\n * Retrieve the current status of \"readonly mode\". When this is true, the user\n * shouldn't be allowed to take any actions that would result in their lyrics\n * being edited in any way.\n */\nexport const useReadOnlyMode = (): boolean => useContext(ReadOnlyModeContext);\n","import { useTheme, useMediaQuery } from '@mui/material';\n\n/**\n * A React hook that returns a boolean saying whether Lyricistant is using its\n * small, mobile friendly layout or not.\n *\n * @returns True if using small layout, false if not.\n */\nexport const useSmallLayout = (): boolean => {\n  const theme = useTheme();\n  return useMediaQuery(theme.breakpoints.down('md'));\n};\n","import {\n  PlatformToRendererListener,\n  RendererChannel,\n} from '@lyricistant/common/Delegates';\nimport { DependencyList, useEffect, useState } from 'react';\n\n/**\n * Register the provided listener on the given platform channel. The listener\n * will be invoked whenever the platform sends data to the given channel.\n *\n * @param channel Platform channel to listen to changes on.\n * @param listener Listener that will be invoked.\n * @param deps The dependencies that will be used to re-register the listener\n *   whenever they change. If not provided, listener will be re-registered\n *   whenever the React component is re-mounted. This differs from useEffect\n *   when no dependency list is provided, as useEffect would re-register on\n *   every render pass.\n */\nexport const useChannel: <Channel extends RendererChannel>(\n  channel: Channel,\n  listener: PlatformToRendererListener[Channel],\n  deps?: DependencyList,\n) => void = (channel, listener, deps) => {\n  useEffect(() => {\n    platformDelegate.on(channel, listener);\n    return () => {\n      platformDelegate.removeListener(channel, listener);\n    };\n  }, deps ?? []);\n};\n\n/**\n * Returns the most recent data that that has been sent via this channel to the\n * renderer while this hook was running.\n *\n * Note: This will return an empty array initially, so while destructuring it\n * will work, all values will be undefined until this channel emits something.\n *\n * @param channel Platform channel to listen to changes on.\n * @param shouldRegister When this is true, will attempt to register. If this is\n *   false, it won't register. Useful for when the change of a dependency should\n *   re-register a listener on the platform, but only in certain situations,\n *   like to only register when a dialog is open.\n */\nexport const useChannelData: <Channel extends RendererChannel>(\n  channel: Channel,\n  shouldRegister?: boolean,\n) => Parameters<PlatformToRendererListener[Channel]> = (\n  channel,\n  shouldRegister,\n) => {\n  const [result, setResult] = useState([]);\n  useEffect(() => {\n    if (shouldRegister === false) {\n      return;\n    }\n    const listener = (...args: unknown[]) => {\n      setResult(args);\n    };\n    platformDelegate.on(channel, listener);\n    return () => {\n      platformDelegate.removeListener(channel, listener);\n    };\n  }, [shouldRegister]);\n  // Disable no explicit any here since Typescript can't know that the types\n  // work out here due to generics erasure.\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  return result as any;\n};\n","import {\n  Chunk,\n  ChunkLine,\n  ParsedHistoryData,\n} from '@lyricistant/common/history/ParsedHistoryData';\nimport { useReadOnlyMode } from '@lyricistant/renderer/app/useReadOnlyMode';\nimport { useSmallLayout } from '@lyricistant/renderer/app/useSmallLayout';\nimport { useChannelData } from '@lyricistant/renderer/platform/useChannel';\nimport {\n  Box,\n  Button,\n  CircularProgress,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  Divider,\n  Drawer,\n  List,\n  ListItem,\n  ListItemText,\n  SxProps,\n  Theme,\n  useTheme,\n} from '@mui/material';\nimport React, { useCallback, useMemo, useState } from 'react';\n\ninterface FileHistoryItemProps {\n  data: ParsedHistoryData;\n  onClick: () => void;\n}\n\nconst FileHistoryItem = ({ data, onClick }: FileHistoryItemProps) => (\n  <ListItem onClick={onClick}>\n    <ListItemText primary={data.time} />\n  </ListItem>\n);\n\ninterface FileHistoryProps {\n  open: boolean;\n  onClose: () => void;\n}\n\nconst VisualChunkLine = (props: { line: ChunkLine }) => {\n  const theme = useTheme();\n  const { backgroundColor, foregroundColor } = useMemo(() => {\n    if (props.line.type === 'new') {\n      return {\n        backgroundColor: theme.palette.success.main,\n        foregroundColor: theme.palette.success.contrastText,\n      };\n    } else if (props.line.type === 'old') {\n      return {\n        backgroundColor: theme.palette.error.main,\n        foregroundColor: theme.palette.error.contrastText,\n      };\n    }\n    return {};\n  }, [theme]);\n  const fontFamily = useMemo(() => {\n    if (props.line.control) {\n      return 'monospace';\n    }\n  }, [props.line.control]);\n\n  return (\n    <Box\n      sx={{\n        background: backgroundColor,\n        color: foregroundColor,\n        fontFamily,\n      }}\n    >\n      {props.line.line}\n    </Box>\n  );\n};\nconst VisualChunk = (props: { chunk: Chunk }) => (\n  <Box\n    marginBottom={'12px'}\n    padding={'12px'}\n    sx={{\n      border: 2,\n      borderRadius: 1,\n      borderColor: (theme: Theme) => theme.palette.divider,\n    }}\n  >\n    {props.chunk.lines.map((line, index) => (\n      <VisualChunkLine key={index} line={line} />\n    ))}\n  </Box>\n);\n\nconst FileHistoryList = (props: {\n  historyData: ParsedHistoryData[];\n  onFileHistoryClicked: (history: ParsedHistoryData) => void;\n}) => {\n  if (props.historyData?.length === 0) {\n    return <DialogContentText>No file history.</DialogContentText>;\n  }\n  if (!props.historyData) {\n    return (\n      <Box\n        width={'100%'}\n        display={'flex'}\n        justifyContent={'center'}\n        alignItems={'center'}\n      >\n        <CircularProgress size={'48px'} variant={'indeterminate'} />\n      </Box>\n    );\n  }\n  return (\n    <List>\n      {props.historyData.map((data, index) => (\n        <React.Fragment key={index}>\n          <FileHistoryItem\n            data={data}\n            onClick={() => {\n              props.onFileHistoryClicked(data);\n            }}\n          />\n          <Divider />\n        </React.Fragment>\n      ))}\n    </List>\n  );\n};\n/**\n * A dialog that displays file history from the platform and allows the user to\n * select a file history to apply.\n *\n * @param props The props needed to render this component.\n */\nexport function FileHistory(props: FileHistoryProps) {\n  const onClose = useCallback(() => {\n    setDisplayedHistory(null);\n    props.onClose();\n  }, []);\n\n  const [historyData] = useChannelData('file-history', props.open);\n  const [displayedHistory, setDisplayedHistory] =\n    useState<ParsedHistoryData>(null);\n  const isReadOnly = useReadOnlyMode();\n\n  const anchor = useSmallLayout() ? 'bottom' : 'right';\n\n  const paperBounds: SxProps =\n    anchor === 'right'\n      ? { width: '35%', maxWidth: '400px' }\n      : { height: '50%', maxHeight: '500px' };\n\n  return (\n    <>\n      <Dialog\n        open={!!displayedHistory}\n        maxWidth={'md'}\n        onClose={() => setDisplayedHistory(null)}\n      >\n        <DialogTitle>{displayedHistory?.time}</DialogTitle>\n        <Divider />\n        <DialogContent>\n          {displayedHistory?.chunks.map((chunk, index) => (\n            <VisualChunk key={index} chunk={chunk} />\n          ))}\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDisplayedHistory(null)}>Close</Button>\n          {!isReadOnly && (\n            <Button\n              onClick={() => {\n                platformDelegate.send('apply-file-history', displayedHistory);\n                setDisplayedHistory(null);\n                onClose();\n              }}\n            >\n              Apply\n            </Button>\n          )}\n        </DialogActions>\n      </Dialog>\n      <Drawer\n        onClose={onClose}\n        open={props.open}\n        anchor={anchor}\n        PaperProps={{ sx: paperBounds }}\n      >\n        <DialogTitle>File history</DialogTitle>\n        <Divider />\n        <DialogContent>\n          <FileHistoryList\n            historyData={historyData}\n            onFileHistoryClicked={setDisplayedHistory}\n          />\n        </DialogContent>\n      </Drawer>\n    </>\n  );\n}\n","import ReactMarkdown from 'markdown-to-jsx';\nimport React from 'react';\n\n/**\n * Renders text as markdown.\n *\n * @param text The text to render as markdown.\n */\nexport const Markdown: React.FC<{ text: string }> = ({ text }) => (\n  <ReactMarkdown children={text} options={{ disableParsingRawHTML: true }} />\n);\n","import {\n  AlertDialogData,\n  DialogData,\n  DialogInteractionData,\n  FullscreenDialogData,\n  SelectionDialogData,\n} from '@lyricistant/common/dialogs/Dialog';\nimport { Markdown } from '@lyricistant/renderer/markdown/Markdown';\nimport { useChannel } from '@lyricistant/renderer/platform/useChannel';\nimport { ExpandMore } from '@mui/icons-material';\nimport {\n  Accordion,\n  AccordionDetails,\n  AccordionSummary,\n  alpha,\n  Box,\n  Button,\n  Checkbox,\n  CircularProgress,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n  FormControlLabel,\n  FormGroup,\n  Grow,\n  LinearProgress,\n  LinearProgressProps,\n  MenuItem,\n  Select,\n  TextField,\n  Typography,\n} from '@mui/material';\nimport * as React from 'react';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nconst MINIMUM_DIALOG_DISPLAY_MILLIS = 500;\n\n/** Displays dialogs that the platform has requested to be shown. */\nexport function PlatformDialogs() {\n  const [dialogData, setDialogData] = useState<DialogData>(null);\n  const [closeDialogTag, setCloseDialogTag] = useState<string>(null);\n  const [open, setOpen] = useState(false);\n  const lastOpenedDialogTime = useRef<number | null>(null);\n\n  const onDialogInteraction = useCallback(\n    (interactionData: DialogInteractionData) => {\n      setOpen(false);\n      platformDelegate.send(\n        'dialog-interaction',\n        dialogData.tag,\n        interactionData,\n      );\n      platformDelegate.send('dialog-closed', dialogData.tag);\n    },\n    [dialogData],\n  );\n\n  const onClosed = useCallback(() => {\n    setOpen(false);\n    platformDelegate.send('dialog-closed', dialogData.tag);\n  }, [dialogData]);\n\n  useChannel('show-dialog', (data) => {\n    setDialogData(data);\n    setOpen(true);\n  });\n  useChannel('close-dialog', setCloseDialogTag);\n\n  useEffect(() => {\n    if (dialogData != null) {\n      lastOpenedDialogTime.current = performance.now();\n    }\n  }, [dialogData]);\n\n  useEffect(() => {\n    if (closeDialogTag && closeDialogTag === dialogData?.tag) {\n      const close = () => {\n        setOpen(false);\n        setCloseDialogTag(null);\n        platformDelegate.send('dialog-closed', dialogData.tag);\n      };\n\n      const delta = performance.now() - lastOpenedDialogTime.current;\n      // MUI has a bug where showing a full screen dialog for a single frame will keep it displayed but invisible.\n      // This gets around that and improves the UX anyway by keeping a dialog open for at least a bit which prevents\n      // frame flicker. Only full screens dialogs suffer from this since other types rely on user input and so will\n      // exist long enough to be interacted with. As of writing this, anyway.\n      if (\n        dialogData.type === 'fullscreen' &&\n        delta <= MINIMUM_DIALOG_DISPLAY_MILLIS\n      ) {\n        setTimeout(close, delta);\n      } else {\n        close();\n      }\n    }\n  }, [closeDialogTag, dialogData]);\n\n  if (!dialogData) {\n    return <div />;\n  }\n\n  if (dialogData.type === 'alert') {\n    return (\n      <AlertDialog\n        open={open}\n        dialogData={dialogData}\n        onDialogInteraction={onDialogInteraction}\n      />\n    );\n  } else if (dialogData.type === 'fullscreen') {\n    return (\n      <FullscreenDialog\n        open={open}\n        dialogData={dialogData}\n        onCancel={onClosed}\n      />\n    );\n  } else if (dialogData.type === 'selection') {\n    return (\n      <SelectionDialog\n        open={open}\n        dialogData={dialogData}\n        onDialogInteraction={onDialogInteraction}\n        onClosed={onClosed}\n      />\n    );\n  }\n}\n\nconst FullscreenDialog = ({\n  open,\n  dialogData,\n  onCancel,\n}: {\n  open: boolean;\n  dialogData: FullscreenDialogData;\n  onCancel: () => void;\n}) => (\n  <Dialog\n    open={open}\n    onTransitionCancel={onCancel}\n    fullScreen\n    sx={{\n      overflow: 'none',\n    }}\n    slotProps={{\n      transition: Grow,\n      paper: {\n        sx: {\n          backgroundColor: (theme) =>\n            alpha(theme.palette.background.paper, 0.5),\n        },\n      },\n    }}\n  >\n    <DialogContent\n      sx={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        flexDirection: 'column',\n        gap: '48px',\n      }}\n    >\n      {dialogData.message && (\n        <DialogContentText variant={'h5'}>\n          {dialogData.message}\n        </DialogContentText>\n      )}\n      {dialogData.progress &&\n        (dialogData.progress === 'indeterminate' ? (\n          <CircularProgress\n            size={'min(20vmin, 200px)'}\n            variant={'indeterminate'}\n          />\n        ) : (\n          <LinearProgressWithLabel value={dialogData.progress} />\n        ))}\n      {dialogData.cancelable && (\n        <Button variant={'outlined'} onClick={onCancel}>\n          Cancel\n        </Button>\n      )}\n    </DialogContent>\n  </Dialog>\n);\n\nconst AlertDialog = ({\n  open,\n  dialogData,\n  onDialogInteraction,\n}: {\n  open: boolean;\n  dialogData: AlertDialogData;\n  onDialogInteraction: (interactionData: DialogInteractionData) => void;\n}) => {\n  const [text, setText] = useState<string>(\n    dialogData.textField?.defaultValue ?? '',\n  );\n\n  const isTextFieldValid = useMemo(() => {\n    if (dialogData.textField?.validationRegex == null) {\n      return true;\n    }\n\n    return RegExp(dialogData.textField.validationRegex).test(text);\n  }, [dialogData.textField?.validationRegex, text]);\n\n  return (\n    <Dialog\n      open={open}\n      sx={{\n        overflow: 'none',\n      }}\n    >\n      <DialogTitle>{dialogData.title}</DialogTitle>\n      <DialogContent>\n        {dialogData.message && (\n          <DialogContentText>{dialogData.message}</DialogContentText>\n        )}\n        {dialogData.collapsibleMessage && (\n          <Accordion elevation={0} square>\n            <AccordionSummary\n              expandIcon={<ExpandMore />}\n              sx={{\n                paddingLeft: '0px',\n                paddingRight: '0px',\n              }}\n            >\n              <DialogContentText>\n                {dialogData.collapsibleMessage.label}\n              </DialogContentText>\n            </AccordionSummary>\n            <AccordionDetails\n              sx={{\n                overflowY: 'auto',\n                wordBreak: 'break-word',\n                maxHeight: '300px',\n              }}\n            >\n              <DialogContentText>\n                <Markdown text={dialogData.collapsibleMessage.message} />\n              </DialogContentText>\n            </AccordionDetails>\n          </Accordion>\n        )}\n        {dialogData.progress && (\n          <LinearProgressWithLabel value={dialogData.progress} />\n        )}\n        {dialogData.textField && (\n          <TextField\n            fullWidth\n            margin={'dense'}\n            variant={'outlined'}\n            label={dialogData.textField.label}\n            value={text}\n            onChange={(event: React.ChangeEvent<HTMLInputElement>) => {\n              setText(event.target.value);\n            }}\n          />\n        )}\n      </DialogContent>\n\n      {dialogData.buttons && (\n        <DialogActions>\n          {dialogData.buttons.map((label, index) => (\n            <Button\n              key={label}\n              onClick={() => {\n                onDialogInteraction({ selectedButton: label, textField: text });\n              }}\n              color=\"primary\"\n              disabled={\n                !isTextFieldValid && index === dialogData.buttons.length - 1\n              }\n              variant={\n                index === dialogData.buttons.length - 1 ? 'contained' : 'text'\n              }\n            >\n              {label}\n            </Button>\n          ))}\n        </DialogActions>\n      )}\n    </Dialog>\n  );\n};\n\nconst SelectionDialog = ({\n  open,\n  dialogData,\n  onDialogInteraction,\n  onClosed,\n}: {\n  open: boolean;\n  dialogData: SelectionDialogData;\n  onDialogInteraction: (interactionData?: DialogInteractionData) => void;\n  onClosed: () => void;\n}) => {\n  const [selection, setSelection] = useState<string>(dialogData.options[0]);\n  const [isChecked, setChecked] = useState(false);\n  return (\n    <Dialog open={open}>\n      <DialogTitle>{dialogData.title}</DialogTitle>\n      <DialogContent>\n        <p>\n          {dialogData.message && (\n            <DialogContentText>{dialogData.message}</DialogContentText>\n          )}\n        </p>\n        <Select\n          value={selection}\n          fullWidth\n          onChange={(event) => setSelection(event.target.value)}\n        >\n          {dialogData.options.map((option) => (\n            <MenuItem key={option} value={option}>\n              {option}\n            </MenuItem>\n          ))}\n        </Select>\n\n        {dialogData.checkbox && (\n          <FormGroup>\n            <FormControlLabel\n              control={\n                <Checkbox\n                  value={isChecked}\n                  onChange={(event) => {\n                    setChecked(event.target.checked);\n                  }}\n                />\n              }\n              label={dialogData.checkbox.label}\n            />\n          </FormGroup>\n        )}\n      </DialogContent>\n\n      <DialogActions>\n        <Button onClick={() => onClosed()} color=\"primary\" variant={'text'}>\n          Cancel\n        </Button>\n        <Button\n          onClick={() => {\n            onDialogInteraction({\n              selectedButton: 'Confirm',\n              selectedOption: selection,\n              checkboxes: {\n                [dialogData.checkbox.label]: isChecked,\n              },\n            });\n          }}\n          color=\"primary\"\n          variant={'contained'}\n        >\n          Confirm\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n\nconst LinearProgressWithLabel = (\n  props: LinearProgressProps & { value: number },\n) => (\n  <Box\n    display=\"flex\"\n    alignItems=\"center\"\n    paddingTop={'16px'}\n    paddingBottom={'16px'}\n    paddingLeft={'8px'}\n    paddingRight={'8px'}\n  >\n    <Box width=\"100%\" mr={1}>\n      <LinearProgress variant=\"determinate\" {...props} />\n    </Box>\n    <Box minWidth={35}>\n      <Typography variant=\"body2\" color=\"textSecondary\">{`${Math.round(\n        props.value,\n      )}%`}</Typography>\n    </Box>\n  </Box>\n);\n","import {\n  ColorScheme as LyricistantTheme,\n  ColorScheme,\n  DefaultFileType,\n  DetailPaneVisibility,\n  Font,\n  RhymeSource,\n} from '@lyricistant/common/preferences/PreferencesData';\nimport { useChannelData } from '@lyricistant/renderer/platform/useChannel';\nimport {\n  Close as CloseIcon,\n  Info,\n  Save as SaveIcon,\n} from '@mui/icons-material';\nimport {\n  AppBar,\n  Box,\n  Button,\n  Container,\n  Dialog,\n  Divider,\n  FormControl,\n  IconButton,\n  InputLabel,\n  MenuItem,\n  Paper,\n  Select,\n  Slide,\n  SlideProps,\n  Toolbar,\n  Typography,\n} from '@mui/material';\nimport React, { useEffect, useState } from 'react';\n\nconst DialogTransition = React.forwardRef<unknown, SlideProps>(\n  function Transition(props, ref) {\n    return <Slide direction=\"up\" ref={ref} {...props} />;\n  },\n);\n\nconst Header = ({ label }: { label: string }) => (\n  <div>\n    <Typography sx={{ fontWeight: 'bolder' }} variant={'h6'}>\n      {label}\n    </Typography>\n    <Divider sx={{ marginTop: '2px' }} />\n  </div>\n);\n\ninterface LabeledValue<T> {\n  label: string;\n  value: T;\n}\n\ninterface SelectBoxProps<T> {\n  value: T;\n  onChange: (value: T) => void;\n  items: Array<LabeledValue<T>>;\n  label: string;\n}\n\nconst SelectBox = <T extends string | number>({\n  value,\n  onChange,\n  items,\n  label,\n}: SelectBoxProps<T>) => (\n  <FormControl variant=\"outlined\" fullWidth>\n    <InputLabel sx={{ marginLeft: '16px', marginRight: '16px' }}>\n      {label}\n    </InputLabel>\n    <Select\n      sx={{ marginLeft: '16px', marginRight: '16px' }}\n      value={value}\n      onChange={(e) => onChange(e.target.value as T)}\n      label={label}\n    >\n      {items.map(({ label: itemLabel, value: itemValue }) => (\n        <MenuItem key={itemLabel} value={itemValue}>\n          {itemLabel}\n        </MenuItem>\n      ))}\n    </Select>\n  </FormControl>\n);\n\n/** The props needed to render {@link Preferences}. */\ninterface PreferencesProps {\n  /** Whether the preferences dialog should show or not. */\n  open: boolean;\n  /** Invoked when the user closes the preferences dialog. */\n  onClose: () => void;\n  /** Invoked when the users wants to go to the About screen. */\n  onAboutClicked: () => void;\n}\n\n/**\n * A dialog that allows users to view and edit their preferences. Also allows\n * them to link to the About screen.\n *\n * @param props The props needed to render this component.\n */\nexport const Preferences = (props: PreferencesProps) => {\n  const [originalPreferenceData] = useChannelData('prefs-updated', props.open);\n  const [preferencesData, setPreferencesData] = useState(\n    originalPreferenceData,\n  );\n\n  useEffect(() => {\n    setPreferencesData(originalPreferenceData);\n  }, [originalPreferenceData]);\n\n  const onDetailsSizeChanged = (textSize: number) => {\n    setPreferencesData({\n      ...preferencesData,\n      textSize,\n    });\n  };\n\n  const onColorSchemeChanged = (colorScheme: ColorScheme) => {\n    setPreferencesData({\n      ...preferencesData,\n      colorScheme,\n    });\n  };\n\n  const onRhymeSourceChanged = (rhymeSource: RhymeSource) => {\n    setPreferencesData({\n      ...preferencesData,\n      rhymeSource,\n    });\n  };\n\n  const onFontChanged = (font: Font) => {\n    setPreferencesData({\n      ...preferencesData,\n      font,\n    });\n  };\n\n  const onDefaultFileTypeChanged = (defaultFileType: DefaultFileType) => {\n    setPreferencesData({\n      ...preferencesData,\n      defaultFileType,\n    });\n  };\n\n  const onDetailPaneMinimizationChanged = (\n    detailPaneVisibility: DetailPaneVisibility,\n  ) => {\n    setPreferencesData({\n      ...preferencesData,\n      detailPaneVisibility,\n    });\n  };\n\n  const onPreferencesSaved = () => {\n    platformDelegate.send('save-prefs', preferencesData);\n    props.onClose();\n  };\n\n  if (!preferencesData) {\n    return <div />;\n  }\n\n  return (\n    <Dialog\n      fullScreen\n      sx={{\n        color: (theme) => theme.palette.primary.contrastText,\n      }}\n      open={props.open}\n      TransitionComponent={DialogTransition}\n      PaperProps={{\n        sx: { background: (theme) => theme.palette.background.default },\n      }}\n    >\n      <AppBar color={'primary'} position=\"sticky\" enableColorOnDark>\n        <Toolbar>\n          <IconButton\n            color={'inherit'}\n            edge=\"start\"\n            onClick={props.onClose}\n            size=\"large\"\n          >\n            <CloseIcon />\n          </IconButton>\n          <Typography\n            variant=\"h6\"\n            sx={{ marginLeft: (theme) => theme.spacing(2), flex: 1 }}\n          >\n            Preferences\n          </Typography>\n          <IconButton\n            color={'inherit'}\n            onClick={onPreferencesSaved}\n            size=\"large\"\n            aria-label={'Save'}\n          >\n            <SaveIcon />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <Container maxWidth={'md'} sx={{ height: '100%' }}>\n        <Paper\n          sx={{\n            paddingTop: '32px',\n            paddingBottom: '32px',\n            paddingLeft: '32px',\n            paddingRight: '32px',\n          }}\n        >\n          <Box display={'flex'} flexDirection={'column'} gap={'24px'}>\n            <Header label={'Display'} />\n\n            <SelectBox\n              value={preferencesData.font}\n              onChange={onFontChanged}\n              items={[\n                { value: Font.Roboto_Mono, label: 'Roboto monospace' },\n                { value: Font.Roboto, label: 'Roboto' },\n              ]}\n              label={'Font'}\n            />\n\n            <SelectBox\n              value={preferencesData.textSize}\n              onChange={onDetailsSizeChanged}\n              items={[\n                { value: 8, label: '8' },\n                { value: 12, label: '12' },\n                { value: 16, label: '16 (Default)' },\n                { value: 20, label: '20' },\n                { value: 24, label: '24' },\n                { value: 28, label: '28' },\n              ]}\n              label={'Text size'}\n            />\n\n            <SelectBox\n              value={preferencesData.colorScheme}\n              onChange={onColorSchemeChanged}\n              items={[\n                { value: LyricistantTheme.Light, label: 'Light' },\n                { value: LyricistantTheme.Dark, label: 'Dark' },\n                {\n                  value: LyricistantTheme.System,\n                  label: 'Use device color scheme',\n                },\n              ]}\n              label={'Color scheme'}\n            />\n\n            <SelectBox\n              value={preferencesData.detailPaneVisibility}\n              onChange={onDetailPaneMinimizationChanged}\n              items={[\n                {\n                  value: DetailPaneVisibility.Toggleable,\n                  label: 'Show toggle button',\n                },\n                {\n                  value: DetailPaneVisibility.Always_Show,\n                  label: 'Always show',\n                },\n              ]}\n              label={'Detail pane visibility'}\n            />\n\n            <Header label={'Other'} />\n\n            <SelectBox\n              value={preferencesData.rhymeSource}\n              onChange={onRhymeSourceChanged}\n              items={[\n                { value: RhymeSource.Offline, label: 'Offline (alpha)' },\n                { value: RhymeSource.Datamuse, label: 'Datamuse' },\n              ]}\n              label={'Rhyme source'}\n            />\n\n            <SelectBox\n              value={preferencesData.defaultFileType}\n              onChange={onDefaultFileTypeChanged}\n              items={[\n                {\n                  value: DefaultFileType.Always_Ask,\n                  label: 'Always ask',\n                },\n                {\n                  value: DefaultFileType.Lyricistant_Lyrics,\n                  label: 'Lyricistant file (.lyrics)',\n                },\n                {\n                  value: DefaultFileType.Plain_Text,\n                  label: 'Plain text (.txt)',\n                },\n              ]}\n              label={'Default file type'}\n            />\n            <Button\n              variant={'text'}\n              startIcon={<Info />}\n              size={'large'}\n              onClick={props.onAboutClicked}\n              sx={{ flexGrow: 1 }}\n            >\n              About Lyricistant\n            </Button>\n          </Box>\n        </Paper>\n      </Container>\n    </Dialog>\n  );\n};\n","import {\n  Dialog,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n} from '@mui/material';\nimport React from 'react';\n\ninterface PrivacyPolicyProps {\n  onClose: () => void;\n  open: boolean;\n}\n\nexport const PrivacyPolicy = (props: PrivacyPolicyProps) => (\n  <Dialog onClose={props.onClose} open={props.open} className={'paper'}>\n    <DialogTitle>Privacy policy</DialogTitle>\n    <DialogContent>\n      <DialogContentText>\n        Lyricistant doesn't collect or store any data from you. Nothing. Nada.\n        Zilch. Zero.\n      </DialogContentText>\n    </DialogContent>\n  </Dialog>\n);\n","import { AboutDialog } from '@lyricistant/renderer/about/AboutDialog';\nimport {\n  RoutePaths,\n  useBackNavigation,\n  useNavigation,\n} from '@lyricistant/renderer/app/Navigation';\nimport { ChooseDownloadDialog } from '@lyricistant/renderer/download/ChooseDownloadDialog';\nimport { FileHistory } from '@lyricistant/renderer/filehistory/FileHistory';\nimport { PlatformDialogs } from '@lyricistant/renderer/platform/PlatformDialogs';\nimport { useChannel } from '@lyricistant/renderer/platform/useChannel';\nimport { Preferences } from '@lyricistant/renderer/preferences/Preferences';\nimport { PrivacyPolicy } from '@lyricistant/renderer/privacy/PrivacyPolicy';\nimport React, { ReactElement, useEffect } from 'react';\nimport { useLocation } from 'wouter';\n\ninterface ModalRouteProps {\n  path: RoutePaths;\n  render: (open: boolean) => ReactElement;\n}\n\nconst ModalRoute = ({ path, render }: ModalRouteProps) => {\n  const [location] = useLocation();\n  return <>{render(path.replace('/', '') === location)}</>;\n};\n\n/** Displays various models over Lyricistant based on the current router path. */\nexport function Modals() {\n  const navigate = useNavigation();\n  const goBack = useBackNavigation();\n\n  useEffect(() => {\n    logger.verbose('Navigation', location.pathname);\n  }, [location]);\n\n  useChannel('open-about', () => navigate('/about'), []);\n  useChannel('open-prefs', () => navigate('/preferences'), []);\n\n  return (\n    <>\n      <ModalRoute\n        path=\"/download\"\n        render={(open) => <ChooseDownloadDialog open={open} onClose={goBack} />}\n      />\n      <ModalRoute\n        path=\"/about\"\n        render={(open) => <AboutDialog open={open} onClose={goBack} />}\n      />\n      <ModalRoute\n        path=\"/privacypolicy\"\n        render={(open) => <PrivacyPolicy open={open} onClose={goBack} />}\n      />\n      <ModalRoute\n        path=\"/file-history\"\n        render={(open) => <FileHistory open={open} onClose={goBack} />}\n      />\n      <ModalRoute\n        path=\"/preferences\"\n        render={(open) => (\n          <Preferences\n            open={open}\n            onClose={goBack}\n            onAboutClicked={() => navigate('/about', { replace: true })}\n          />\n        )}\n      />\n      <PlatformDialogs />\n    </>\n  );\n}\n","import { Chip } from '@mui/material';\nimport React from 'react';\n\n/** The props needed to render {@link WordChip} */\ninterface WordChipProps {\n  /** The word to display. */\n  word: string;\n  /** Invoked when this button is clicked. */\n  onClick: () => void;\n}\n\n/**\n * A \"chip\" that displays a word that can be clicked.\n *\n * @param props The props needed to render {@link WordChip}\n */\nexport const WordChip = ({ word, onClick }: WordChipProps) => (\n  <Chip style={{ flex: '1 1 auto' }} onClick={onClick} label={word} />\n);\n","import { ReactComponent as Logo } from '@lyricistant/renderer/lyricistant_logo.svg';\nimport { Box, Typography, useTheme } from '@mui/material';\nimport React from 'react';\n\n/**\n * Displays a \"null state text\" showing a message that should be displayed when\n * loading has failed or otherwise couldn't start.\n *\n * Displays the text and the icon of Lyricistant.\n *\n * @param text The text to display.\n * @param visible Whether this should be displayed. Useful for performance\n *   optimization; if this is meant to be displayed as a replacement for a list\n *   that could be expensive to render, having this always be rendered but\n *   hidden can help prevent re-renders.\n */\nexport const NullStateText = ({\n  text,\n  visible,\n}: {\n  text: string;\n  visible: boolean;\n}) => {\n  const theme = useTheme();\n\n  return (\n    <Box\n      height={'100%'}\n      width={'100%'}\n      overflow={'hidden'}\n      textOverflow={'ellipsis'}\n      fontStyle={'italic'}\n      p={'16px'}\n      display={visible === true ? 'flex' : 'none'}\n      flexWrap={'wrap-reverse'}\n      gap={'12px'}\n      alignItems={'center'}\n      justifyContent={'center'}\n      flexDirection={'column'}\n    >\n      <Logo height={'96px'} width={'96px'} fill={theme.palette.text.disabled} />\n      <Typography\n        sx={{\n          color: theme.palette.text.disabled,\n        }}\n        variant={'body1'}\n      >\n        {text}\n      </Typography>\n    </Box>\n  );\n};\n","import { Text } from '@codemirror/state';\nimport { isUnderTest } from '@lyricistant/common/BuildModes';\nimport { retext } from 'retext';\nimport retextIndefiniteArticle from 'retext-indefinite-article';\nimport retextRepeatedWords from 'retext-repeated-words';\nimport retextSpell, { Dictionary } from 'retext-spell';\nimport { VFile, DictionaryOnLoad } from 'retext-spell/lib';\nimport { VFileMessage } from 'vfile-message';\nimport { assign, createMachine, EventObject, fromPromise } from 'xstate';\n\nexport interface Diagnostic {\n  from: number;\n  to: number;\n  severity: 'info' | 'warning' | 'error';\n  message: string;\n  proposals?: string[];\n}\n\nconst backticksToQuotes = (value: string): string => value.replace(/`/g, '\"');\n\nconst toDisplayMessage = (report: VFileMessage): string => {\n  if (report.source === 'retext-spell') {\n    return `\"${report.actual}\" is misspelled`;\n  }\n  return backticksToQuotes(report.message);\n};\nconst toDiagnostics = (file: VFile, text: Text): Diagnostic[] =>\n  file.messages\n    .map((report): Diagnostic => {\n      const line = text.line(report.line);\n      const from = line.from + report.column - 1;\n      const to =\n        'end' in report.place ? line.from + report.place.end.column - 1 : from;\n\n      return {\n        from,\n        to,\n        severity: report.fatal ? 'error' : 'warning',\n        message: toDisplayMessage(report),\n        proposals: report.expected,\n      };\n    })\n    .sort((left, right) => left.from - right.from);\n\nconst loadDictionaryAsync: () => Promise<Dictionary> = async () => ({\n  dic: (await import('dictionary-en/index.dic')).default,\n  aff: (await import('dictionary-en/index.aff')).default,\n});\nconst loadDictionary = (callback: DictionaryOnLoad) =>\n  loadDictionaryAsync()\n    .then((result) => callback(null, result))\n    .catch((e) => callback(e));\n\nconst retextDiagnostics = async (text: Text | null): Promise<Diagnostic[]> => {\n  if (!text || text.length === 0) {\n    return [];\n  }\n\n  const result = await retext()\n    .use(retextSpell, loadDictionary)\n    .use(retextRepeatedWords)\n    .use(retextIndefiniteArticle)\n    .process(text.toString());\n\n  return toDiagnostics(result, text);\n};\n\nconst createDiagnostics = async (text: Text | null): Promise<Diagnostic[]> =>\n  retextDiagnostics(text);\n\ninterface DiagnosticsContext {\n  input?: Text;\n  result?: Diagnostic[];\n  error?: unknown;\n}\n\ninterface DiagnosticsEvent extends EventObject {\n  type: 'INPUT';\n  input: Text;\n}\n\nexport const diagnosticsMachine = createMachine(\n  {\n    types: {} as {\n      context: DiagnosticsContext;\n      events: DiagnosticsEvent;\n    },\n    id: 'diagnostics',\n    initial: 'waiting',\n    context: {\n      result: [],\n    },\n    on: {\n      INPUT: [\n        {\n          target: '.loading',\n          guard: 'isValidInput',\n          actions: [\n            assign({ input: ({ event }) => event.input }),\n            assign({ result: [] }),\n          ],\n        },\n      ],\n    },\n    states: {\n      waiting: {\n        id: 'waiting',\n      },\n      loading: {\n        initial: 'debouncing',\n        states: {\n          debouncing: {\n            on: {\n              INPUT: [\n                {\n                  target: 'debouncing',\n                  guard: 'isValidInput',\n                  actions: [\n                    assign({ input: ({ event }) => event.input }),\n                    assign({ result: [] }),\n                  ],\n                },\n                { target: '#diagnostics.waiting' },\n              ],\n            },\n            after: {\n              DEBOUNCE: {\n                target: 'active',\n              },\n            },\n          },\n          active: {\n            invoke: {\n              input: ({ context }) => context.input,\n              src: fromPromise<Diagnostic[], Text>(async ({ input }) =>\n                createDiagnostics(input),\n              ),\n              onDone: [\n                {\n                  target: '#displaying',\n                  guard: ({ event }) =>\n                    Array.isArray(event.output) && event.output.length > 0,\n                  actions: assign({\n                    result: ({ event }) => event.output,\n                  }),\n                },\n                {\n                  target: '#no-results',\n                  actions: assign({\n                    result: ({ event }) => event.output ?? [],\n                  }),\n                },\n              ],\n              onError: {\n                target: '#no-results',\n                actions: [\n                  assign({\n                    error: ({ event }) => event.error,\n                    result: [],\n                  }),\n                  ({ context }) =>\n                    logger.warn(\n                      `Failed to load diagnostics for text`,\n                      context.error,\n                    ),\n                ],\n              },\n            },\n          },\n        },\n      },\n      displaying: {\n        id: 'displaying',\n      },\n      'no-results': {\n        id: 'no-results',\n      },\n    },\n  },\n  {\n    delays: {\n      DEBOUNCE: () => (isUnderTest ? 100 : 1_000),\n    },\n    guards: {\n      isValidInput: ({ context, event }) => context.input !== event.input,\n    },\n  },\n);\n","import { Text } from '@codemirror/state';\nimport { DetailPaneChildProps } from '@lyricistant/renderer/detail/DetailPane';\nimport { NullStateText } from '@lyricistant/renderer/detail/NullStateText';\nimport {\n  Diagnostic,\n  diagnosticsMachine,\n} from '@lyricistant/renderer/diagnostics/DiagnosticsMachine';\nimport { Markdown } from '@lyricistant/renderer/markdown/Markdown';\nimport { ChevronRight } from '@mui/icons-material';\nimport {\n  Box,\n  IconButton,\n  List,\n  ListItem,\n  ListItemButton,\n  ListItemSecondaryAction,\n  ListItemText,\n  Paper,\n  Popover,\n  useTheme,\n} from '@mui/material';\nimport { useMachine } from '@xstate/react';\nimport React, { useEffect } from 'react';\n\nexport interface DiagnosticsPanelProps extends DetailPaneChildProps {\n  text: Text;\n  onDiagnosticsLoaded: (diagnostics: Diagnostic[]) => void;\n  onDiagnosticClicked: (value: Diagnostic) => void;\n  onProposalAccepted: (proposal: string, diagnostic: Diagnostic) => void;\n}\n\nexport const Diagnostics = (props: DiagnosticsPanelProps) => {\n  const [state, send] = useMachine(diagnosticsMachine);\n\n  useEffect(() => {\n    if (props.isVisible) {\n      send({ type: 'INPUT', input: props.text });\n    }\n  }, [props.text, props.isVisible]);\n\n  useEffect(() => {\n    props.onLoadingChanged?.(state.matches('loading'));\n  }, [state.matches('loading')]);\n\n  const diagnostics: Diagnostic[] = state.context.result;\n\n  useEffect(() => {\n    props.onDiagnosticsLoaded(props.isVisible ? diagnostics : []);\n  }, [props.isVisible, diagnostics]);\n\n  return (\n    <Box\n      display={'flex'}\n      flexDirection={'column'}\n      gap={diagnostics.length > 0 ? '8px' : '0px'}\n      height={'100%'}\n      width={'100%'}\n    >\n      <NullStateText\n        visible={state.matches('waiting')}\n        text={'Waiting for lyrics'}\n      />\n\n      <NullStateText\n        visible={state.matches('no-results')}\n        text={'No issues found'}\n      />\n\n      {diagnostics.length > 0 && (\n        <DiagnosticsList\n          diagnostics={diagnostics}\n          onDiagnosticClicked={props.onDiagnosticClicked}\n          onProposalAccepted={props.onProposalAccepted}\n        />\n      )}\n    </Box>\n  );\n};\n\nconst DiagnosticsList = (props: {\n  diagnostics: Diagnostic[];\n  onDiagnosticClicked: (diagnostic: Diagnostic) => void;\n  onProposalAccepted: (proposal: string, diagnostic: Diagnostic) => void;\n}) => (\n  <List>\n    {props.diagnostics.map((diagnostic) => (\n      <DiagnosticRow\n        key={JSON.stringify(diagnostic)}\n        diagnostic={diagnostic}\n        onClick={() => props.onDiagnosticClicked(diagnostic)}\n        onProposalClicked={(proposal) =>\n          props.onProposalAccepted(proposal, diagnostic)\n        }\n      />\n    ))}\n  </List>\n);\n\nconst DiagnosticRow = (props: {\n  diagnostic: Diagnostic;\n  onClick: () => void;\n  onProposalClicked: (proposal: string) => void;\n}) => {\n  const theme = useTheme();\n  return (\n    <ListItem disablePadding onClick={props.onClick}>\n      <ListItemButton\n        divider\n        sx={{\n          ':hover': {\n            backgroundColor: theme.palette.background.paper,\n          },\n        }}\n      >\n        <ListItemText\n          sx={{\n            paddingRight: '8px',\n          }}\n          primary={<Markdown text={props.diagnostic.message} />}\n        />\n        <ListItemSecondaryAction>\n          <IconButton onClick={props.onClick}>\n            <ChevronRight />\n          </IconButton>\n        </ListItemSecondaryAction>\n      </ListItemButton>\n    </ListItem>\n  );\n};\n\ninterface DiagnosticActionPopoverProps {\n  diagnostic?: Diagnostic;\n  domRect?: DOMRect;\n  onClose: () => void;\n  onProposalAccepted: (proposal: string, diagnostic: Diagnostic) => void;\n}\n\nexport const DiagnosticActionPopover = (\n  props: DiagnosticActionPopoverProps,\n) => (\n  <Popover\n    open={props.diagnostic?.proposals?.length > 0}\n    onClose={props.onClose}\n    anchorEl={\n      props.domRect && {\n        getBoundingClientRect: () => props.domRect,\n        nodeType: 1,\n      }\n    }\n    anchorOrigin={{\n      vertical: 'center',\n      horizontal: 'center',\n    }}\n  >\n    <Paper>\n      <DiagnosticActionPopoverContent\n        diagnostic={props.diagnostic}\n        onProposalAccepted={props.onProposalAccepted}\n      />\n    </Paper>\n  </Popover>\n);\n\ninterface DiagnosticActionPopoverContentProps {\n  diagnostic: Diagnostic;\n  onProposalAccepted: (proposal: string, diagnostic: Diagnostic) => void;\n}\n\nconst DiagnosticActionPopoverContent = (\n  props: DiagnosticActionPopoverContentProps,\n) => (\n  <List dense>\n    {(props.diagnostic?.proposals?.slice(0, 6) ?? []).map((proposal) => (\n      <ListItem\n        disablePadding\n        dense\n        onClick={() => {\n          props.onProposalAccepted(proposal, props.diagnostic);\n        }}\n      >\n        <ListItemButton dense>\n          <ListItemText>{proposal}</ListItemText>\n        </ListItemButton>\n      </ListItem>\n    ))}\n  </List>\n);\n","import { isUnderTest } from '@lyricistant/common/BuildModes';\nimport axios from 'axios';\nimport { flattenDeep, uniq } from 'lodash-es';\nimport { assign, EventObject, fromPromise, setup } from 'xstate';\n\nexport interface DefinitionsResponse {\n  meanings: Meaning[];\n}\n\nexport interface Meaning {\n  partOfSpeech: string;\n  definitions: Definition[];\n  synonyms: string[];\n  antonyms: string[];\n}\n\nexport interface Definition {\n  definition: string;\n  example: string;\n  synonyms: string[];\n  antonyms: string[];\n}\ninterface DictionaryContext {\n  input?: string;\n  inputForResult?: string;\n  result?: Meaning[];\n  error?: unknown;\n}\n\ninterface DictionaryEvent extends EventObject {\n  type: 'INPUT';\n  input: string;\n}\n\nconst fetchDefinition = async (input: string): Promise<Meaning[]> => {\n  logger.verbose(`Fetching definition for \"${input}`);\n  return axios\n    .get<DefinitionsResponse[]>(input, {\n      baseURL: 'https://api.dictionaryapi.dev/api/v2/entries/en/',\n    })\n    .then((response) => response.data[0].meanings);\n};\n\n/**\n * Giving a list of meanings, normalize the synonyms and antonyms so they appear\n * as separate words.\n *\n * Sometimes, the API will return related words in a single string like \"hello,\n * world\" instead of a string array like [\"hello\", \"world\"]. This fixes that.\n *\n * @param meanings The meanings potentially contained related words that need to\n *   be normalized.\n */\nconst normalize = (meanings: Meaning[]): Meaning[] =>\n  meanings.map((meaning) => ({\n    ...meaning,\n    definitions: meaning.definitions.map((definition) => ({\n      ...definition,\n      synonyms: uniq(\n        flattenDeep(\n          definition.synonyms.map((synonym) =>\n            synonym.split(',').map((value) => value.trim()),\n          ),\n        ),\n      ),\n      antonyms: uniq(\n        flattenDeep(\n          definition.antonyms.map((antonym) =>\n            antonym.split(',').map((value) => value.trim()),\n          ),\n        ),\n      ),\n    })),\n  }));\n\nconst fetchDefinitionActor = fromPromise<Meaning[], string>(async ({ input }) =>\n  fetchDefinition(input),\n);\nexport const dictionaryMachine = setup({\n  types: {\n    context: {} as DictionaryContext,\n    events: {} as DictionaryEvent,\n  },\n  actors: {\n    fetchDefinitionActor,\n  },\n  delays: {\n    DEBOUNCE: () => (isUnderTest ? 100 : 1_000),\n  },\n  guards: {\n    isValidInput: ({ context, event }) =>\n      event.input &&\n      event.input.trim().length > 0 &&\n      !!event.input.match(/\\w+/) &&\n      event.input !== context.input,\n  },\n}).createMachine({\n  id: 'dictionary',\n  initial: 'waiting',\n  context: {\n    result: [],\n  },\n  on: {\n    INPUT: [\n      {\n        target: '.loading',\n        guard: 'isValidInput',\n        actions: assign({\n          input: ({ event }) => event.input,\n        }),\n      },\n    ],\n  },\n  states: {\n    waiting: {\n      id: 'waiting',\n    },\n    loading: {\n      initial: 'debouncing',\n      states: {\n        debouncing: {\n          on: {\n            INPUT: [\n              {\n                target: 'debouncing',\n                guard: 'isValidInput',\n                actions: assign({\n                  input: ({ event }) => event.input,\n                }),\n              },\n              { target: '#dictionary.waiting' },\n            ],\n          },\n          after: {\n            DEBOUNCE: {\n              target: 'active',\n            },\n          },\n        },\n        active: {\n          invoke: {\n            src: 'fetchDefinitionActor',\n            input: ({ context }) => context.input,\n            onDone: [\n              {\n                target: '#displaying',\n                guard: ({ event }) =>\n                  Array.isArray(event.output) && event.output.length > 0,\n                actions: assign({\n                  inputForResult: ({ context }) => context.input,\n                  result: ({ event }) => normalize(event.output),\n                }),\n              },\n              {\n                target: '#no-results',\n                actions: assign({\n                  result: ({ event }) => event.output ?? [],\n                }),\n              },\n            ],\n            onError: {\n              target: '#no-results',\n              actions: [\n                assign({\n                  error: ({ event }) => event.error,\n                  result: [],\n                }),\n                ({ context }) =>\n                  logger.warn(`Failed to load definition for ${context.input}`),\n              ],\n            },\n          },\n        },\n      },\n    },\n    displaying: {\n      id: 'displaying',\n    },\n    'no-results': {\n      id: 'no-results',\n    },\n  },\n});\n","import { DetailPaneChildProps } from '@lyricistant/renderer/detail/DetailPane';\nimport { NullStateText } from '@lyricistant/renderer/detail/NullStateText';\nimport { WordChip } from '@lyricistant/renderer/detail/WordChip';\nimport {\n  Definition,\n  dictionaryMachine,\n  Meaning,\n} from '@lyricistant/renderer/dictionary/DictionaryMachine';\nimport { Box, Divider, Typography } from '@mui/material';\nimport { useMachine } from '@xstate/react';\nimport React, { useEffect, useMemo } from 'react';\n\nexport interface DictionaryProps extends DetailPaneChildProps {\n  query?: string;\n  onRelatedTextClicked: (text: string) => void;\n}\nexport const Dictionary = ({\n  query,\n  onRelatedTextClicked,\n  isVisible,\n  onLoadingChanged,\n}: DictionaryProps) => {\n  const [state, send] = useMachine(dictionaryMachine);\n\n  useEffect(() => {\n    if (isVisible && query) {\n      send({ type: 'INPUT', input: query });\n    }\n  }, [query, isVisible]);\n\n  useEffect(() => {\n    onLoadingChanged?.(state.matches('loading'));\n  }, [state.matches('loading')]);\n\n  const meanings: Meaning[] = state.context.result;\n\n  return (\n    <Box\n      display={'flex'}\n      flexDirection={'column'}\n      gap={'8px'}\n      height={'100%'}\n      width={'100%'}\n    >\n      <NullStateText\n        visible={state.matches('waiting')}\n        text={'Waiting for lyrics'}\n      />\n\n      <NullStateText\n        visible={state.matches('no-results')}\n        text={'No definition found'}\n      />\n\n      {meanings.length > 0 && (\n        <MeaningList\n          query={state.context.inputForResult}\n          meanings={meanings}\n          onRelatedTextClicked={onRelatedTextClicked}\n        />\n      )}\n    </Box>\n  );\n};\n\nconst MeaningList = React.memo(\n  (props: {\n    query: string;\n    meanings: Meaning[];\n    onRelatedTextClicked: (word: string) => void;\n  }) => (\n    <Box sx={{ overflow: 'auto', paddingLeft: '16px', paddingRight: '16px' }}>\n      <Typography variant={'h5'}>{props.query}</Typography>\n      <Box sx={{ display: 'flex', flexDirection: 'column', gap: '16px' }}>\n        {props.meanings.map((meaning, index) => (\n          <React.Fragment key={JSON.stringify(meaning)}>\n            <VisualMeaning\n              meaning={meaning}\n              onRelatedTextClicked={props.onRelatedTextClicked}\n            />\n            {(meaning.synonyms?.length > 0 || meaning.antonyms?.length > 0) && (\n              <Divider variant={'middle'}>\n                <Typography variant={'caption'}>Related</Typography>\n              </Divider>\n            )}\n            <RelatedTextLists\n              disablePadding\n              synonyms={meaning.synonyms}\n              antonyms={meaning.antonyms}\n              onRelatedTextClicked={props.onRelatedTextClicked}\n            />\n            {index < props.meanings.length - 1 && (\n              <Divider variant={'fullWidth'} />\n            )}\n          </React.Fragment>\n        ))}\n      </Box>\n    </Box>\n  ),\n);\n\nconst VisualMeaning = (props: {\n  meaning: Meaning;\n  onRelatedTextClicked: (word: string) => void;\n}) => (\n  <Box display={'flex'} flexDirection={'column'} gap={'8px'}>\n    <Typography variant={'subtitle1'} sx={{ fontWeight: 'bold' }}>\n      {props.meaning.partOfSpeech}\n    </Typography>\n    {props.meaning.definitions.map((definition, index) => (\n      <VisualDefinition\n        showHeader={props.meaning.definitions.length > 1}\n        key={index}\n        index={index + 1}\n        definition={definition}\n        onRelatedTextClicked={props.onRelatedTextClicked}\n      />\n    ))}\n  </Box>\n);\n\nconst VisualDefinition = ({\n  index,\n  definition,\n  showHeader,\n  onRelatedTextClicked,\n}: {\n  index: number;\n  showHeader: boolean;\n  definition: Definition;\n  onRelatedTextClicked: (word: string) => void;\n}) => (\n  <Box>\n    {showHeader && (\n      <Divider\n        variant={'middle'}\n        sx={{\n          paddingTop: '4px',\n          paddingBottom: '4px',\n        }}\n      >\n        <Typography variant={'caption'}>{index}</Typography>\n      </Divider>\n    )}\n    <Typography>{definition.definition}</Typography>\n    {definition.example?.trim()?.length > 0 && (\n      <Typography variant={'body2'} sx={{ fontStyle: 'italic' }}>\n        {definition.example}\n      </Typography>\n    )}\n    <RelatedTextLists\n      synonyms={definition.synonyms}\n      antonyms={definition.antonyms}\n      onRelatedTextClicked={onRelatedTextClicked}\n    />\n  </Box>\n);\n\nconst RelatedTextLists = (props: {\n  disablePadding?: boolean;\n  synonyms: string[];\n  antonyms: string[];\n  onRelatedTextClicked: (word: string) => void;\n}) => {\n  const shouldHide = useMemo(\n    () => !(props.antonyms?.length > 0 || props.synonyms?.length > 0),\n    [props.synonyms, props.antonyms],\n  );\n  const synonyms = useMemo(\n    () => [...new Set(props.synonyms)],\n    [props.synonyms],\n  );\n  const antonyms = useMemo(\n    () => [...new Set(props.antonyms)],\n    [props.antonyms],\n  );\n  const hasSynonyms = synonyms.length > 0;\n  const hasAntonyms = antonyms.length > 0;\n  return (\n    <Box\n      sx={{\n        padding: props.disablePadding ? undefined : '4px',\n        display: shouldHide ? 'none' : undefined,\n      }}\n    >\n      {hasSynonyms && (\n        <RelatedText\n          label={hasAntonyms ? 'Synonyms' : null}\n          words={synonyms}\n          onRelatedTextClicked={props.onRelatedTextClicked}\n        />\n      )}\n      {hasSynonyms && hasAntonyms && <Box height={'8px'} />}\n      {hasAntonyms && (\n        <RelatedText\n          label={'Antonyms'}\n          words={antonyms}\n          onRelatedTextClicked={props.onRelatedTextClicked}\n        />\n      )}\n    </Box>\n  );\n};\n\nconst RelatedText = (props: {\n  label?: string;\n  words: string[];\n  onRelatedTextClicked: (word: string) => void;\n}) => (\n  <>\n    {props.label && (\n      <Typography\n        variant={'subtitle2'}\n        sx={{ paddingBottom: '4px', fontSize: 'italic' }}\n      >\n        {props.label}\n      </Typography>\n    )}\n    <Box display={'flex'} flexWrap={'wrap'} flexDirection={'row'} gap={'4px'}>\n      {props.words.map((word) => (\n        <WordChip\n          key={word}\n          word={word}\n          onClick={() => props.onRelatedTextClicked(word)}\n        />\n      ))}\n    </Box>\n  </>\n);\n","import { DetailPaneChildProps } from '@lyricistant/renderer/detail/DetailPane';\nimport { NullStateText } from '@lyricistant/renderer/detail/NullStateText';\nimport { WordChip } from '@lyricistant/renderer/detail/WordChip';\nimport { RhymesState } from '@lyricistant/renderer/rhymes/RhymesMachine';\nimport { Box, Chip } from '@mui/material';\nimport React, { useCallback, useEffect } from 'react';\nimport { useErrorBoundary } from 'react-error-boundary';\nimport { Rhyme } from './rhyme';\n\ninterface RhymesListProps {\n  rhymes: Rhyme[];\n  onRhymeClicked: (rhyme: Rhyme) => void;\n}\n\nconst RhymesListItem = ({\n  rhyme,\n  onRhymeClicked,\n}: {\n  rhyme: Rhyme;\n  onRhymeClicked: (rhyme: Rhyme) => void;\n}) => {\n  const onClick = useCallback(() => {\n    onRhymeClicked(rhyme);\n  }, [rhyme, onRhymeClicked]);\n  return <WordChip word={rhyme.word} key={rhyme.word} onClick={onClick} />;\n};\nconst RhymesList = React.memo(({ rhymes, onRhymeClicked }: RhymesListProps) => (\n  <Box\n    display={rhymes.length > 0 ? 'flex' : 'none'}\n    flexWrap={'wrap'}\n    gap={'4px'}\n    alignContent={'start'}\n    flexDirection={'row'}\n    paddingLeft={'16px'}\n    paddingRight={'16px'}\n  >\n    {rhymes.map((rhyme) => (\n      <RhymesListItem\n        rhyme={rhyme}\n        key={rhyme.word}\n        onRhymeClicked={onRhymeClicked}\n      />\n    ))}\n  </Box>\n));\n\n/** The props needed to render the {@link Rhymes} component. */\nexport interface RhymesProps extends DetailPaneChildProps {\n  state: RhymesState;\n  isSurpriseButtonEnabled: boolean;\n  /**\n   * Invoked when a rhyme is clicked.\n   *\n   * @param rhyme The rhyme that was clicked.\n   */\n  onRhymeClicked: (rhyme: Rhyme) => void;\n  onSurpriseMeClicked: () => void;\n}\n\n/**\n * Given a query, fetches and renders a list of rhymes that can be clicked by a user.\n *\n * @param props The props needed to render this component.\n */\nexport const Rhymes: React.FC<RhymesProps> = (props) => {\n  const state = props.state;\n\n  const { showBoundary: handleError } = useErrorBoundary();\n\n  useEffect(() => {\n    if (state.matches('error')) {\n      handleError(state.context.error);\n    }\n  }, [handleError, state]);\n\n  useEffect(() => {\n    props.onLoadingChanged?.(state.matches('loading'));\n  }, [state.matches('loading')]);\n\n  const rhymes: Rhyme[] = state.context.rhymes;\n\n  return (\n    <Box\n      display={'flex'}\n      flexDirection={'column'}\n      gap={'8px'}\n      height={'100%'}\n      width={'100%'}\n    >\n      <NullStateText\n        visible={state.matches('inactive')}\n        text={'Waiting for lyrics'}\n      />\n\n      <NullStateText\n        visible={state.matches('no-results')}\n        text={'No rhymes found'}\n      />\n\n      <RhymesList rhymes={rhymes} onRhymeClicked={props.onRhymeClicked} />\n      {props.isSurpriseButtonEnabled && (\n        <>\n          <Box flex={'1 1 auto'} />\n          <Box\n            paddingLeft={'32px'}\n            paddingRight={'32px'}\n            width={'100%'}\n            display={'flex'}\n          >\n            <Chip\n              sx={{ flex: '1 1 auto' }}\n              label={'Surprise me'}\n              onClick={props.onSurpriseMeClicked}\n              variant={'outlined'}\n              color={'primary'}\n            />\n          </Box>\n        </>\n      )}\n    </Box>\n  );\n};\n","export class Rhyme {\n  public word: string;\n  public score: number;\n\n  public constructor(word: string, score: number) {\n    this.word = word;\n    this.score = score;\n  }\n}\n","import { Rhyme } from './rhyme';\n\nconst url = 'https://lyricistant.wardellbagby.workers.dev';\ntype RhymeType = 'perfect' | 'near' | 'sounds-like';\n\nconst getMaxRhymeCount = (type: RhymeType) => {\n  if (type === 'perfect') {\n    return 50;\n  } else {\n    return 25;\n  }\n};\nconst asyncRhymes = async (word: string, type: RhymeType): Promise<Rhyme[]> => {\n  let param;\n  switch (type) {\n    case 'perfect':\n      param = 'rel_rhy';\n      break;\n    case 'near':\n      param = 'rel_nry';\n      break;\n    case 'sounds-like':\n      param = 'sl';\n      break;\n  }\n\n  logger.debug(`Fetching ${type} rhymes for word: ${word}`);\n  const response = await fetch(\n    `${url}/words?${param}=${word}&max=${getMaxRhymeCount(type)}`,\n  );\n\n  if (response.ok && response.status < 400) {\n    const text = await response.text();\n    logger.debug(`Response for ${type} and ${word}`, text);\n    try {\n      return JSON.parse(text);\n    } catch (e) {\n      logger.error(\"Couldn't parse rhymes response to JSON!\", word, text, e);\n      return [];\n    }\n  }\n  logger.error(\n    'Failed to fetch rhymes! Returning an empty list.',\n    word,\n    response,\n  );\n  return [];\n};\n\n/**\n * Fetch rhymes for the given word from the Datamuse rhymes API.\n *\n * @param word The word to find rhymes for.\n */\nexport const fetchRhymes = async (word: string): Promise<Rhyme[]> => {\n  if (word.length === 0) {\n    return [];\n  }\n\n  return Promise.all([\n    asyncRhymes(word, 'perfect').then((rhymes) => increaseScore(rhymes, 10000)),\n    asyncRhymes(word, 'near').then((rhymes) => increaseScore(rhymes, 1000)),\n    asyncRhymes(word, 'sounds-like'),\n  ]).then((results) =>\n    distinct(flatten(results), (rhyme) => rhyme.word).sort(\n      (left: Rhyme, right: Rhyme) => right.score - left.score,\n    ),\n  );\n};\n\nconst increaseScore = (rhymes: Rhyme[], amount: number) =>\n  rhymes.map((rhyme: Rhyme) => new Rhyme(rhyme.word, rhyme.score + amount));\n\nconst flatten: <T>(input: T[][]) => T[] = (array) =>\n  array.reduce((prev, current) => prev.concat(current));\n\nconst distinct: <T, R>(input: T[], by: (value: T) => R) => T[] = (\n  input,\n  by,\n) => {\n  const map = new Map();\n  const results = [];\n  for (const item of input) {\n    if (!map.has(by(item))) {\n      map.set(by(item), true);\n      results.push(item);\n    }\n  }\n  return results;\n};\n","import { isUnderTest } from '@lyricistant/common/BuildModes';\nimport { RhymeSource } from '@lyricistant/common/preferences/PreferencesData';\nimport { fetchRhymes as datamuseRhymes } from '@lyricistant/renderer/rhymes/datamuse';\nimport { Rhyme } from '@lyricistant/renderer/rhymes/rhyme';\nimport { assign, createMachine, EventObject, fromPromise } from 'xstate';\n\ntype generateRhymes =\n  (typeof import('@lyricistant/rhyme-generator'))['rhymeGenerator']['generateRhymes'];\n\nconst offlineRhymes = (...args: Parameters<generateRhymes>) =>\n  import('@lyricistant/rhyme-generator').then(({ rhymeGenerator }) =>\n    rhymeGenerator.generateRhymes(...args),\n  );\n\ninterface RhymesContext {\n  rhymeSource?: RhymeSource;\n  input?: string;\n  rhymes: Rhyme[];\n  error?: unknown;\n}\n\ninterface RhymesEvent extends EventObject {\n  type: 'INPUT';\n  input: string;\n  rhymeSource: RhymeSource;\n}\n\nexport type RhymesState = ReturnType<(typeof rhymesMachine)['resolveState']>;\n\nconst fetchRhymes = async (\n  input: string,\n  rhymeSource: RhymeSource,\n): Promise<Rhyme[]> => {\n  let results: Rhyme[];\n  switch (rhymeSource) {\n    case RhymeSource.Offline:\n      results = await offlineRhymes(input);\n      break;\n    case RhymeSource.Datamuse:\n      try {\n        results = await datamuseRhymes(input);\n      } catch (e) {\n        logger.warn(\n          'Failed to fetch Datamuse rhymes; falling back to offline',\n          e,\n        );\n        results = await offlineRhymes(input);\n      }\n      break;\n  }\n\n  return results.filter((rhyme) => rhyme && rhyme.word && rhyme.score);\n};\n\n/** A State Machine that handles fetching rhymes based on a query and returning a result. */\nexport const rhymesMachine = createMachine(\n  {\n    types: {} as {\n      context: RhymesContext;\n      event: RhymesEvent;\n    },\n    id: 'rhymes',\n    initial: 'inactive',\n    context: {\n      rhymes: [],\n    },\n    on: {\n      INPUT: [\n        {\n          target: '.loading',\n          guard: 'isValidInput',\n          actions: assign({\n            input: ({ event }) => event.input,\n            rhymeSource: ({ event }) => event.rhymeSource,\n          }),\n        },\n      ],\n    },\n    states: {\n      inactive: {\n        id: '#inactive',\n      },\n      loading: {\n        initial: 'debouncing',\n        states: {\n          debouncing: {\n            on: {\n              INPUT: [\n                {\n                  target: 'debouncing',\n                  guard: 'isValidInput',\n                  actions: assign({\n                    input: ({ event }) => event.input,\n                    rhymeSource: ({ event }) => event.rhymeSource,\n                  }),\n                },\n                { target: '#rhymes.inactive' },\n              ],\n            },\n            after: {\n              DEBOUNCE: { target: 'active' },\n            },\n          },\n          active: {\n            invoke: {\n              id: 'fetch-rhymes',\n              input: ({ context }) => context,\n              src: fromPromise<Rhyme[], RhymesContext>(\n                async ({ input: context }) =>\n                  fetchRhymes(context.input, context.rhymeSource),\n              ),\n              onDone: [\n                {\n                  target: '#displaying',\n                  guard: ({ event }) =>\n                    Array.isArray(event.output) && event.output.length > 0,\n                  actions: assign({\n                    rhymes: ({ event }) => event.output,\n                  }),\n                },\n                {\n                  target: '#no-results',\n                  actions: assign({\n                    rhymes: ({ event }) => event.output,\n                  }),\n                },\n              ],\n              onError: {\n                target: '#error',\n                actions: assign({\n                  error: ({ event }) => event.error,\n                }),\n              },\n            },\n          },\n        },\n      },\n      displaying: {\n        id: 'displaying',\n      },\n      'no-results': {\n        id: 'no-results',\n      },\n      error: {\n        id: 'error',\n      },\n    },\n  },\n  {\n    delays: {\n      DEBOUNCE: () => (isUnderTest ? 100 : 1_000),\n    },\n    guards: {\n      isValidInput: ({ context, event }) =>\n        context.input !== event.input ||\n        context.rhymeSource !== event.rhymeSource,\n    },\n  },\n);\n","import { DetailPaneVisibility } from '@lyricistant/common/preferences/PreferencesData';\nimport { useReadOnlyMode } from '@lyricistant/renderer/app/useReadOnlyMode';\nimport { useSmallLayout } from '@lyricistant/renderer/app/useSmallLayout';\nimport { WordChip } from '@lyricistant/renderer/detail/WordChip';\nimport {\n  Diagnostics,\n  DiagnosticsPanelProps,\n} from '@lyricistant/renderer/diagnostics/Diagnostics';\nimport {\n  Dictionary,\n  DictionaryProps,\n} from '@lyricistant/renderer/dictionary/Dictionary';\nimport {\n  useChannel,\n  useChannelData,\n} from '@lyricistant/renderer/platform/useChannel';\nimport { Rhyme } from '@lyricistant/renderer/rhymes/rhyme';\nimport { Rhymes, RhymesProps } from '@lyricistant/renderer/rhymes/Rhymes';\nimport {\n  rhymesMachine,\n  RhymesState,\n} from '@lyricistant/renderer/rhymes/RhymesMachine';\nimport { ChevronLeft, ChevronRight, Spellcheck } from '@mui/icons-material';\nimport {\n  Box,\n  Button,\n  Fab,\n  Fade,\n  LinearProgress,\n  Link,\n  Paper,\n  Slide,\n  Tab,\n  Tabs,\n} from '@mui/material';\nimport { useMachine } from '@xstate/react';\nimport {\n  BookAlphabet,\n  ChevronDown,\n  ChevronUp,\n  ScriptOutline,\n} from 'mdi-material-ui';\nimport React, {\n  PropsWithChildren,\n  ReactElement,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useState,\n} from 'react';\n\ninterface Button {\n  onClick: () => void;\n  icon: ReactElement;\n}\n\ninterface TabChangedData {\n  isQueryTab: boolean;\n}\n\ninterface DetailRhymesProps\n  extends Omit<Omit<RhymesProps, 'state'>, keyof DetailPaneChildProps> {\n  query?: string;\n}\n\ninterface DetailPaneProps {\n  buttons: Button[];\n  rhymeProps: DetailRhymesProps;\n  dictionaryProps: Omit<DictionaryProps, keyof DetailPaneChildProps>;\n  diagnosticsProps: Omit<DiagnosticsPanelProps, keyof DetailPaneChildProps>;\n  onTabChanged: (data: TabChangedData) => void;\n  onDisableReadonlyMode: () => void;\n}\n\nexport interface DetailPaneChildProps {\n  isVisible: boolean;\n  onLoadingChanged: (isLoading: boolean) => void;\n}\n\ntype TabbedItemProps = PropsWithChildren<{\n  index: number;\n  selectedIndex: number;\n}>;\nconst TabbedItem = ({ index, selectedIndex, children }: TabbedItemProps) => (\n  <Box\n    sx={{\n      display: index === selectedIndex ? 'flex' : 'none',\n      flexDirection: 'column',\n      flex: '1 1 auto',\n      overflow: 'auto',\n    }}\n  >\n    <Box flex={'0 0 8px'} />\n    <Box flex={'1 1 auto'}>{children}</Box>\n    <Box flex={'0 0 8px'} />\n  </Box>\n);\n\nconst ToggleDetailPaneIcon = ({ isExpanded }: { isExpanded: boolean }) => {\n  const isSmallLayout = useSmallLayout();\n  if (isSmallLayout) {\n    if (isExpanded) {\n      return <ChevronDown />;\n    }\n    return <ChevronUp />;\n  }\n  if (isExpanded) {\n    return <ChevronRight />;\n  }\n  return <ChevronLeft />;\n};\n\nconst DetailButton = (props: Button) => (\n  <Fab size={'small'} onClick={() => props.onClick()} color={'primary'}>\n    {props.icon}\n  </Fab>\n);\n\n/**\n * Renders the Rhymes and Dictionary components inside a floating pane that can\n * optionally be toggled so that it disappears and reappears depending on the\n * user's preferences.\n */\nexport const DetailPane: React.FC<DetailPaneProps> = (props) => {\n  const [isLoading, setLoading] = useState(false);\n  const [isExpanded, setExpanded] = useState(true);\n  const isSmallLayout = useSmallLayout();\n  const [preferencesData] = useChannelData('prefs-updated');\n  const [isExpandedPaneShowingRhymes, setIsExpandedPaneIsShowingRhymes] =\n    // Cheating here 'cause we know the expanded pane always starts by showing the rhymes tab...\n    useState(true);\n  const [rhymesState, sendRhymesEvent] = useMachine(rhymesMachine);\n  const isRhymesVisible = isExpanded ? isExpandedPaneShowingRhymes : true;\n  const isReadOnly = useReadOnlyMode();\n\n  useEffect(() => {\n    setExpanded(!isReadOnly);\n  }, [isReadOnly]);\n\n  useLayoutEffect(() => {\n    if (!isRhymesVisible || !props.rhymeProps || !preferencesData) {\n      return;\n    }\n    sendRhymesEvent({\n      type: 'INPUT',\n      input: props.rhymeProps.query,\n      rhymeSource: preferencesData.rhymeSource,\n    });\n  }, [props.rhymeProps.query, isRhymesVisible, preferencesData]);\n\n  const showToggleButton =\n    preferencesData == null ||\n    preferencesData.detailPaneVisibility === DetailPaneVisibility.Toggleable;\n\n  useChannel(\n    'show-detail-pane',\n    () => {\n      if (showToggleButton) {\n        setExpanded(true);\n      }\n    },\n    [showToggleButton],\n  );\n\n  useChannel(\n    'close-detail-pane',\n    () => {\n      if (showToggleButton) {\n        setExpanded(false);\n      }\n    },\n    [showToggleButton],\n  );\n\n  useEffect(() => {\n    if (!isSmallLayout && !isReadOnly) {\n      setExpanded(true);\n    }\n  }, [isSmallLayout]);\n\n  useEffect(() => {\n    if (\n      preferencesData?.detailPaneVisibility === DetailPaneVisibility.Always_Show\n    ) {\n      setExpanded(true);\n    }\n  }, [preferencesData?.detailPaneVisibility]);\n\n  // Only show the small rhymes when we're not expanded on the small layout.\n  // The large layout doesn't need them.\n  const showSmallRhymes = isSmallLayout ? !isExpanded && !isReadOnly : false;\n\n  return (\n    <Box\n      width={isSmallLayout ? undefined : '400px'}\n      flex={isSmallLayout ? '0 1' : undefined}\n    >\n      <Box\n        display={'flex'}\n        flexDirection={'column'}\n        justifyContent={'end'}\n        paddingTop={isSmallLayout ? undefined : '16px'}\n        paddingLeft={isSmallLayout ? '16px' : undefined}\n        paddingRight={'16px'}\n        paddingBottom={'16px'}\n        height={'100%'}\n        width={'100%'}\n        gap={'8px'}\n      >\n        <ExpandedDetailPane\n          isExpanded={isExpanded}\n          isSmallLayout={isSmallLayout}\n          isLoading={isLoading}\n          setLoading={setLoading}\n          onTabChanged={(data) => {\n            props.onTabChanged(data);\n            setIsExpandedPaneIsShowingRhymes(data.isRhymesTab);\n          }}\n          rhymesProps={{\n            ...props.rhymeProps,\n            state: rhymesState,\n          }}\n          dictionaryProps={props.dictionaryProps}\n          diagnosticsProps={props.diagnosticsProps}\n        />\n        <Box\n          display={'flex'}\n          justifyContent={'end'}\n          alignItems={'center'}\n          flex={'0 0 auto'}\n          gap={'20px'}\n        >\n          {showSmallRhymes && (\n            <ClosedPaneRhymes\n              isLoading={isLoading}\n              rhymesState={rhymesState}\n              onRhymeClicked={props.rhymeProps.onRhymeClicked}\n            />\n          )}\n          {isReadOnly && (\n            <Link variant={'subtitle2'} onClick={props.onDisableReadonlyMode}>\n              Readonly mode\n            </Link>\n          )}\n          {props.buttons.map((button, index) => (\n            <DetailButton key={index} {...button} />\n          ))}\n          {showToggleButton && (\n            <Fab\n              size={'small'}\n              onClick={() => {\n                setExpanded(!isExpanded);\n              }}\n            >\n              <ToggleDetailPaneIcon isExpanded={isExpanded} />\n            </Fab>\n          )}\n        </Box>\n      </Box>\n    </Box>\n  );\n};\n\ninterface ClosedPaneRhymesProps {\n  isLoading: boolean;\n  rhymesState: RhymesState;\n  onRhymeClicked: (rhyme: Rhyme) => void;\n}\nconst ClosedPaneRhymes = (props: ClosedPaneRhymesProps) => (\n  <Fade in={!props.isLoading}>\n    <Box display={'flex'} flex={'1 1'} alignItems={'center'}>\n      <Box height={'32px'} overflow={'hidden'} flex={'1 1 auto'}>\n        <SingleLineRhymeList\n          state={props.rhymesState}\n          onClick={props.onRhymeClicked}\n        />\n      </Box>\n    </Box>\n  </Fade>\n);\n\nconst SingleLineRhymeList = ({\n  state,\n  onClick,\n}: {\n  state: RhymesState;\n  onClick: (rhyme: Rhyme) => void;\n}) => {\n  const rhymes = state.context.rhymes?.slice(0, 8) ?? [];\n\n  return (\n    <Box\n      display={'flex'}\n      flexWrap={'wrap'}\n      gap={'8px'}\n      alignContent={'start'}\n      flexDirection={'row'}\n    >\n      {rhymes.map((rhyme) => (\n        <WordChip\n          word={rhyme.word}\n          key={rhyme.word}\n          onClick={() => onClick(rhyme)}\n        />\n      ))}\n    </Box>\n  );\n};\n\ninterface ExpandedDetailPaneTabChangedData extends TabChangedData {\n  isRhymesTab: boolean;\n}\ninterface ExpandedDetailPaneProps {\n  isExpanded: boolean;\n  isSmallLayout: boolean;\n  isLoading: boolean;\n  setLoading: (value: boolean) => void;\n  onTabChanged: (data: ExpandedDetailPaneTabChangedData) => void;\n  rhymesProps: Omit<RhymesProps, keyof DetailPaneChildProps>;\n  dictionaryProps: DetailPaneProps['dictionaryProps'];\n  diagnosticsProps: DetailPaneProps['diagnosticsProps'];\n}\nconst ExpandedDetailPane = ({\n  isExpanded,\n  isSmallLayout,\n  isLoading,\n  setLoading,\n  onTabChanged,\n  rhymesProps,\n  dictionaryProps,\n  diagnosticsProps,\n}: ExpandedDetailPaneProps) => {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [tabIndex, setTabIndex] = useState(0);\n\n  const changeTab = useCallback(\n    (index: number) => {\n      setTabIndex(index);\n      onTabChanged({\n        // Rhymes and Dictionary both use a query to show data.\n        isQueryTab: index === 0 || index === 1,\n        isRhymesTab: index === 0,\n      });\n    },\n    [setTabIndex, onTabChanged],\n  );\n\n  useEffect(() => {\n    setLoading(false);\n  }, [tabIndex]);\n\n  // When we're closed and not animating, position as absolute so that only the\n  // button is actually taking up space in the layout. Use position instead of\n  // display so that the animation can finish properly.\n  const paperDisplay = !isExpanded && !isAnimating ? 'none' : 'unset';\n\n  return (\n    <Slide\n      in={isExpanded}\n      direction={isSmallLayout ? 'up' : 'left'}\n      onEnter={() => setIsAnimating(true)}\n      onExited={() => setIsAnimating(false)}\n    >\n      <Paper\n        elevation={1}\n        sx={{\n          minHeight: isSmallLayout ? '250px' : undefined,\n          maxHeight: isSmallLayout ? '600px' : undefined,\n          flex: '1 1 0',\n          display: paperDisplay,\n          overflow: 'auto',\n        }}\n      >\n        <Box\n          display={'flex'}\n          flexDirection={'column'}\n          height={'100%'}\n          width={'100%'}\n        >\n          <Tabs\n            value={isExpanded ? tabIndex : false}\n            onChange={(_, newTabIndex) => changeTab(newTabIndex)}\n            variant={'fullWidth'}\n            sx={{\n              flex: '0 0 auto',\n              boxShadow: 1,\n            }}\n            TabIndicatorProps={{\n              children: isLoading ? (\n                <LinearProgress variant={'indeterminate'} />\n              ) : undefined,\n            }}\n          >\n            <Tab aria-label={'Rhymes Tab'} icon={<ScriptOutline />} />\n            <Tab aria-label={'Dictionary Tab'} icon={<BookAlphabet />} />\n            <Tab aria-label={'Diagnostics Tab'} icon={<Spellcheck />} />\n          </Tabs>\n          <TabbedItem index={0} selectedIndex={tabIndex}>\n            <Rhymes\n              {...rhymesProps}\n              isVisible={tabIndex === 0}\n              onLoadingChanged={setLoading}\n            />\n          </TabbedItem>\n          <TabbedItem index={1} selectedIndex={tabIndex}>\n            <Dictionary\n              {...dictionaryProps}\n              isVisible={tabIndex === 1 && isExpanded}\n              onLoadingChanged={setLoading}\n            />\n          </TabbedItem>\n          <TabbedItem index={2} selectedIndex={tabIndex}>\n            <Diagnostics\n              {...diagnosticsProps}\n              isVisible={tabIndex === 2 && isExpanded}\n              onLoadingChanged={setLoading}\n            />\n          </TabbedItem>\n        </Box>\n      </Paper>\n    </Slide>\n  );\n};\n","import { PlatformFile } from '@lyricistant/common/files/PlatformFile';\n\n/**\n * Represents a {@link DataTransferItem} with an optional getAsFileSystemHandle\n * method that will return a FileSystemHandle.\n *\n * That method is not yet generally available, and Typescript's DOM types do not\n * have support for it yet.\n *\n * https://caniuse.com/mdn-api_datatransferitem_getasfilesystemhandle\n */\ntype FSApiDataTransferItem = DataTransferItem & {\n  getAsFileSystemHandle?: () => Promise<FileSystemFileHandle>;\n};\n/**\n * A file that, optionally, includes a path.\n *\n * Electron uses this to send files with a path parameter, but no other browser\n * does, so we mark it as optional.\n */\ntype FileWithPath = File & { path?: string };\n\n/**\n * Convert a {@link File} or a {@link DataTransferItem} to a {@link PlatformFile}\n * that can be sent to the platform.\n *\n * @param data The File or DataTransferItem to convert.\n */\nexport const toPlatformFile = async (\n  data: FSApiDataTransferItem | FileWithPath,\n): Promise<PlatformFile> => {\n  const file: FileWithPath = data instanceof File ? data : data.getAsFile();\n  const handle =\n    data instanceof File ? undefined : await data.getAsFileSystemHandle?.();\n  return {\n    metadata: {\n      path: file.path ?? file.name,\n      name: file.name,\n    },\n    type: file.type ?? '',\n    data: await file.arrayBuffer(),\n    extras: { handle },\n  };\n};\n","import { EditorView } from '@codemirror/view';\nimport { Text, useCodeMirror } from '@lyricistant/codemirror/CodeMirror';\nimport { TextSelectionData } from '@lyricistant/codemirror/textSelection';\nimport { Font } from '@lyricistant/common/preferences/PreferencesData';\nimport { useReadOnlyMode } from '@lyricistant/renderer/app/useReadOnlyMode';\nimport { Diagnostic } from '@lyricistant/renderer/diagnostics/DiagnosticsMachine';\nimport { useChannelData } from '@lyricistant/renderer/platform/useChannel';\nimport { Box, styled, useTheme } from '@mui/material';\nimport React, { useCallback, useEffect, useRef } from 'react';\nimport { toPlatformFile } from './to-platform-file';\n\nconst fontFamily = (font?: Font) => {\n  switch (font) {\n    case Font.Roboto:\n      return 'Roboto';\n    default:\n      return 'Roboto Mono';\n  }\n};\nconst EditorContainer = styled('div')({\n  flex: '1 1 500px',\n  minHeight: '50px',\n  position: 'relative',\n});\n\ninterface EdgeFadeProps {\n  endColor: string;\n  towards: 'top' | 'bottom';\n}\n\nconst EdgeFade = ({ endColor, towards }: EdgeFadeProps) => {\n  const startColor = `#${endColor.slice(1)}00`;\n  const rotation = towards === 'bottom' ? '180deg' : '0deg';\n\n  return (\n    <Box\n      sx={{\n        content: \"''\",\n        height: '8px',\n        width: '100%',\n        background: `linear-gradient(${rotation}, ${startColor} 0%, ${endColor} 100%)`,\n        position: 'absolute',\n        zIndex: 1,\n        top: towards === 'top' ? '0' : undefined,\n        bottom: towards === 'bottom' ? '0' : undefined,\n      }}\n    />\n  );\n};\n\nexport interface EditorTextData {\n  /** The text to be displayed in the editor. */\n  text: Text;\n  /**\n   * Does this represent a change from the last text data, or should this be\n   * considered brand new?\n   *\n   * TODO This cannot be a good name...\n   */\n  isTransactional?: boolean;\n  cursorPosition?: number;\n}\n\nexport interface SelectableDiagnostic extends Diagnostic {\n  key: unknown;\n}\n\n/** The props for the {@link Editor} component. */\nexport interface EditorProps {\n  /** The value to be represented in the editor. */\n  value: EditorTextData;\n  selectedText?: TextSelectionData;\n  diagnostics: Diagnostic[];\n  selectedDiagnostic?: SelectableDiagnostic;\n  onSelectedDiagnosticRendered: (rect: DOMRect) => void;\n  /**\n   * Invoked whenever the text changes.\n   *\n   * @param value The current text data in the editor.\n   */\n  onTextChanged: (value: EditorTextData) => void;\n  /**\n   * Invoked whenever the user selects text in the editor.\n   *\n   * \"Selecting text\" in this scenario means the more obvious action of the user\n   * manually highlighting text and the less obvious action of the user moving\n   * their cursor. In the case whether the user has moved their cursor but\n   * didn't highlight any text, this will instead be the nearest \"word\" to their\n   * cursor, where word is defined as a sequence of alphabetical characters.\n   *\n   * @param value The text currently selected by the user.\n   */\n  onTextSelected: (value: TextSelectionData) => void;\n  /**\n   * Invoked whenever the modification state changes.\n   *\n   * Modification state refers to whether the text in the editor has been\n   * changed or not since the last value update where {@link isTransactional} is false.\n   *\n   * @param isModified Whether the editor has been modified or not.\n   */\n  onModificationStateChanged: (isModified: boolean) => void;\n}\n\nexport const Editor: React.FC<EditorProps> = (props) => {\n  const editor = useRef<HTMLDivElement>(null);\n  const [themeData] = useChannelData('theme-updated');\n  const theme = useTheme();\n  const onFileDropped = useCallback((item: DataTransferItem | File) => {\n    logger.debug('Attempted to drop a file.');\n    toPlatformFile(item)\n      .then((file) => platformDelegate.send('open-file-attempt', file))\n      .catch((reason) => {\n        logger.error(reason);\n      });\n  }, []);\n\n  const onTextChanged = useCallback(\n    (text: Text, cursorPosition: number) => {\n      props.onTextChanged({\n        text,\n        cursorPosition,\n        isTransactional: true,\n      });\n    },\n    [props.onTextChanged],\n  );\n\n  const {\n    view,\n    isModified,\n    resetHistory,\n    redo,\n    undo,\n    openFindReplaceDialog,\n    setContainer,\n  } = useCodeMirror({\n    isReadOnly: useReadOnlyMode(),\n    text: props.value.text,\n    markedText: props.selectedText && {\n      from: props.selectedText.from,\n      to: props.selectedText.to,\n    },\n    cursorPosition: props.value.cursorPosition,\n    onTextChanged,\n    onFileDropped,\n    onTextSelected: props.onTextSelected,\n    font: fontFamily(themeData?.font),\n    diagnostics: props.diagnostics,\n  });\n\n  useEffect(() => {\n    if (editor.current) {\n      setContainer(editor.current);\n    }\n  }, [editor.current]);\n\n  useEffect(() => {\n    props.onModificationStateChanged(isModified);\n  }, [isModified]);\n  useEffect(() => {\n    if (!props.value.isTransactional) {\n      resetHistory();\n    }\n  }, [props.value]);\n\n  useEffect(() => {\n    if (!view || !props.selectedDiagnostic) {\n      return;\n    }\n\n    view.dispatch({\n      effects: [\n        EditorView.scrollIntoView(props.selectedDiagnostic.from, {\n          y: 'start',\n          yMargin: 20,\n        }),\n      ],\n    });\n    const node = view.domAtPos(props.selectedDiagnostic.from).node;\n    const range = document.createRange();\n    range.selectNode(node);\n\n    const handle = setTimeout(() => {\n      // Cheat here so that the scroll finishes from the dispatch earlier.\n      props.onSelectedDiagnosticRendered(range.getBoundingClientRect());\n    }, 0);\n\n    return () => {\n      clearTimeout(handle);\n    };\n  }, [view, props.selectedDiagnostic]);\n\n  useTextActionEvents(undo, redo, openFindReplaceDialog);\n  return (\n    <EditorContainer ref={editor}>\n      <Box\n        sx={{\n          position: 'absolute',\n          top: '0px',\n          bottom: '0px',\n          left: '8px',\n          right: '8px',\n        }}\n      >\n        <EdgeFade towards={'top'} endColor={theme.palette.background.default} />\n        <EdgeFade\n          towards={'bottom'}\n          endColor={theme.palette.background.default}\n        />\n      </Box>\n    </EditorContainer>\n  );\n};\n\nconst useTextActionEvents = (\n  undo: () => void,\n  redo: () => void,\n  openFindReplaceModal: () => void,\n) => {\n  useEffect(() => {\n    platformDelegate.on('undo', undo);\n    platformDelegate.on('redo', redo);\n    platformDelegate.on('find', openFindReplaceModal);\n    platformDelegate.on('replace', openFindReplaceModal);\n\n    return () => {\n      platformDelegate.removeListener('undo', undo);\n      platformDelegate.removeListener('redo', redo);\n      platformDelegate.removeListener('find', openFindReplaceModal);\n      platformDelegate.removeListener('replace', openFindReplaceModal);\n    };\n  }, [undo, redo, openFindReplaceModal]);\n};\n","/**\n * Attempts to get the bottom-most error message in a potential error chain.\n *\n * @param message The error to look through.\n * @returns An error, or an error message.\n */\nexport const getRootError = (message: unknown) => {\n  if (!message) {\n    return message;\n  }\n\n  let current = message;\n  do {\n    if (current instanceof Error && 'reason' in current) {\n      if (current === (current.stack || current.reason)) {\n        break;\n      }\n      current = current.stack || current.reason;\n    }\n  } while (current instanceof Error && 'reason' in current);\n\n  return current;\n};\n/**\n * Returns whether an error is something that should stop Lyricistant from\n * continuing to run or not.\n *\n * @param message The error, or error message, to check.\n * @param url An optional url given by a window.onerror callback.\n */\nexport const isReportableError = (message: unknown, url?: string) => {\n  if (typeof message === 'string' && message.includes('ResizeObserver')) {\n    // https://stackoverflow.com/questions/49384120/resizeobserver-loop-limit-exceeded\n    return false;\n  }\n  return !(\n    (!url || url.length === 0) &&\n    typeof message === 'string' &&\n    message.includes('Script error')\n  );\n};\n/**\n * Sets an error handler on the current window to handle an errors that happen,\n * wrapping any existing error handler.\n */\nexport const setWindowErrorHandler = () => {\n  const oldOnError = window.onerror;\n  window.onerror = (message, url, line, col, error) => {\n    const rootError = getRootError(message) ?? getRootError(error);\n    if (!isReportableError(rootError, url)) {\n      return;\n    }\n\n    const availableLogger = logger ?? console;\n    availableLogger.error(JSON.stringify(rootError), { url, line, col }, error);\n\n    if (oldOnError) {\n      oldOnError('Error in Lyricistant', url, line, col, error);\n    } else {\n      alert(\n        [\n          'Sorry, Lyricistant has crashed! Please close this page and contact the developers.',\n          'Continuing to use Lyricistant may result in undesired behavior.',\n          '',\n          `App version: ${process.env.APP_VERSION}`,\n          `Homepage: ${process.env.APP_HOMEPAGE}`,\n        ].join('\\n'),\n      );\n    }\n  };\n\n  if (!window.onunhandledrejection) {\n    window.onunhandledrejection = (event) =>\n      window.onerror(event, null, null, null, null);\n  }\n};\n","import { useReadOnlyMode } from '@lyricistant/renderer/app/useReadOnlyMode';\nimport { useSmallLayout } from '@lyricistant/renderer/app/useSmallLayout';\nimport { useChannelData } from '@lyricistant/renderer/platform/useChannel';\nimport {\n  AddCircle,\n  Edit,\n  EditOff,\n  FolderOpen,\n  GetApp,\n  History,\n  MoreVert,\n  Save,\n  Settings,\n  SvgIconComponent,\n} from '@mui/icons-material';\nimport {\n  Box,\n  Checkbox,\n  IconButton,\n  ListItemIcon,\n  ListItemText,\n  Menu as MuiMenu,\n  MenuItem,\n  Paper,\n  SxProps,\n  useTheme,\n} from '@mui/material';\nimport React, {\n  MouseEvent,\n  PropsWithChildren,\n  useEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport { useDebouncedCallback } from 'use-debounce';\n\ninterface MenuIconProps extends PropsWithChildren {\n  onClick: (event: MouseEvent) => void;\n  ariaLabel: string;\n  debounce?: boolean;\n  sx?: SxProps;\n}\nconst MenuIcon = ({\n  onClick,\n  ariaLabel,\n  debounce,\n  sx,\n  children,\n}: MenuIconProps) => {\n  const debouncedClick = useDebouncedCallback(onClick, 200);\n\n  return (\n    <Box\n      padding={'8px'}\n      aria-label={ariaLabel}\n      role={'button'}\n      sx={sx}\n      onClick={debounce ? debouncedClick : onClick}\n    >\n      <IconButton>{children}</IconButton>\n    </Box>\n  );\n};\n\ninterface MenuItemData {\n  icon: SvgIconComponent;\n  label: string;\n  checked?: boolean;\n  onClick: () => void;\n}\n\ninterface AppBarProps {\n  direction: 'horizontal' | 'vertical';\n  leading: MenuItemData[];\n  trailing: MenuItemData[];\n}\n\nconst toMenuIcon = (item: MenuItemData) => (\n  <MenuIcon key={item.label} onClick={item.onClick} ariaLabel={item.label}>\n    <item.icon />\n  </MenuIcon>\n);\n\nconst MenuBar = (props: AppBarProps) => {\n  const isHorizontal = props.direction === 'horizontal';\n  const [anchor, setAnchor] = useState<Element>(null);\n  const onMenuClicked = (event: MouseEvent) => setAnchor(event.currentTarget);\n\n  const shouldTrim = useMemo(\n    () => props.leading.length > 3 && isHorizontal,\n    [props.leading, isHorizontal],\n  );\n\n  const leading: MenuItemData[] = useMemo(() => {\n    if (shouldTrim) {\n      return props.leading.slice(0, 3);\n    }\n    return props.leading;\n  }, [props.leading, shouldTrim]);\n\n  const trailing: MenuItemData[] = useMemo(() => {\n    if (shouldTrim) {\n      return [...props.leading.slice(3), ...props.trailing];\n    }\n    return props.trailing;\n  }, [props.leading, props.trailing, shouldTrim]);\n\n  useEffect(() => {\n    setAnchor(null);\n  }, [isHorizontal]);\n\n  return (\n    <Box\n      display={'flex'}\n      height={isHorizontal ? 'auto' : '100%'}\n      width={isHorizontal ? '100%' : 'auto'}\n      flexDirection={isHorizontal ? 'row' : 'column'}\n    >\n      {leading.map(toMenuIcon)}\n      <Box flexGrow={'1'} />\n      <MenuIcon\n        sx={{ display: isHorizontal ? undefined : 'none' }}\n        ariaLabel={'Additional Menu Buttons'}\n        onClick={onMenuClicked}\n        debounce={false}\n      >\n        <MoreVert />\n      </MenuIcon>\n      <MuiMenu\n        anchorEl={anchor}\n        open={!!anchor}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'left',\n        }}\n        transformOrigin={{\n          vertical: 'top',\n          horizontal: 'left',\n        }}\n        onClose={() => setAnchor(null)}\n      >\n        {trailing.map((item) => (\n          <MenuItem\n            key={item.label}\n            aria-label={item.label}\n            onClick={() => {\n              setAnchor(null);\n              item.onClick();\n            }}\n          >\n            <ListItemIcon>\n              {item.checked !== undefined ? (\n                <Checkbox checked={item.checked} edge={'start'} disableRipple />\n              ) : (\n                <item.icon />\n              )}\n            </ListItemIcon>\n            <ListItemText>{item.label}</ListItemText>\n          </MenuItem>\n        ))}\n      </MuiMenu>\n      {isHorizontal ? null : trailing.map(toMenuIcon)}\n    </Box>\n  );\n};\n\n/** The props needed to render {@link Menu}. */\nexport interface MenuProps {\n  onReadOnlyToggled: (readOnly: boolean) => void;\n  /** Invoked when the new button is clicked */\n  onNewClicked: () => void;\n  /** Invoked when the open button is clicked */\n  onOpenClicked: () => void;\n  /** Invoked when the save button is clicked */\n  onSaveClicked: () => void;\n  /** Invoked when the preferences button is clicked */\n  onPreferencesClicked: () => void;\n  /** Invoked when the download button is clicked */\n  onDownloadClicked: () => void;\n  /** Invoked when the file history button is clicked */\n  onFileHistoryClicked: () => void;\n}\n\n/**\n * Renders a menu, which is a list of buttons.\n *\n * When in small layout, this menu renders horizontally. If there are more than\n * 3 buttons, it will show the extras in an overflow menu.\n *\n * When not in small layout, it renders vertically with spacing between the\n * first 4 buttons and the rest of the button.\n *\n * @param props The props needed to render this component.\n */\nexport const Menu: React.FC<MenuProps> = (props) => {\n  const theme = useTheme();\n  const [uiConfig] = useChannelData('ui-config');\n  const isSmallLayout = useSmallLayout();\n  const direction = isSmallLayout ? 'horizontal' : 'vertical';\n  const isReadOnly = useReadOnlyMode();\n\n  const leadingIcons = useMemo(\n    () =>\n      [\n        !isReadOnly && {\n          label: 'New file',\n          icon: AddCircle,\n          onClick: props.onNewClicked,\n        },\n        !isReadOnly &&\n          uiConfig?.showOpen && {\n            label: 'Open file',\n            icon: FolderOpen,\n            onClick: props.onOpenClicked,\n          },\n        {\n          label: 'Save file',\n          icon: Save,\n          onClick: props.onSaveClicked,\n        },\n        uiConfig?.showOpen && {\n          label: 'View file history',\n          icon: History,\n          onClick: props.onFileHistoryClicked,\n        },\n      ].filter((node) => node),\n    [uiConfig, props],\n  );\n  const trailingIcons = useMemo(\n    () =>\n      [\n        uiConfig?.showDownload && {\n          label: 'Download Lyricistant',\n          icon: GetApp,\n          onClick: props.onDownloadClicked,\n        },\n        {\n          label: 'Enable readonly mode',\n          icon: isReadOnly ? EditOff : Edit,\n          checked: isReadOnly,\n          onClick: () => {\n            props.onReadOnlyToggled(!isReadOnly);\n          },\n        },\n        {\n          label: 'Open preferences',\n          icon: Settings,\n          onClick: props.onPreferencesClicked,\n        },\n      ].filter((value) => !!value),\n    [uiConfig, props],\n  );\n\n  return (\n    <Box\n      paddingTop={'8px'}\n      paddingLeft={'8px'}\n      paddingRight={isSmallLayout ? '8px' : undefined}\n      paddingBottom={isSmallLayout ? undefined : '8px'}\n    >\n      <Paper\n        color={theme.palette.primary.main}\n        sx={{\n          backgroundColor: theme.palette.background.paper,\n          height: isSmallLayout ? 'auto' : '100%',\n          width: isSmallLayout ? '100%' : 'auto',\n        }}\n      >\n        <MenuBar\n          direction={direction}\n          leading={leadingIcons}\n          trailing={trailingIcons}\n        />\n      </Paper>\n    </Box>\n  );\n};\n","import { useSmallLayout } from '@lyricistant/renderer/app/useSmallLayout';\nimport { Box } from '@mui/material';\nimport React, { ReactNode, useEffect } from 'react';\n\ninterface ResponsiveMenuDetailLayoutProps {\n  /** The main component that should be displayed. */\n  main: ReactNode;\n  /** The detail, secondary, component that should be displayed. */\n  detail: ReactNode;\n  /** The menu component that should be displayed. */\n  menu: ReactNode;\n}\n\n/**\n * A responsive layout with a main, detail, and menu section that changes based\n * on the screen size.\n *\n * @param props The props for this component.\n */\nexport const ResponsiveMainDetailLayout = ({\n  main,\n  detail,\n  menu,\n}: ResponsiveMenuDetailLayoutProps) => {\n  const isSmallLayout = useSmallLayout();\n\n  useEffect(() => {\n    logger.info(`Switching layout. isSmallLayout: ${isSmallLayout}`);\n  }, [isSmallLayout]);\n\n  return (\n    <Box\n      flex={'1 1 auto'}\n      display={'flex'}\n      overflow={'hidden'}\n      flexDirection={isSmallLayout ? 'column' : 'row'}\n    >\n      <React.Fragment key={'menu'}>{menu}</React.Fragment>\n      <React.Fragment key={'main'}>{main}</React.Fragment>\n      <React.Fragment key={'detail'}>{detail}</React.Fragment>\n    </Box>\n  );\n};\n","import { UiConfig } from '@lyricistant/common/ui/UiConfig';\nimport { useChannel } from '@lyricistant/renderer/platform/useChannel';\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  DialogTitle,\n} from '@mui/material';\nimport React, { useState } from 'react';\nimport { PropsWithChildren } from 'react';\nimport { isIE, isMobile } from 'react-device-detect';\n\nconst isUnsupportedBrowser = isMobile || isIE || !Promise || !File || !Blob;\n\nconst getTipMessage = () => {\n  if (isMobile) {\n    return 'Try switching to a desktop browser.';\n  } else {\n    return 'Try switching to a more modern browser.';\n  }\n};\n\nconst WarningDialog = ({\n  onContinue,\n  open,\n}: {\n  onContinue: () => void;\n  open: boolean;\n}) => (\n  <Dialog open={open}>\n    <DialogTitle>Unsupported browser</DialogTitle>\n    <DialogContent>\n      <DialogContentText>\n        Lyricistant doesn't currently support your browser. You might experience\n        some bugs or performance issues. {getTipMessage()}\n      </DialogContentText>\n    </DialogContent>\n\n    <DialogActions>\n      <Button key=\"no\" onClick={() => window.history.back()} color=\"primary\">\n        Go back\n      </Button>\n      <Button key=\"yes\" onClick={onContinue} color=\"primary\">\n        Continue\n      </Button>\n    </DialogActions>\n  </Dialog>\n);\n\n/** A dialog that displays whenever Lyricistant is running against an unsupported browser. */\nexport function SupportedBrowserWarning({\n  children,\n}: PropsWithChildren<Record<never, never>>) {\n  const [uiConfig, setUiConfig] = useState<UiConfig>(null);\n  useChannel('ui-config', setUiConfig);\n  const [isAcknowledged, setAcknowledged] = useState(false);\n  const showWarning =\n    uiConfig?.showBrowserWarning === true &&\n    isUnsupportedBrowser &&\n    !isAcknowledged;\n  return (\n    <>\n      <WarningDialog\n        open={showWarning}\n        onContinue={() => setAcknowledged(true)}\n      />\n      {children}\n    </>\n  );\n}\n","import { setupAnalytics } from '@lyricistant/renderer/analytics/setupAnalytics';\nimport { App } from '@lyricistant/renderer/app/App';\nimport { PlatformEventsReadyHandler } from '@lyricistant/renderer/app/PlatformEventsReadyHandler';\nimport { SupportedBrowserWarning } from '@lyricistant/renderer/app/SupportedBrowserWarning';\nimport { setWindowErrorHandler } from '@lyricistant/renderer/errors/ErrorHandlers';\nimport { onPageLoaded, onThemeUpdated } from '@lyricistant/renderer/preload';\nimport { Themed } from '@lyricistant/renderer/theme/Themed';\nimport { SnackbarProvider } from 'notistack';\nimport React from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { Router, BaseLocationHook } from 'wouter';\nimport { useLocationProperty, navigate } from 'wouter/use-location';\n\nif (module.hot) {\n  module.hot.accept();\n}\n\nsetWindowErrorHandler();\nsetupAnalytics();\nconst container: HTMLElement = document.getElementById('app');\nconst root = ReactDOM.createRoot(container);\n\nconst hashLocation = () => window.location.hash.replace(/^#/, '') || '/';\nconst hashNavigate = (to: string, ...args: unknown[]) => {\n  if (to) {\n    navigate('#' + to, ...args);\n  } else {\n    navigate('/', ...args);\n  }\n  window.history.replaceState({ internal: true }, null, null);\n};\n\nconst useHashLocation: BaseLocationHook = () => {\n  const location = useLocationProperty(hashLocation);\n  return [location, hashNavigate];\n};\n\nroot.render(\n  <React.StrictMode>\n    <PlatformEventsReadyHandler>\n      <Themed\n        onThemeChanged={(palette) => {\n          document.body.style.backgroundColor = palette.background;\n          document.body.style.color = palette.primaryText;\n          onThemeUpdated(palette);\n        }}\n        onThemeReady={() => {\n          onPageLoaded();\n          container.style.opacity = '100%';\n        }}\n      >\n        <SnackbarProvider\n          maxSnack={3}\n          anchorOrigin={{\n            vertical: 'bottom',\n            horizontal: 'right',\n          }}\n        >\n          <SupportedBrowserWarning>\n            <Router hook={useHashLocation}>\n              <App />\n            </Router>\n          </SupportedBrowserWarning>\n        </SnackbarProvider>\n      </Themed>\n    </PlatformEventsReadyHandler>\n  </React.StrictMode>,\n);\n","import { isUnderTest } from '@lyricistant/common/BuildModes';\nimport { APP_PLATFORM, APP_VERSION } from '@lyricistant/renderer/globals';\n\n/**\n * When running in production, connects to an analytics server and reports the\n * current version of Lyricistant that is running as well as the platform it is\n * being run on.\n */\nexport const setupAnalytics = () => {\n  if (process.env.NODE_ENV !== 'production' || isUnderTest) {\n    return;\n  }\n\n  const settings = {\n    allow_local: true,\n    no_onload: true,\n    no_events: true,\n  };\n  const analyticsScript = document.createElement('script');\n  analyticsScript.setAttribute('src', 'https://gc.zgo.at/count.js');\n  analyticsScript.setAttribute('async', 'true');\n  analyticsScript.setAttribute(\n    'data-goatcounter',\n    'https://lyricistant.goatcounter.com/count',\n  );\n  analyticsScript.setAttribute(\n    'data-goatcounter-settings',\n    JSON.stringify(settings),\n  );\n  document.head.append(analyticsScript);\n\n  const timeoutId = setTimeout(() => {\n    if (!window.goatcounter || !window.goatcounter.count) {\n      return;\n    }\n\n    let site: string;\n    if (location.host.includes('lyricistant.app')) {\n      site = location.host;\n    } else {\n      site = APP_PLATFORM;\n    }\n\n    const path = `${site}/${APP_VERSION}/`;\n\n    clearTimeout(timeoutId);\n\n    window.goatcounter.count({\n      path,\n      title: '',\n      event: false,\n    });\n  }, 10000);\n};\n","import React, { ReactNode, useEffect, useRef } from 'react';\n\n/**\n * Handles telling the platform when the renderer is ready to receive events.\n *\n * Due to how React's useEffect works, this MUST be the top-most component in\n * the tree that uses the platform delegate, so that the app properly alerts the\n * platform that it is ready to receive events after every other component has\n * registered its own platform listeners.\n */\nexport const PlatformEventsReadyHandler = ({\n  children,\n}: {\n  children: ReactNode;\n}) => {\n  // useEffects can be called multiple times (and are in Strict mode) so this makes sure this\n  // is really only ever called once.\n  const hasSentReadyForEvents = useRef(false);\n  useEffect(() => {\n    if (!hasSentReadyForEvents.current) {\n      platformDelegate.send('ready-for-events', {\n        isDeepLink: location.hash.length !== 0,\n      });\n    }\n\n    hasSentReadyForEvents.current = true;\n  }, []);\n  return <>{children}</>;\n};\n","import {\n  Font,\n  ThemeData,\n} from '@lyricistant/common/preferences/PreferencesData';\nimport { Palette } from '@lyricistant/common/theme/SystemTheme';\nimport { useChannel } from '@lyricistant/renderer/platform/useChannel';\nimport { createTheme, getThemePalette } from '@lyricistant/renderer/theme';\nimport {\n  CssBaseline,\n  GlobalStyles,\n  StyledEngineProvider,\n  ThemeProvider,\n} from '@mui/material';\nimport React, {\n  FunctionComponent,\n  PropsWithChildren,\n  useEffect,\n  useState,\n} from 'react';\n\nconst loadFont = async (themeData?: ThemeData) => {\n  switch (themeData?.font) {\n    case Font.Roboto:\n      return import('@fontsource/roboto/latin-400.css');\n    default:\n      return import('@fontsource/roboto-mono/latin-400.css');\n  }\n};\n/**\n * A component that provides a MUI theme to all of its children, handles loading\n * fonts, and sets a standard CSS baseline.\n *\n * @param onThemeChanged Invoked when the theme changes.\n * @param onThemeReady Invoked when a theme has been successfully created.\n * @param children The children of this component.\n */\nexport const Themed: FunctionComponent<\n  PropsWithChildren<{\n    onThemeChanged: (palette: Palette) => void;\n    onThemeReady: () => void;\n  }>\n> = ({ onThemeChanged, onThemeReady, children }) => {\n  const [theme, setTheme] = useState(createTheme());\n  const [palette, setPalette] = useState<Palette | null>(null);\n\n  useChannel(\n    'theme-updated',\n    (themeData) => {\n      const appTheme = createTheme(themeData);\n      setPalette(getThemePalette(themeData).palette);\n\n      loadFont(themeData)\n        .then(() => {\n          setTheme(appTheme);\n          onThemeReady();\n        })\n        .catch((reason) => {\n          setTheme(appTheme);\n          onThemeReady();\n          logger.warn('Failed to load fonts', reason);\n        });\n    },\n    [setTheme],\n  );\n\n  useEffect(() => {\n    if (palette) {\n      onThemeChanged(palette);\n    }\n  }, [palette, onThemeChanged]);\n\n  return (\n    <StyledEngineProvider injectFirst>\n      <ThemeProvider theme={theme}>\n        <GlobalStyles\n          styles={{\n            '.random-button': {\n              color: theme.palette.primary.main,\n              backgroundColor: theme.palette.background.default,\n            },\n          }}\n        />\n        <CssBaseline>{children} </CssBaseline>\n      </ThemeProvider>\n    </StyledEngineProvider>\n  );\n};\n","import { Text } from '@lyricistant/codemirror/CodeMirror';\nimport { TextSelectionData } from '@lyricistant/codemirror/textSelection';\nimport { AppError } from '@lyricistant/renderer/app/AppError';\nimport { Modals } from '@lyricistant/renderer/app/Modals';\nimport { useNavigation } from '@lyricistant/renderer/app/Navigation';\nimport { useSmallLayout } from '@lyricistant/renderer/app/useSmallLayout';\nimport { DetailPane } from '@lyricistant/renderer/detail/DetailPane';\nimport { DiagnosticActionPopover } from '@lyricistant/renderer/diagnostics/Diagnostics';\nimport { Diagnostic } from '@lyricistant/renderer/diagnostics/DiagnosticsMachine';\nimport {\n  Editor,\n  EditorTextData,\n  SelectableDiagnostic,\n} from '@lyricistant/renderer/editor/Editor';\nimport {\n  getRootError,\n  isReportableError,\n} from '@lyricistant/renderer/errors/ErrorHandlers';\nimport { Menu } from '@lyricistant/renderer/menu/Menu';\nimport {\n  useChannel,\n  useChannelData,\n} from '@lyricistant/renderer/platform/useChannel';\nimport { Rhyme } from '@lyricistant/renderer/rhymes/rhyme';\nimport { useEventCallback } from '@mui/material';\nimport { sample, startCase } from 'lodash-es';\nimport { useSnackbar } from 'notistack';\nimport React, { useCallback, useEffect, useReducer, useState } from 'react';\nimport { ErrorBoundary, FallbackProps } from 'react-error-boundary';\nimport { ResponsiveMainDetailLayout } from './ResponsiveMainDetailLayout';\nimport { ReadOnlyModeContext } from './useReadOnlyMode';\nimport { useBeforeUnload } from '@lyricistant/renderer/app/useBeforeUnload';\n\nconst MINIMUM_IDLE_TIME = 15_000;\n\n/**\n * The Lyricistant app.\n *\n * Any component that renders any UI directly related to the core functionality\n * of Lyricistant must be a child of this component, either directly or\n * indirectly. Components that don't render UI, such as a Router or a\n * ThemeProvider, are allowed to be a parent of this component. Components that\n * potentially gate Lyricistant's ability to run, such as a component that\n * checks whether we're running on a supported browser, would also be allowed to\n * be a parent of this component.\n */\nexport function App() {\n  const [editorTextData, setEditorTextData] = useState<EditorTextData>({\n    text: Text.empty,\n    isTransactional: false,\n  });\n  const [error, setError] = useState<unknown>(null);\n  const [selectedText, setSelectedText] = useState<TextSelectionData>();\n  const [isModified, setIsModified] = useState(false);\n  const navigate = useNavigation();\n  const [uiConfig] = useChannelData('ui-config');\n  const [showQuerySelection, setShowQuerySelection] = useState(true);\n  const [diagnostics, onDiagnosticsLoaded] = useState([]);\n  const [selectedDiagnostic, setSelectedDiagnostic] =\n    useState<SelectableDiagnostic>(null);\n  const [selectedDiagnosticRect, setSelectedDiagnosticRect] =\n    useState<DOMRect>(null);\n  const [selectedDiagnosticKey, incrementKey] = useReducer(\n    (value) => value + 1,\n    0,\n  );\n  const [isReadOnly, setReadOnly] = useState(false);\n\n  useEffect(() => {\n    setSelectedDiagnostic(null);\n  }, [diagnostics]);\n\n  const onSaveClicked = useCallback(\n    () =>\n      platformDelegate.send(\n        'save-file-attempt',\n        editorTextData.text.toString(),\n      ),\n    [editorTextData.text],\n  );\n\n  const onPartialEditorTextDataUpdate = useCallback(\n    (data: Partial<EditorTextData>) => {\n      setEditorTextData((textData) => ({ ...textData, ...data }));\n    },\n    [setEditorTextData],\n  );\n  const onTextReplacement = useEventCallback((text: string) => {\n    if (isReadOnly) {\n      return;\n    }\n\n    const prefix = editorTextData.text.sliceString(0, selectedText.from);\n    const suffix = editorTextData.text.sliceString(selectedText.to);\n\n    setEditorTextData({\n      text: Text.of((prefix + text + suffix).split('\\n')),\n      isTransactional: true,\n      cursorPosition: selectedText.from + text.length,\n    });\n    setSelectedText({\n      text,\n      from: selectedText.from,\n      to: selectedText.from + text.length,\n    });\n  });\n\n  const onTextSelected = useEventCallback((value: TextSelectionData) => {\n    if (value && value.text) {\n      setSelectedText(value);\n    }\n  });\n\n  useChannel('app-title-changed', (title) => (document.title = title));\n\n  useFileEvents(isModified, onPartialEditorTextDataUpdate, () =>\n    setSelectedText({ from: 0, to: 0, text: '' }),\n  );\n  useBeforeUnload(() => {\n    if (uiConfig?.promptOnUrlChange && isModified) {\n      return \"Are you sure you want to leave? Your changes haven't been saved.\";\n    }\n  });\n\n  useEffect(() => {\n    const onTextRequested = () => {\n      platformDelegate.send('editor-text', editorTextData.text.toString());\n    };\n    platformDelegate.on('request-editor-text', onTextRequested);\n    return () => {\n      platformDelegate.removeListener('request-editor-text', onTextRequested);\n    };\n  }, [editorTextData.text]);\n\n  useEffect(() => {\n    window.onerror = (message, url, col, line, newError) => {\n      const rootError = getRootError(newError ?? message);\n      if (isReportableError(rootError, url)) {\n        setError(rootError);\n      }\n    };\n    window.onunhandledrejection = window.onerror;\n  }, []);\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      platformDelegate.send('editor-idle', editorTextData.text.toString());\n    }, MINIMUM_IDLE_TIME);\n    return () => clearTimeout(timer);\n  }, [editorTextData]);\n\n  const isSmallLayout = useSmallLayout();\n  useEffect(() => {\n    platformDelegate.send('layout-changed', isSmallLayout);\n  }, [isSmallLayout]);\n\n  const fallbackErrorRendering = useCallback(\n    (props: FallbackProps) => (\n      <AppError\n        error={getRootError(props.error)}\n        editorText={editorTextData.text.toString()}\n      />\n    ),\n    [editorTextData.text],\n  );\n\n  const onDownloadClicked = useEventCallback(() => navigate('/download'));\n  const onFileHistoryClicked = useEventCallback(() =>\n    navigate('/file-history'),\n  );\n  const onPreferencesClicked = useEventCallback(() => navigate('/preferences'));\n  const onNewClicked = useEventCallback(() =>\n    platformDelegate.send('new-file-attempt'),\n  );\n  const onOpenClicked = useEventCallback(() =>\n    platformDelegate.send('open-file-attempt'),\n  );\n  const onRhymeClicked = useEventCallback((rhyme: Rhyme) =>\n    onTextReplacement(rhyme.word),\n  );\n\n  const { onInspirationButtonClicked, isInspirationButtonEnabled } =\n    useInspirationButton(\n      editorTextData,\n      isReadOnly,\n      setEditorTextData,\n      setSelectedText,\n    );\n\n  const { onProposalAccepted } = useProposalAcceptance(\n    editorTextData,\n    isReadOnly,\n    setEditorTextData,\n    setSelectedText,\n  );\n\n  if (error) {\n    return (\n      <AppError error={error} editorText={editorTextData.text.toString()} />\n    );\n  }\n\n  return (\n    <ErrorBoundary fallbackRender={fallbackErrorRendering}>\n      <ReadOnlyModeContext.Provider value={isReadOnly}>\n        <ResponsiveMainDetailLayout\n          menu={\n            <Menu\n              onReadOnlyToggled={setReadOnly}\n              onDownloadClicked={onDownloadClicked}\n              onFileHistoryClicked={onFileHistoryClicked}\n              onPreferencesClicked={onPreferencesClicked}\n              onNewClicked={onNewClicked}\n              onOpenClicked={onOpenClicked}\n              onSaveClicked={onSaveClicked}\n            />\n          }\n          main={\n            <Editor\n              value={editorTextData}\n              selectedText={showQuerySelection ? selectedText : null}\n              diagnostics={diagnostics}\n              selectedDiagnostic={selectedDiagnostic}\n              onSelectedDiagnosticRendered={setSelectedDiagnosticRect}\n              onTextChanged={setEditorTextData}\n              onTextSelected={onTextSelected}\n              onModificationStateChanged={setIsModified}\n            />\n          }\n          detail={\n            <DetailPane\n              buttons={[]}\n              onTabChanged={(data) => {\n                setShowQuerySelection(data.isQueryTab);\n              }}\n              rhymeProps={{\n                onRhymeClicked,\n                query: selectedText?.text,\n                isSurpriseButtonEnabled: isInspirationButtonEnabled,\n                onSurpriseMeClicked: onInspirationButtonClicked,\n              }}\n              dictionaryProps={{\n                onRelatedTextClicked: onTextReplacement,\n                query: selectedText?.text,\n              }}\n              diagnosticsProps={{\n                text: editorTextData.text,\n                onDiagnosticsLoaded,\n                onProposalAccepted,\n                onDiagnosticClicked: (diagnostic) => {\n                  setSelectedDiagnostic({\n                    ...diagnostic,\n                    key: selectedDiagnosticKey,\n                  });\n                  incrementKey();\n                },\n              }}\n              onDisableReadonlyMode={() => setReadOnly(false)}\n            />\n          }\n        />\n        <Modals />\n        <DiagnosticActionPopover\n          diagnostic={selectedDiagnostic}\n          domRect={selectedDiagnosticRect}\n          onProposalAccepted={onProposalAccepted}\n          onClose={() => {\n            setSelectedDiagnostic(null);\n            setSelectedDiagnosticRect(null);\n          }}\n        />\n      </ReadOnlyModeContext.Provider>\n    </ErrorBoundary>\n  );\n}\n\nconst useProposalAcceptance = (\n  editorTextData: EditorTextData,\n  isReadOnly: boolean,\n  setEditorTextData: (data: EditorTextData) => void,\n  setSelectedText: (data: TextSelectionData) => void,\n) => {\n  const onProposalAccepted = useEventCallback(\n    (proposal: string, diagnostic: Diagnostic) => {\n      if (isReadOnly) {\n        return;\n      }\n\n      setEditorTextData({\n        ...editorTextData,\n        text: editorTextData.text.replace(\n          diagnostic.from,\n          diagnostic.to,\n          Text.of([proposal]),\n        ),\n      });\n      setSelectedText({\n        text: proposal,\n        from: diagnostic.from,\n        to: diagnostic.from + proposal.length,\n      });\n    },\n  );\n\n  return {\n    onProposalAccepted,\n  };\n};\n\nconst useInspirationWords = () => {\n  const [inspirationWords, setInspirationWords] = useState<string[]>(null);\n  useEffect(() => {\n    if (!inspirationWords) {\n      import('./inspiration_words.json').then((words) => {\n        setInspirationWords(words);\n      });\n    }\n  }, []);\n  return inspirationWords;\n};\n\nconst useInspirationButton = (\n  editorTextData: EditorTextData,\n  isReadOnly: boolean,\n  setEditorTextData: (data: EditorTextData) => void,\n  setSelectedText: (data: TextSelectionData) => void,\n) => {\n  const inspirationWords = useInspirationWords();\n  const onInspirationButtonClicked = useEventCallback(() => {\n    if (isReadOnly) {\n      return;\n    }\n\n    const position = editorTextData.cursorPosition ?? 0;\n    const prefix = editorTextData.text.sliceString(0, position);\n    const suffix = editorTextData.text.sliceString(position);\n\n    const word = sample(inspirationWords);\n    const line = editorTextData.text.lineAt(position);\n    let newText = word;\n    let newPosition = position + word.length;\n    const isStartOfLine = position === line.from;\n    const isEndOfLine = position === line.to;\n\n    if (isStartOfLine) {\n      newText = startCase(newText);\n    }\n\n    const isPreviousCharacterSpace =\n      !isStartOfLine &&\n      position > 0 &&\n      editorTextData.text\n        .slice(position - 1, position)\n        .toString()\n        .match(/\\s/);\n    const isNextCharacterSpace =\n      !isEndOfLine &&\n      position < editorTextData.text.length &&\n      editorTextData.text\n        .slice(position, position + 1)\n        .toString()\n        .match(/\\s/);\n\n    if (prefix && !isStartOfLine && !isPreviousCharacterSpace) {\n      newText = ' ' + newText;\n      newPosition += 1;\n    }\n    if (suffix && !isEndOfLine && !isNextCharacterSpace) {\n      newText = newText + ' ';\n    }\n\n    setEditorTextData({\n      text: Text.of((prefix + newText + suffix).split('\\n')),\n      isTransactional: true,\n      cursorPosition: newPosition,\n    });\n    setSelectedText({\n      text: word,\n      from: newPosition - word.length,\n      to: newPosition,\n    });\n  });\n\n  return {\n    onInspirationButtonClicked,\n    isInspirationButtonEnabled: !isReadOnly && !!inspirationWords,\n  };\n};\n\nconst useFileEvents = (\n  isModified: boolean,\n  setEditorText: (text: Partial<EditorTextData>) => void,\n  resetTextSelection: () => void,\n) => {\n  const { enqueueSnackbar } = useSnackbar();\n\n  useEffect(() => {\n    const onCheckFileModified = () => {\n      platformDelegate.send('is-file-modified', isModified);\n    };\n    platformDelegate.on('check-file-modified', onCheckFileModified);\n\n    const onFileSaveEnded = (_: never, path: string) => {\n      setEditorText({ isTransactional: false });\n\n      if (path) {\n        enqueueSnackbar(`${path} saved`, { variant: 'success' });\n      }\n    };\n    platformDelegate.on('file-save-ended', onFileSaveEnded);\n\n    const onNewFileCreated = () => {\n      resetTextSelection();\n      setEditorText({ text: Text.empty, isTransactional: false });\n    };\n    platformDelegate.on('new-file-created', onNewFileCreated);\n\n    const onFileOpened = (\n      error: Error,\n      fileContents: string,\n      clearHistory: boolean,\n    ) => {\n      if (error) {\n        enqueueSnackbar(\"Couldn't open selected file.\", {\n          variant: 'error',\n        });\n      } else {\n        resetTextSelection();\n        setEditorText({\n          text: Text.of(fileContents.split('\\n')),\n          isTransactional: !clearHistory,\n        });\n      }\n    };\n    platformDelegate.on('file-opened', onFileOpened);\n\n    return () => {\n      platformDelegate.removeListener(\n        'check-file-modified',\n        onCheckFileModified,\n      );\n      platformDelegate.removeListener('file-save-ended', onFileSaveEnded);\n      platformDelegate.removeListener('new-file-created', onNewFileCreated);\n      platformDelegate.removeListener('file-opened', onFileOpened);\n    };\n  }, [isModified, setEditorText]);\n};\n","import { useEffect } from 'react';\n\nexport const useBeforeUnload = (listener: () => void) => {\n  useEffect(() => {\n    window.addEventListener('beforeunload', listener);\n    return () => {\n      window.removeEventListener('beforeunload', listener);\n    };\n  }, [listener]);\n};\n","var _path;\nfunction _extends() { return _extends = Object.assign ? Object.assign.bind() : function (n) { for (var e = 1; e < arguments.length; e++) { var t = arguments[e]; for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]); } return n; }, _extends.apply(null, arguments); }\nimport * as React from \"react\";\nvar SvgLyricistantLogo = function SvgLyricistantLogo(props) {\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fillRule: \"evenodd\",\n    strokeLinejoin: \"round\",\n    strokeMiterlimit: 2,\n    viewBox: \"0 0 1080 1080\"\n  }, props), _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M592.265 470.55c-20.047-.319-38.048.176-52.263.176h-.004c-14.215 0-32.216-.495-52.261-.176-17.723-10.982-53.501-37.388-72.145-80.758-14.428-33.563-24.106-61.379-36.711-79.831-15.816-23.151-35.498-34.601-69.354-29.222-16.637 2.642-33.045 12.088-46.071 26.691-28.142 31.546-40.977 87.562-3.838 141.709 16.956 24.721 45.235 42.363 75.276 54.42-47.412 27.244-75.95 72.203-86.109 127.629-16.644 90.807 25.192 155.58 75.307 197.187 46.396 38.519 114.729 69.158 215.806 69.784l-.15-.005h.504l-.15.005c101.077-.626 169.41-31.265 215.806-69.784 50.115-41.607 91.952-106.38 75.307-197.187-10.159-55.426-38.697-100.385-86.108-127.628 30.042-12.058 58.321-29.7 75.277-54.421 37.139-54.147 24.304-110.163-3.838-141.709-13.026-14.603-29.434-24.049-46.071-26.691-33.856-5.379-53.538 6.071-69.354 29.222-12.605 18.452-22.283 46.268-36.711 79.831-18.644 43.37-54.422 69.776-72.145 80.758m9.057 96.811 7.257-28.92c2.734-10.894-3.891-21.958-14.785-24.691s-21.958 3.891-24.691 14.785l-7.877 31.391a211.1 211.1 0 0 1-21.225 52.938 211.1 211.1 0 0 1-21.225-52.938l-7.877-31.391c-2.221-8.851-9.941-14.884-18.601-15.369l-1.003-.031a20.4 20.4 0 0 0-5.087.615c-10.894 2.733-17.519 13.797-14.785 24.691l7.257 28.92c24.749 16.308 41.097 44.35 41.097 76.181 0 50.317-40.851 91.168-91.168 91.168s-91.168-40.851-91.168-91.168 40.851-91.168 91.168-91.168a91 91 0 0 1 26.371 3.88c-6.214-12.16-15.449-23.71-28.939-28.208-32.329-10.78-74.18-5.365-115.225 50.487-38.357 52.193-26.981 126.591 18.791 180.196 44.956 52.649 107.783 82.754 210.394 82.448 102.611.306 165.438-29.799 210.394-82.448 45.772-53.605 57.148-128.003 18.791-180.196-41.045-55.852-82.896-61.267-115.225-50.487-13.49 4.498-22.725 16.048-28.939 28.208a91 91 0 0 1 26.371-3.88c50.317 0 91.168 40.851 91.168 91.168s-40.851 91.168-91.168 91.168-91.168-40.851-91.168-91.168c0-31.831 16.348-59.873 41.097-76.181m-94.991 202.564c-8.501-15.787-4.855-35.363 8.758-47.031l.021-.019c14.324-12.277 35.46-12.277 49.784 0l.021.019c13.613 11.668 17.259 31.244 8.758 47.031l-21.615 40.142a13.69 13.69 0 0 1-24.112 0zm84.521-122.913 2.047-3.066a69.52 69.52 0 0 1 62.281-30.745 69.52 69.52 0 0 1 57.73 38.356 16.2 16.2 0 0 1 1.791 7.427 16.29 16.29 0 0 1-16.28 16.28c-6.464 0-12.053-3.775-14.68-9.238a36.954 36.954 0 0 0-63.77-3.988 4.4 4.4 0 0 1-.864.962c-2.601 5.535-8.228 9.37-14.743 9.37a16.29 16.29 0 0 1-16.28-16.28 16.2 16.2 0 0 1 2.768-9.078m-223.76 4.545a69.51 69.51 0 0 1 57.73-38.356 69.52 69.52 0 0 1 62.281 30.745l.863 1.517a16.2 16.2 0 0 1 3.952 10.627 16.29 16.29 0 0 1-16.28 16.28c-6.214 0-11.62-3.489-14.364-8.614a28 28 0 0 1-1.242-1.718 36.955 36.955 0 0 0-63.771 3.988c-2.627 5.463-8.216 9.238-14.68 9.238a16.29 16.29 0 0 1-16.28-16.28 16.2 16.2 0 0 1 1.791-7.427m324.444-169.342c26.738-18.241 61.814-44.063 84.404-67.97 43.613-46.155 16.513-83.682 10.606-90.778-6.432-5.573-13.684-9.381-21.179-10.572-8.894-1.412-16.035-1.075-21.987 1.423-9.37 3.933-15.359 12.718-21.416 24.176-8.84 16.725-16.714 38.739-27.641 64.157-13.125 30.531-33.39 53.993-52.124 70.767 16.318 1.762 32.996 4.52 49.337 8.797m-253.733-8.797c-18.739-16.78-39.001-40.239-52.124-70.767-10.927-25.418-18.801-47.432-27.641-64.157-6.057-11.458-12.046-20.243-21.416-24.176-5.952-2.498-13.093-2.835-21.987-1.423-7.495 1.191-14.747 4.999-21.179 10.572-5.907 7.096-33.007 44.623 10.606 90.778 22.59 23.907 57.666 49.729 84.403 67.97 16.342-4.277 33.021-7.036 49.338-8.797m46.617-176.651-26.896-63.322a16.28 16.28 0 0 1 .248-13.284 16.29 16.29 0 0 1 10.063-8.676l117.39-35.176a16.27 16.27 0 0 1 13.09 1.659 16.28 16.28 0 0 1 7.561 10.814l26.739 136.862a17 17 0 0 1 .173 1.072c5.404 14.505-5.435 34.481-25.776 46.225-21.855 12.618-46.457 10.985-54.903-3.645s2.44-36.752 24.295-49.37c6.731-3.887 13.723-6.421 20.425-7.641l-19.464-99.631-82.762 24.801 28.707 67.584a16.3 16.3 0 0 1 1.117 3.939c6.493 14.584-4.376 35.355-25.285 47.427-21.856 12.618-46.457 10.985-54.904-3.645s2.44-36.752 24.295-49.37c5.226-3.017 10.609-5.22 15.887-6.623\"\n  })));\n};\nexport { SvgLyricistantLogo as ReactComponent };\nexport default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"100%\\\" height=\\\"100%\\\" viewBox=\\\"0 0 1080 1080\\\" fill-rule=\\\"evenodd\\\"\\n     stroke-linejoin=\\\"round\\\" stroke-miterlimit=\\\"2\\\">\\n    <path d=\\\"M592.265 470.55c-20.047-.319-38.048.176-52.263.176h-.004c-14.215 0-32.216-.495-52.261-.176-17.723-10.982-53.501-37.388-72.145-80.758-14.428-33.563-24.106-61.379-36.711-79.831-15.816-23.151-35.498-34.601-69.354-29.222-16.637 2.642-33.045 12.088-46.071 26.691-28.142 31.546-40.977 87.562-3.838 141.709 16.956 24.721 45.235 42.363 75.276 54.42-47.412 27.244-75.95 72.203-86.109 127.629-16.644 90.807 25.192 155.58 75.307 197.187 46.396 38.519 114.729 69.158 215.806 69.784l-.15-.005h.504l-.15.005c101.077-.626 169.41-31.265 215.806-69.784 50.115-41.607 91.952-106.38 75.307-197.187-10.159-55.426-38.697-100.385-86.108-127.628 30.042-12.058 58.321-29.7 75.277-54.421 37.139-54.147 24.304-110.163-3.838-141.709-13.026-14.603-29.434-24.049-46.071-26.691-33.856-5.379-53.538 6.071-69.354 29.222-12.605 18.452-22.283 46.268-36.711 79.831-18.644 43.37-54.422 69.776-72.145 80.758zm9.057 96.811l7.257-28.92c2.734-10.894-3.891-21.958-14.785-24.691s-21.958 3.891-24.691 14.785l-7.877 31.391a211.13 211.13 0 0 1-21.225 52.938 211.13 211.13 0 0 1-21.225-52.938l-7.877-31.391c-2.221-8.851-9.941-14.884-18.601-15.369l-1.003-.031a20.35 20.35 0 0 0-5.087.615c-10.894 2.733-17.519 13.797-14.785 24.691l7.257 28.92c24.749 16.308 41.097 44.35 41.097 76.181 0 50.317-40.851 91.168-91.168 91.168s-91.168-40.851-91.168-91.168 40.851-91.168 91.168-91.168a91 91 0 0 1 26.371 3.88c-6.214-12.16-15.449-23.71-28.939-28.208-32.329-10.78-74.18-5.365-115.225 50.487-38.357 52.193-26.981 126.591 18.791 180.196 44.956 52.649 107.783 82.754 210.394 82.448 102.611.306 165.438-29.799 210.394-82.448 45.772-53.605 57.148-128.003 18.791-180.196-41.045-55.852-82.896-61.267-115.225-50.487-13.49 4.498-22.725 16.048-28.939 28.208a91 91 0 0 1 26.371-3.88c50.317 0 91.168 40.851 91.168 91.168s-40.851 91.168-91.168 91.168-91.168-40.851-91.168-91.168c0-31.831 16.348-59.873 41.097-76.181zm-94.991 202.564c-8.501-15.787-4.855-35.363 8.758-47.031a.36.36 0 0 0 .021-.019c14.324-12.277 35.46-12.277 49.784 0 .007.007.014.013.021.019 13.613 11.668 17.259 31.244 8.758 47.031l-21.615 40.142a13.69 13.69 0 0 1-24.112 0l-21.615-40.142zm84.521-122.913l2.047-3.066a69.52 69.52 0 0 1 62.281-30.745c24.702 1.596 46.687 16.207 57.73 38.356a16.2 16.2 0 0 1 1.791 7.427 16.29 16.29 0 0 1-16.28 16.28c-6.464 0-12.053-3.775-14.68-9.238-5.879-11.742-17.55-19.486-30.661-20.333-13.163-.851-25.781 5.378-33.109 16.345a4.38 4.38 0 0 1-.864.962c-2.601 5.535-8.228 9.37-14.743 9.37a16.29 16.29 0 0 1-16.28-16.28 16.2 16.2 0 0 1 2.768-9.078zm-223.76 4.545c11.039-22.146 33.025-36.76 57.73-38.356a69.52 69.52 0 0 1 62.281 30.745l.863 1.517a16.21 16.21 0 0 1 3.952 10.627 16.29 16.29 0 0 1-16.28 16.28c-6.214 0-11.62-3.489-14.364-8.614a28.18 28.18 0 0 1-1.242-1.718c-7.329-10.967-19.947-17.196-33.11-16.345-13.111.847-24.782 8.591-30.661 20.333-2.627 5.463-8.216 9.238-14.68 9.238a16.29 16.29 0 0 1-16.28-16.28 16.2 16.2 0 0 1 1.791-7.427zm324.444-169.342c26.738-18.241 61.814-44.063 84.404-67.97 43.613-46.155 16.513-83.682 10.606-90.778-6.432-5.573-13.684-9.381-21.179-10.572-8.894-1.412-16.035-1.075-21.987 1.423-9.37 3.933-15.359 12.718-21.416 24.176-8.84 16.725-16.714 38.739-27.641 64.157-13.125 30.531-33.39 53.993-52.124 70.767 16.318 1.762 32.996 4.52 49.337 8.797zm-253.733-8.797c-18.739-16.78-39.001-40.239-52.124-70.767-10.927-25.418-18.801-47.432-27.641-64.157-6.057-11.458-12.046-20.243-21.416-24.176-5.952-2.498-13.093-2.835-21.987-1.423-7.495 1.191-14.747 4.999-21.179 10.572-5.907 7.096-33.007 44.623 10.606 90.778 22.59 23.907 57.666 49.729 84.403 67.97 16.342-4.277 33.021-7.036 49.338-8.797zm46.617-176.651l-26.896-63.322a16.28 16.28 0 0 1 .248-13.284c1.968-4.191 5.628-7.346 10.063-8.676l117.39-35.176c4.402-1.32 9.157-.717 13.09 1.659a16.28 16.28 0 0 1 7.561 10.814l26.739 136.862a16.82 16.82 0 0 1 .173 1.072c5.404 14.505-5.435 34.481-25.776 46.225-21.855 12.618-46.457 10.985-54.903-3.645s2.44-36.752 24.295-49.37c6.731-3.887 13.723-6.421 20.425-7.641l-19.464-99.631-82.762 24.801 28.707 67.584c.548 1.291.917 2.614 1.117 3.939 6.493 14.584-4.376 35.355-25.285 47.427-21.856 12.618-46.457 10.985-54.904-3.645s2.44-36.752 24.295-49.37c5.226-3.017 10.609-5.22 15.887-6.623z\\\"/>\\n</svg>\";"],"names":["getThemePalette","themeData","useDarkTheme","colorScheme","Dark","palette","darkThemePalette","lightThemePalette","systemPalette","isDark","createTheme","mode","action","hover","primary","hoverOpacity","main","background","default","paper","surface","text","primaryText","secondary","secondaryText","components","MuiPaper","styleOverrides","root","backgroundImage","typography","textSize","fontSize","undefined","ColorScheme","Font","RhymeSource","DefaultFileType","DetailPaneVisibility","onThemeUpdated","container","document","getElementById","createElement","id","body","append","innerHTML","image","firstElementChild","style","width","height","onPageLoaded","opacity","setTimeout","remove","setProperty","APP_VERSION","APP_HOMEPAGE","APP_AUTHOR","APP_PLATFORM","FORWARD_SLASH","charCodeAt","NEW_LINE","lyric","input","current","peek","next","acceptToken","Lyric","advance","parser","deserialize","version","states","stateData","goto","nodeNames","maxTerm","skippedNodes","repeatNodeCount","tokenData","tokenizers","topRules","tokenPrec","todoComment","define","context","LyricsLanguage","configure","props","LineComment","lineComment","TodoComment","Context","languageData","commentTokens","line","textColorSelectionStyle","appTheme","backgroundColor","color","getContrastText","nonLyricNodeTypes","getLyricNodesBetween","state","from","to","getNodesBetween","filter","node","find","name","type","nodes","cursor","cursorAt","pos","checkChild","push","placeholders","markDecoration","mark","class","setMark","map","change","mapPos","isApplicableAddMarkEffect","effect","doc","value","length","markStateField","create","none","update","marks","tr","effects","is","of","range","changes","provide","field","decorations","useCodeMirror","view","setView","useState","setContainer","resetCount","setResetCount","useTheme","themeCompartment","useMemo","textCompartment","selectionCompartment","fileDroppedCompartment","readOnlyCompartment","themeExtension","font","tag","disabled","theme","caretColor","overflow","outline_fallback","outline","borderColor","borderBottom","fontFamily","paddingTop","paddingBottom","paddingLeft","paddingRight","justifyContent","borderRight","grey","A100","contrastText","border","borderRadius","margin","padding","textAlign","textDecoration","display","active","right","dark","editorTheme","textChangedExtension","textChanged","onTextChanged","updateListener","docChanged","selectionSet","selection","selectionExtension","textSelection","onTextSelected","selectionRange","asSingle","empty","lineAt","doesNodeContainSelection","position","head","isDelimiter","c","exec","start","end","assoc","Math","max","substring","findWordAt","fileDroppedExtension","fileDropped","onFileDropped","domEventHandlers","drop","event","stopPropagation","preventDefault","dataTransfer","items","files","readOnlyExtension","readOnly","isReadOnly","editable","useEffect","markedText","dispatch","defaultConfig","extensions","formatNumber","lineNo","lines","supportedNodes","sliceDoc","join","joinNodesToText","toString","lineWrapping","sample","delay","tooltipFilter","newView","parent","setState","destroy","currentText","eq","insert","cursorPosition","anchor","reconfigurableExtensions","compartment","extension","configs","lastConfigs","setLastConfigs","useLayoutEffect","changedConfigs","differenceWith","isEqual","reconfigure","useReconfigurableExtension","Array","getElementsByClassName","forEach","element","setAttribute","resetHistory","useCallback","count","undo","redo","openFindReplaceDialog","diagnostics","isModified","AppError","error","editorText","onClose","window","location","reload","onCopy","navigator","clipboard","writeText","onDownloadLogs","platformDelegate","send","logger","Dialog","open","DialogTitle","Box","Typography","component","Link","href","rel","variant","DialogActions","Button","onClick","aboutInfo","target","DividerlessTableCell","TableCell","sx","AboutDialog","className","scroll","DialogContent","Grid","spacing","direction","alignItems","size","xs","fill","TableContainer","Table","TableBody","Object","keys","key","TableRow","fullWidth","useNavigation","setLocation","path","options","replace","supportedReleases","platform","asset","url","arch","ReleaseHelper","cachedReleases","getLatestDownloadableRelease","async","currentVersion","includeCurrentVersion","this","debug","releases","getGitHubReleases","newestRelease","tag_name","baseDownloadUrl","getBaseDownloadUrl","changelog","getChangelog","result","octokit","rest","repos","listReleases","LYRICISTANT_REPO","release","data","isReleaseNewerThanCurrent","assets","some","e","warn","currentVersionString","releaseTag","removeFilename","browser_download_url","reduce","lastIndexOf","owner","repo","releaseHelper","latestReleaseMachine","types","initial","releaseData","on","INPUT","inactive","loading","invoke","src","onDone","guard","args","output","actions","a","onError","loaded","releaseColor","PlatformDownloadOptions","children","DownloadButton","Accordion","A","boxShadow","AccordionSummary","releaseTextColor","textTransform","startIcon","ReleaseIcon","AccordionDetails","downloadLabel","ChooseDownloadDialog","onReleaseClicked","info","list","get","set","Map","matches","CircularProgress","DownloadButtons","DialogContentText","Linux","Apple","MicrosoftWindows","Android","AppleIos","ReadOnlyModeContext","useReadOnlyMode","useContext","useSmallLayout","useMediaQuery","breakpoints","down","useChannel","channel","listener","deps","removeListener","useChannelData","shouldRegister","setResult","FileHistoryItem","ListItem","ListItemText","time","VisualChunkLine","foregroundColor","success","control","VisualChunk","marginBottom","divider","chunk","index","FileHistoryList","historyData","List","onFileHistoryClicked","Divider","FileHistory","setDisplayedHistory","displayedHistory","paperBounds","maxWidth","maxHeight","chunks","Drawer","PaperProps","Markdown","disableParsingRawHTML","PlatformDialogs","dialogData","setDialogData","closeDialogTag","setCloseDialogTag","setOpen","lastOpenedDialogTime","useRef","onDialogInteraction","interactionData","onClosed","performance","now","close","delta","AlertDialog","FullscreenDialog","onCancel","SelectionDialog","onTransitionCancel","fullScreen","slotProps","transition","Grow","flexDirection","gap","message","progress","LinearProgressWithLabel","cancelable","setText","textField","defaultValue","isTextFieldValid","validationRegex","RegExp","test","title","collapsibleMessage","elevation","square","expandIcon","ExpandMore","label","overflowY","wordBreak","TextField","onChange","buttons","selectedButton","setSelection","isChecked","setChecked","Select","option","MenuItem","checkbox","FormGroup","FormControlLabel","Checkbox","checked","selectedOption","checkboxes","mr","LinearProgress","minWidth","round","DialogTransition","ref","Slide","Header","fontWeight","marginTop","SelectBox","FormControl","InputLabel","marginLeft","marginRight","itemLabel","itemValue","Preferences","originalPreferenceData","preferencesData","setPreferencesData","TransitionComponent","AppBar","enableColorOnDark","Toolbar","IconButton","edge","Close","flex","Save","Container","Paper","Roboto_Mono","Roboto","Light","System","detailPaneVisibility","Toggleable","Always_Show","rhymeSource","Offline","Datamuse","defaultFileType","Always_Ask","Lyricistant_Lyrics","Plain_Text","Info","onAboutClicked","flexGrow","PrivacyPolicy","ModalRoute","render","Modals","navigate","goBack","history","back","useBackNavigation","verbose","pathname","WordChip","word","Chip","NullStateText","visible","textOverflow","fontStyle","p","flexWrap","toDisplayMessage","report","source","actual","loadDictionary","callback","dic","aff","loadDictionaryAsync","then","catch","diagnosticsMachine","waiting","debouncing","after","DEBOUNCE","file","messages","column","place","severity","fatal","proposals","expected","sort","left","toDiagnostics","retext","use","process","retextDiagnostics","createDiagnostics","isArray","displaying","delays","guards","isValidInput","Diagnostics","isVisible","onLoadingChanged","onDiagnosticsLoaded","DiagnosticsList","onDiagnosticClicked","onProposalAccepted","diagnostic","DiagnosticRow","JSON","stringify","onProposalClicked","proposal","disablePadding","ListItemButton","ListItemSecondaryAction","ChevronRight","DiagnosticActionPopover","Popover","anchorEl","domRect","getBoundingClientRect","nodeType","anchorOrigin","vertical","horizontal","DiagnosticActionPopoverContent","dense","slice","fetchDefinitionActor","axios","baseURL","response","meanings","fetchDefinition","dictionaryMachine","events","actors","trim","match","createMachine","inputForResult","meaning","definitions","definition","synonyms","uniq","flattenDeep","synonym","split","antonyms","antonym","Dictionary","query","onRelatedTextClicked","MeaningList","VisualMeaning","RelatedTextLists","partOfSpeech","VisualDefinition","showHeader","example","shouldHide","Set","hasSynonyms","hasAntonyms","RelatedText","words","RhymesListItem","rhyme","onRhymeClicked","RhymesList","rhymes","alignContent","Rhymes","showBoundary","handleError","isSurpriseButtonEnabled","onSurpriseMeClicked","Rhyme","score","asyncRhymes","param","fetch","getMaxRhymeCount","ok","status","parse","increaseScore","amount","offlineRhymes","rhymeGenerator","generateRhymes","results","Promise","all","distinct","by","item","has","array","prev","concat","rhymesMachine","TabbedItem","selectedIndex","ToggleDetailPaneIcon","isExpanded","ChevronDown","ChevronUp","ChevronLeft","DetailButton","Fab","icon","DetailPane","isLoading","setLoading","setExpanded","isSmallLayout","isExpandedPaneShowingRhymes","setIsExpandedPaneIsShowingRhymes","rhymesState","sendRhymesEvent","isRhymesVisible","rhymeProps","showToggleButton","showSmallRhymes","ExpandedDetailPane","onTabChanged","isRhymesTab","rhymesProps","dictionaryProps","diagnosticsProps","ClosedPaneRhymes","onDisableReadonlyMode","button","Fade","in","SingleLineRhymeList","isAnimating","setIsAnimating","tabIndex","setTabIndex","changeTab","isQueryTab","paperDisplay","onEnter","onExited","minHeight","Tabs","_","newTabIndex","TabIndicatorProps","Tab","ScriptOutline","BookAlphabet","Spellcheck","EditorContainer","EdgeFade","endColor","towards","startColor","rotation","content","zIndex","top","bottom","Editor","editor","File","getAsFile","handle","getAsFileSystemHandle","metadata","arrayBuffer","extras","toPlatformFile","reason","isTransactional","selectedText","onModificationStateChanged","selectedDiagnostic","scrollIntoView","y","yMargin","domAtPos","createRange","selectNode","onSelectedDiagnosticRendered","clearTimeout","useTextActionEvents","openFindReplaceModal","getRootError","Error","stack","isReportableError","includes","MenuIcon","ariaLabel","debounce","debouncedClick","role","toMenuIcon","MenuBar","isHorizontal","setAnchor","shouldTrim","leading","trailing","currentTarget","MoreVert","transformOrigin","ListItemIcon","disableRipple","uiConfig","leadingIcons","AddCircle","onNewClicked","showOpen","FolderOpen","onOpenClicked","onSaveClicked","History","trailingIcons","showDownload","GetApp","onDownloadClicked","EditOff","Edit","onReadOnlyToggled","Settings","onPreferencesClicked","ResponsiveMainDetailLayout","detail","menu","isUnsupportedBrowser","Blob","WarningDialog","onContinue","oldOnError","onerror","col","rootError","console","alert","onunhandledrejection","setWindowErrorHandler","analyticsScript","allow_local","no_onload","no_events","timeoutId","goatcounter","site","host","setupAnalytics","hashLocation","hash","hashNavigate","replaceState","internal","hasSentReadyForEvents","isDeepLink","onThemeChanged","onThemeReady","setTheme","setPalette","loadFont","StyledEngineProvider","injectFirst","ThemeProvider","GlobalStyles","styles","CssBaseline","maxSnack","setUiConfig","isAcknowledged","setAcknowledged","showWarning","showBrowserWarning","hook","editorTextData","setEditorTextData","setError","setSelectedText","setIsModified","showQuerySelection","setShowQuerySelection","setSelectedDiagnostic","selectedDiagnosticRect","setSelectedDiagnosticRect","selectedDiagnosticKey","incrementKey","useReducer","setReadOnly","onPartialEditorTextDataUpdate","textData","onTextReplacement","useEventCallback","prefix","sliceString","suffix","setEditorText","resetTextSelection","enqueueSnackbar","onCheckFileModified","onFileSaveEnded","onNewFileCreated","onFileOpened","fileContents","clearHistory","useFileEvents","promptOnUrlChange","addEventListener","removeEventListener","onTextRequested","newError","timer","fallbackErrorRendering","onInspirationButtonClicked","isInspirationButtonEnabled","inspirationWords","setInspirationWords","useInspirationWords","newText","newPosition","isStartOfLine","isEndOfLine","startCase","isPreviousCharacterSpace","isNextCharacterSpace","useInspirationButton","useProposalAcceptance","fallbackRender","Provider","_path","_extends","assign","bind","n","arguments","t","r","hasOwnProperty","call","apply","SvgLyricistantLogo","xmlns","fillRule","strokeLinejoin","strokeMiterlimit","viewBox","d"],"sourceRoot":""}