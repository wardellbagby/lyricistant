/*! For license information please see 646.renderer.js.LICENSE.txt */
(()=>{"use strict";const e=Symbol("Comlink.proxy"),t=Symbol("Comlink.endpoint"),n=Symbol("Comlink.releaseProxy"),r=Symbol("Comlink.finalizer"),i=Symbol("Comlink.thrown"),s=e=>"object"==typeof e&&null!==e||"function"==typeof e,o=new Map([["proxy",{canHandle:t=>s(t)&&t[e],serialize(e){const{port1:t,port2:n}=new MessageChannel;return a(e,t),[n,[n]]},deserialize:e=>(e.start(),l(e))}],["throw",{canHandle:e=>s(e)&&i in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function a(e,t=globalThis,n=["*"]){t.addEventListener("message",(function s(o){if(!o||!o.data)return;if(!function(e,t){for(const n of e){if(t===n||"*"===n)return!0;if(n instanceof RegExp&&n.test(t))return!0}return!1}(n,o.origin))return void console.warn(`Invalid origin '${o.origin}' for comlink proxy`);const{id:l,type:c,path:u}=Object.assign({path:[]},o.data),f=(o.data.argumentList||[]).map(S);let h;try{const t=u.slice(0,-1).reduce(((e,t)=>e[t]),e),n=u.reduce(((e,t)=>e[t]),e);switch(c){case"GET":h=n;break;case"SET":t[u.slice(-1)[0]]=S(o.data.value),h=!0;break;case"APPLY":h=n.apply(t,f);break;case"CONSTRUCT":h=y(new n(...f));break;case"ENDPOINT":{const{port1:t,port2:n}=new MessageChannel;a(e,n),h=function(e,t){return m.set(e,t),e}(t,[t])}break;case"RELEASE":h=void 0;break;default:return}}catch(e){h={value:e,[i]:0}}Promise.resolve(h).catch((e=>({value:e,[i]:0}))).then((n=>{const[i,o]=w(n);t.postMessage(Object.assign(Object.assign({},i),{id:l}),o),"RELEASE"===c&&(t.removeEventListener("message",s),g(t),r in e&&"function"==typeof e[r]&&e[r]())})).catch((e=>{const[n,r]=w({value:new TypeError("Unserializable return value"),[i]:0});t.postMessage(Object.assign(Object.assign({},n),{id:l}),r)}))})),t.start&&t.start()}function g(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function l(e,t){const n=new Map;return e.addEventListener("message",(function(e){const{data:t}=e;if(!t||!t.id)return;const r=n.get(t.id);if(r)try{r(t)}finally{n.delete(t.id)}})),p(e,n,[],t)}function c(e){if(e)throw new Error("Proxy has been released and is not useable")}function u(e){return E(e,new Map,{type:"RELEASE"}).then((()=>{g(e)}))}const f=new WeakMap,h="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(f.get(e)||0)-1;f.set(e,t),0===t&&u(e)}));function p(e,r,i=[],s=function(){}){let o=!1;const a=new Proxy(s,{get(t,s){if(c(o),s===n)return()=>{!function(e){h&&h.unregister(e)}(a),u(e),r.clear(),o=!0};if("then"===s){if(0===i.length)return{then:()=>a};const t=E(e,r,{type:"GET",path:i.map((e=>e.toString()))}).then(S);return t.then.bind(t)}return p(e,r,[...i,s])},set(t,n,s){c(o);const[a,g]=w(s);return E(e,r,{type:"SET",path:[...i,n].map((e=>e.toString())),value:a},g).then(S)},apply(n,s,a){c(o);const g=i[i.length-1];if(g===t)return E(e,r,{type:"ENDPOINT"}).then(S);if("bind"===g)return p(e,r,i.slice(0,-1));const[l,u]=d(a);return E(e,r,{type:"APPLY",path:i.map((e=>e.toString())),argumentList:l},u).then(S)},construct(t,n){c(o);const[s,a]=d(n);return E(e,r,{type:"CONSTRUCT",path:i.map((e=>e.toString())),argumentList:s},a).then(S)}});return function(e,t){const n=(f.get(t)||0)+1;f.set(t,n),h&&h.register(e,t,e)}(a,e),a}function d(e){const t=e.map(w);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const m=new WeakMap;function y(t){return Object.assign(t,{[e]:!0})}function w(e){for(const[t,n]of o)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},m.get(e)||[]]}function S(e){switch(e.type){case"HANDLER":return o.get(e.name).deserialize(e.value);case"RAW":return e.value}}function E(e,t,n,r){return new Promise((i=>{const s=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.set(s,i),e.start&&e.start(),e.postMessage(Object.assign({id:s},n),r)}))}const v=l(self),b=()=>({showDownload:!0,showOpen:!!Blob&&!!File,showBrowserWarning:!0,promptOnUrlChange:!0}),T=e=>e&&e.trim().length>0?`Lyricistant - ${e}`:"Lyricistant";var C=Symbol.for("___CTOR_ARGS___"),R="Note: You must use DI-Compiler (https://github.com/wessberg/di-compiler) for this library to work correctly. Please consult the readme for instructions on how to install and configure it for your project.",k=class e extends TypeError{#e="InstantiationError";#t;#n;#r;get[Symbol.toStringTag](){return this.#e}constructor(t,{identifier:n,parentChain:r,...i}){const s="string"==typeof t?t:t instanceof Error||"object"==typeof t&&null!=t&&"message"in t&&"string"==typeof t.message?t.message:void 0,o="string"==typeof t?void 0:t instanceof Error||"object"==typeof t&&null!=t&&"stack"in t&&"string"==typeof t.stack?t.stack:void 0,a=t instanceof Error?t:{message:s,stack:o};super(s,i),this.#n=n,this.#t=a,this.#r=null!=r&&r.length>0?r.map((e=>"string"==typeof e?e:e.identifier)):[this.#n],this.name=this[Symbol.toStringTag];let g=this.#t;for(;g instanceof e;)g=g.#t;const l=`Could not instantiate service: '${this.#r[this.#r.length-1]}'`,c=null==g.message||g.message.length<1?"":`: ${g.message}`,u=this.#r.length>1?` Dependency chain: ${this.#r.join(" -> ")}`:"";this.message=`${l}${c}${u}`,null!=g.stack&&(this.stack=g.stack)}};function I(e){if("function"!=typeof e)return!1;const t=Object.getOwnPropertyDescriptor(e,"prototype");return!!t&&!t.writable}var L=class{get[Symbol.toStringTag](){return"DIContainer"}#i=new Map;#s=new Map;#o=new Map;registerSingleton(e,t){if(null==t)throw new ReferenceError(`2 arguments required, but only 0 present. ${R}`);return this.#a("SINGLETON",e,t)}registerTransient(e,t){if(null==t)throw new ReferenceError(`2 arguments required, but only 0 present. ${R}`);return this.#a("TRANSIENT",e,t)}get(e){if(null==e)throw new ReferenceError(`1 argument required, but only 0 present. ${R}`);if(!this.has(e))throw new k("The service wasn't found in the registry.",{identifier:e.identifier});return this.#g(e)}has(e){if(null==e)throw new ReferenceError(`1 argument required, but only 0 present. ${R}`);return this.#s.has(e.identifier)}#a(e,t,n){const r="implementation"in n&&null!=n.implementation?.[C]?n.implementation[C]:[];this.#i.set(n.identifier,r),this.#s.set(n.identifier,"implementation"in n&&null!=n.implementation?{...n,kind:e}:{...n,kind:e,newExpression:t})}#l(e){return null!=this.#c(e)}#c(e){const t=this.#o.get(e);return null==t?null:t}#u(e){return this.#s.get(e)}#f(e,t){return this.#o.set(e,t),t}#h(e){return new Proxy({},{get:(t,n)=>e()[n]})}#g({identifier:e,parentChain:t=[]}){const n=this.#u(e);if(null==n)return;if(this.#l(e)&&"SINGLETON"===n.kind)return this.#c(e);let r;const i={identifier:e,ref:this.#h((()=>r))},s="newExpression"in n?n.newExpression:n.implementation;if(I(s)){const n=this.#i.get(e);if(null==n)throw new k("Could not find constructor arguments. Have you registered it as a service?",{identifier:e,parentChain:t});const o=n.map((e=>{if(void 0===e)return;const n=t.find((t=>t.identifier===e));if(null!=n)return n.ref;const r=[...t,i],s=this.#g({identifier:e,parentChain:r});if(null==s&&!this.has({identifier:e}))throw new k(`Dependency '${e}' was not found in the service registry.`,{identifier:i.identifier,parentChain:r});return s}));r=new s(...o)}else{if(I(o=s)||"function"!=typeof o)throw new k("No implementation was given!",{identifier:e,parentChain:t});r=s()}var o;return"SINGLETON"===n.kind?this.#f(e,r):r}};const N=(()=>{const e=new L;return e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),e.registerSingleton(),((e,t)=>{t.registerTransient(e.files),t.registerTransient(e.logger),t.registerTransient(e.logger),t.registerTransient(e.preferences),t.registerTransient(e.recentFiles),t.registerTransient(e.systemThemeProvider),t.registerTransient(e.appData),t.registerTransient(e.buffers),t.registerTransient(e.uiConfigProvider),t.registerTransient(e.titleFormatter),t.registerTransient(e.rendererDelegate),t.registerTransient(e.times),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton(),t.registerSingleton((()=>[t.get()])),t.registerSingleton((()=>[t.get(),t.get()]))})({rendererDelegate:()=>e.get(),logger:()=>e.get(),files:()=>e.get(),preferences:()=>e.get(),titleFormatter:()=>T,buffers:()=>e.get(),appData:()=>e.get(),systemThemeProvider:()=>e.get(),recentFiles:()=>e.get(),uiConfigProvider:()=>b,times:()=>e.get()},e),e.registerSingleton(),((e,...t)=>{e.registerSingleton((()=>[e.get(),e.get(),e.get(),e.get(),e.get(),e.get(),e.get(),...t]))})(e,e.get()),e})();self.onerror=e=>{var t;(null!==(t=null==N?void 0:N.get())&&void 0!==t?t:console).error("Web Platform crashed",e),e instanceof ErrorEvent?v.onError(e.error):v.onError(e)},self.onunhandledrejection=e=>{self.onerror(e.reason)};const O=()=>N.get();a({receive:(e,t)=>{O().receive(e,t)},onRendererListenerSet:e=>{O().onRendererListenerSet(e)},getLogger:()=>y(N.get()),start:()=>{try{N.get().forEach((e=>e.register()))}catch(e){self.onerror(e)}}})})();
//# sourceMappingURL=646.renderer.js.map